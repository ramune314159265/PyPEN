"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;return void 0!==getter?getter.call(receiver):void 0},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var typeOfValue={typeInt:1,typeFloat:2,typeString:3,typeBoolean:4,typeArray:5},graphColor=["#c00000","#00c000","#0000c0","#007070","#700070","#707000"],nameOfType=["","整数","実数","文字列","真偽","配列"],code=null,varTables=[],myFuncs={},returnValues=[],run_flag=!1,step_flag=!1,editable_flag=!0,flowchart=null,textarea=null,context=null,current_line=-1,wait_time=0,flowchart_display=!1,converting=!1,dirty=null,timeouts=[],selected_quiz=-1,selected_quiz_case=-1,selected_quiz_input=0,selected_quiz_output=0,output_str="",test_limit_time=0,fontsize=16,python_lib={},editor=null;function finish(){selected_quiz<0&&textareaAppend("---\n"),highlightLine(-1),setRunflag(!1),wait_time=0,code=null}var parsedCode=function(){function parsedCode(statementlist){_classCallCheck(this,parsedCode),this.stack=[{statementlist:statementlist,index:0}]}return _createClass(parsedCode,[{key:"makePython",value:function makePython(){python_lib={};for(var code="",libs="",i=0;i<this.stack[0].statementlist.length;i++){var state;(state=this.stack[0].statementlist[i])&&(state instanceof DefineFunction||state instanceof DefineStep)&&(code+=state.makePython(0))}for(var i=0;i<this.stack[0].statementlist.length;i++){var state;(state=this.stack[0].statementlist[i])&&!(state instanceof DefineFunction||state instanceof DefineStep)&&(code+=state.makePython(0))}for(var lib in python_lib)libs+="import "+lib+"\n";return libs+code}}]),parsedCode}(),parsedMainRoutine=function(_parsedCode){function parsedMainRoutine(statementlist){return _classCallCheck(this,parsedMainRoutine),_possibleConstructorReturn(this,(parsedMainRoutine.__proto__||Object.getPrototypeOf(parsedMainRoutine)).call(this,statementlist))}return _inherits(parsedMainRoutine,_parsedCode),parsedMainRoutine}(parsedCode),parsedFunction=function(_parsedCode2){function parsedFunction(statementlist){return _classCallCheck(this,parsedFunction),_possibleConstructorReturn(this,(parsedFunction.__proto__||Object.getPrototypeOf(parsedFunction)).call(this,statementlist))}return _inherits(parsedFunction,_parsedCode2),parsedFunction}(parsedCode),parsedStep=function(_parsedCode3){function parsedStep(statementlist){return _classCallCheck(this,parsedStep),_possibleConstructorReturn(this,(parsedStep.__proto__||Object.getPrototypeOf(parsedStep)).call(this,statementlist))}return _inherits(parsedStep,_parsedCode3),parsedStep}(parsedCode),varTable=function(){function varTable(){_classCallCheck(this,varTable),this.vars={}}return _createClass(varTable,[{key:"findVarTable",value:function findVarTable(varname){return this.vars[varname]?this:null}},{key:"varnames",value:function varnames(oldvars){var names=oldvars;for(var name in this.vars)names.indexOf(name)<0&&names.push(name);return names.sort()}}]),varTable}();function findVarTable(varname){var t=varTables[0].findVarTable(varname);return t||null}function codeChange(){if(!converting&&flowchart_display){var code=editor.getValue()+"\n";textarea.value="";try{myFuncs={};for(var dncl_code=python_to_dncl(code),parse=dncl.parse(dncl_code),flag=!1,i=0;i<parse.length;i++)(parse[i]instanceof DefineFunction||parse[i]instanceof DefineStep)&&(flag=!0);if(flag)return void(textarea.value="関数定義や手続き定義のあるプログラムのフローチャートはまだ実装していません。\n");converting=!0,flowchart.code2flowchart(parse),converting=!1}catch(e){highlightLine(-1),textareaClear(),e.line&&textareaAppend(e.line+"行目"),textareaAppend("構文エラーです\n"+e.message+"\n"),converting=!1}}}function isFinite(v){return!isNaN(v)&&v!=Number.POSITIVE_INFINITY&&v!=Number.NEGATIVE_INFINITY}function isSafeInteger(v){return!isNaN(v)&&v==Math.floor(v)&&v<=9007199254740991&&v>=-9007199254740991}function isInteger(v){return isFinite(v)&&v==Math.floor(v)}function constructor_name(obj){var result=/^(class|function)\s+([\w\d]+)/.exec(obj.constructor.toString());return result?result[2]:null}function toHalf(s,loc){if(s=s.toString(),1==setting.zenkaku_mode&&/[Ａ-Ｚａ-ｚ０-９．−]/.exec(s))throw new RuntimeError(loc.first_line,"数値や変数名を全角文字で入力してはいけません");return s.replace(/[Ａ-Ｚａ-ｚ０-９．−]/g,(function(s){return String.fromCharCode(s.charCodeAt(0)-65248)}))}function makeDirty(b){b!==dirty&&(dirty=b,document.getElementById("dirty").style.visibility=dirty?"visible":"hidden")}function textareaAppend(v){textarea.value+=v,textarea.scrollTop=textarea.scrollHeight}function textareaClear(){textarea.value=""}var Location=function(){function Location(first_token,last_token){_classCallCheck(this,Location),this._first_line=first_token.first_line,this._last_line=last_token.last_line}return _createClass(Location,[{key:"first_line",get:function get(){return this._first_line}},{key:"last_line",get:function get(){return this._last_line}}]),Location}(),RuntimeError=function(){function RuntimeError(line,message){_classCallCheck(this,RuntimeError),this._line=line,this._message=message,setRunflag(!1)}return _createClass(RuntimeError,[{key:"line",get:function get(){return this._line}},{key:"message",get:function get(){return this._message}}]),RuntimeError}(),Value=function(){function Value(v,loc){_classCallCheck(this,Value),this.rtnv=this._value=v,this._loc=loc}return _createClass(Value,[{key:"clone",value:function clone(){throw new RuntimeError(this.first_line,constructor_name(this)+"はcloneが作られていません")}},{key:"getValue",value:function getValue(){return this}},{key:"getCode",value:function getCode(){return""+this._value}},{key:"makePython",value:function makePython(){return this.getCode()}},{key:"run",value:function run(){code[0].stack[0].index++}},{key:"value",get:function get(){return this._value}},{key:"loc",get:function get(){return this._loc}},{key:"first_line",get:function get(){return this._loc.first_line}}]),Value}(),NullValue=function(_Value){function NullValue(loc){return _classCallCheck(this,NullValue),_possibleConstructorReturn(this,(NullValue.__proto__||Object.getPrototypeOf(NullValue)).call(this,null,loc))}return _inherits(NullValue,_Value),_createClass(NullValue,[{key:"clone",value:function clone(){return new NullValue(this.loc)}},{key:"getValue",value:function getValue(){return this}},{key:"makePython",value:function makePython(){return""}}]),NullValue}(Value);function setVariableByArgs(vt,vn,args,newval,loc){if(args){for(var v=vt.vars[vn],i=0;i<args.length-1;i++){var arg;if((arg=args.getValue().value[i]).getValue()instanceof IntValue){if(!(v.getValue()instanceof ArrayValue||v.getValue()instanceof StringValue))throw v.getValue()instanceof StringValue?new RuntimeError(loc.first_line,"部分文字列の部分文字列への代入はできません"):new RuntimeError(loc.first_line,"整数の添字は配列か文字列でないと使えません");var idx=arg.getValue().value,l=v.getValue().length;if(idx<0&&(idx+=l),!(idx>=0&&idx<l))throw new RuntimeError(loc.first_line,"配列の範囲を超えて代入しようとしました");v=v.getValue().value[idx]}else{if(!(arg.getValue()instanceof StringValue))throw arg.getValue()instanceof SliceValue?new RuntimeError(loc.first_line,"スライスの使い方が正しくありません"):new RuntimeError(loc.first_line,"添字が正しくありません");var key0=arg.getValue().value;if(!(v.getValue()instanceof DictionaryValue))throw new RuntimeError(loc.first_line,"文字列の添字は辞書でないと使えません");for(var key in v.getValue().value)if(key==key0){v=v.getValue().value[key0],key0=null;break}if(key0)throw new RuntimeError(loc.first_line,"辞書にキー"+arg.getValue().value+"がありません")}}var arg;if((arg=args.getValue().value[args.length-1]).getValue()instanceof IntValue){var idx=arg.getValue().value,l=v.getValue().value.length;if(idx<0&&(idx+=l),idx<0||idx>=l)throw new RuntimeError(loc.first_line,"配列の範囲を超えて代入しようとしました");if(v.getValue()instanceof ArrayValue)v.getValue().value[idx]=newval.clone();else{if(!(v.getValue()instanceof StringValue))throw new RuntimeError(loc,"整数の添字は配列か文字列にしか使えません");if(!(newval.getValue()instanceof StringValue))throw new RuntimeError(loc.first_line,"文字列の途中に文字列でないものを挿入しようとしました");var str=v.getValue().value;v.getValue()._value=str.substr(0,idx)+newval.getValue()._value+str.substr(idx+1)}}else if(arg.getValue()instanceof StringValue){if(!(v.getValue()instanceof DictionaryValue))throw new RuntimeError(loc.first_line,"文字列の添字は辞書にしか使えません");v.getValue().value[arg.getValue().value]=newval.clone()}else{if(!(arg.getValue()instanceof SliceValue))throw new RuntimeError(loc.first_line,"添字が正しくありません");var idx1=arg.getValue1().value,idx2=arg.getValue2().value;if(v.getValue()instanceof ArrayValue){if(!(newval.getValue()instanceof ArrayValue))throw new RuntimeError(loc.first_line,"配列に配列でないものを挿入しようとしました");var l=v.getValue().length;if(idx1||(idx1=0),idx2||(idx2=l),idx1<0&&(idx1+=l),idx2<0&&(idx2+=l),!(idx1>=0&&idx2>=0&&idx1<l&&idx2<l))throw new RuntimeError(loc.first_line,"配列の範囲外に挿入しようとしました");for(var a=[],i=0;i<idx1;i++)a.push(v.getValue().value[i].clone());for(var i=0;i<newval.getValue().length;i++)a.push(newval.getValue().value[i].clone());for(var i=idx2;i<l;i++)a.push(v.getValue().value[i].clone());v.getValue()._value=a}else{if(!(v.getValue()instanceof StringValue))throw new RuntimeError("スライスの添字は配列か文字列でないと使えません");if(!(newval.getValue()instanceof StringValue))throw new RuntimeError(loc.first_line,"文字列の途中に文字列でないものを挿入しようとしました");var l=v.getValue().length;if(idx1||(idx1=0),idx2||(idx2=l),idx1<0&&(idx1+=l),idx2<0&&(idx2+=l),idx1>=0&&idx2>=0&&idx1<l&&idx2<l){var str=v.getValue().value.substr(0,idx1)+newval.getValue().value+v.getValue().value.substr(idx2);v.getValue()._value=str}}}}else vt.vars[vn]=newval.clone()}function getValueByArgs(v,args,loc){if(args)for(var i=0;i<args.length;i++){var arg=args.getValue().value[i];if(arg.getValue()instanceof IntValue)if(v.getValue()instanceof ArrayValue){var idx=arg.getValue().value,l=v.getValue().length;if(idx<0&&(idx+=l),!(idx>=0&&idx<l))throw new RuntimeError(loc.first_line,"配列の範囲を超えてアクセスしました");v=v.getValue().value[idx]}else{if(!(v.getValue()instanceof StringValue))throw new RuntimeError(loc.first_line,"整数の添字は配列か文字列でないと使えません");var idx=arg.getValue().value,l=v.getValue().length;if(idx<0&&(idx+=l),!(idx>=0&&idx<l))throw new RuntimeError(loc.first_line,"文字列の範囲を超えてアクセスしました");v=new StringValue(v.getValue().value[idx],loc)}else if(arg.getValue()instanceof StringValue){if(!(v.getValue()instanceof DictionaryValue))throw new RuntimeError(loc.first_line,"文字列の添字は辞書でないと使えません");v=v.getValue().value[arg.getValue().value]}else{if(!(arg.getValue()instanceof SliceValue))throw new RuntimeError(loc.first_line,"添字が正しくありません");var idx1=arg.getValue1().value,idx2=arg.getValue2().value;if(v.getValue()instanceof ArrayValue){var l=v.getValue().length;if(idx1||(idx1=0),idx2||(idx2=l),idx1<0&&(idx1+=l),idx2<0&&(idx2+=l),!(idx1>=0&&idx2>=0&&idx1<=l&&idx2<=l))throw new RuntimeError(loc.first_line,"配列の範囲を超えて読み出そうとしました");for(var a=[],j=idx1;j<idx2;j++)a.push(v.getValue().value[j].clone());v=new ArrayValue(a,loc)}else{if(!(v.getValue()instanceof StringValue))throw new RuntimeError(loc.first_line,"スライスの添字は配列か文字列でないと使えません");var l=v.getValue().length;if(idx1||(idx1=0),idx2||(idx2=l),idx1<0&&(idx1+=l),idx2<0&&(idx2+=l),!(idx1>=0&&idx2>=0&&idx1<=l&&idx2<=l))throw new RuntimeError(loc.first_line,"文字列の範囲を超えて読み出そうとしました");v=new StringValue(v.getValue().value.substr(idx1,idx2-idx1),loc)}}}return v.clone()}var ArrayValue=function(_Value2){function ArrayValue(v,loc){_classCallCheck(this,ArrayValue);var _this5=_possibleConstructorReturn(this,(ArrayValue.__proto__||Object.getPrototypeOf(ArrayValue)).call(this,v,loc));return _this5.rtnv=v,_this5}return _inherits(ArrayValue,_Value2),_createClass(ArrayValue,[{key:"clone",value:function clone(){for(var a=[],i=0;i<this.value.length;i++)a.push(this.value[i].getValue().clone());var rtnv;return new ArrayValue(a,this.loc)}},{key:"run",value:function run(){for(var a=[],i=0;i<this.value.length;i++)a.push(this.value[i].getValue().clone());this.rtnv=a,_get(ArrayValue.prototype.__proto__||Object.getPrototypeOf(ArrayValue.prototype),"run",this).call(this)}},{key:"getCode",value:function getCode(){for(var ag=[],i=0;i<this.value.length;i++)ag.push(this.value[i].getCode());return"["+ag.join(",")+"]"}},{key:"makePython",value:function makePython(){for(var ag=[],i=0;i<this.value.length;i++)ag.push(this.value[i].makePython());return"["+ag.join(",")+"]"}},{key:"getValue",value:function getValue(){return this}},{key:"append",value:function append(a){this._value=this.value.concat(a)}},{key:"length",get:function get(){return this._value.length}}]),ArrayValue}(Value),DictionaryValue=function(_Value3){function DictionaryValue(v,loc){_classCallCheck(this,DictionaryValue);for(var _this6=_possibleConstructorReturn(this,(DictionaryValue.__proto__||Object.getPrototypeOf(DictionaryValue)).call(this,{},loc)),i=0;i<v.length;i++){if(!(v[i]instanceof SliceValue&&v[i].getValue1()instanceof StringValue)||v[i].getValue2()instanceof NullValue)throw new RuntimeError(loc.first_line,"辞書の初期化が間違っています");_this6.value[v[i].getValue1().value]=v[i].getValue2()}return _this6}return _inherits(DictionaryValue,_Value3),_createClass(DictionaryValue,[{key:"clone",value:function clone(){for(var rtnv=new DictionaryValue({},this.loc),keys=Object.keys(this.value),i=0;i<keys.length;i++){if(!this.value[keys[i]])throw new RuntimeError(this.first_line,keys[i]+"が定義されていません");rtnv.getValue().value[keys[i]]=this.value[keys[i]].getValue().clone()}return rtnv}},{key:"getCode",value:function getCode(){var ag=[],keys=Object.keys(this.value);keys.sort();for(var i=0;i<keys.length;i++)ag.push(keys[i]+":"+this.value[keys[i]].getCode());return"{"+ag.join(",")+"}"}},{key:"makePython",value:function makePython(){var ag=[],keys=Object.keys(this.value);keys.sort();for(var i=0;i<keys.length;i++)ag.push("'"+keys[i]+"':"+this.value[keys[i]].makePython());return"{"+ag.join(",")+"}"}},{key:"getValue",value:function getValue(){return this}}]),DictionaryValue}(Value);function makeArray(size,args,loc,type){var depth=size.value.length;if(args.length!=depth){var v=[];args||(args=[]);for(var _i=0;_i<size.value[args.length].value;_i++)args.push(_i),v.push(makeArray(size,args,loc,type)),args.pop();return new ArrayValue(v,loc)}switch(type){case typeOfValue.typeInt:return new IntValue(0,loc);case typeOfValue.typeFloat:return new FloatValue(0,loc);case typeOfValue.typeString:return new StringValue("",loc);case typeOfValue.typeBoolean:return new BooleanValue(!0,loc)}}var IntValue=function(_Value4){function IntValue(v,loc){_classCallCheck(this,IntValue);var _this7=_possibleConstructorReturn(this,(IntValue.__proto__||Object.getPrototypeOf(IntValue)).call(this,v,loc));if(!isSafeInteger(v))throw new RuntimeError(_this7.first_line,"整数で表せない値です");return _this7.rtnv=_this7.value,_this7}return _inherits(IntValue,_Value4),_createClass(IntValue,[{key:"clone",value:function clone(){var rtnv=new IntValue(this.value,this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"getValue",value:function getValue(){return this}}]),IntValue}(Value),FloatValue=function(_Value5){function FloatValue(v,loc){_classCallCheck(this,FloatValue);var _this8=_possibleConstructorReturn(this,(FloatValue.__proto__||Object.getPrototypeOf(FloatValue)).call(this,v,loc));if(!isFinite(v))throw new RuntimeError(_this8.first_line,"オーバーフローしました");return _this8.rtnv=_this8.value,_this8}return _inherits(FloatValue,_Value5),_createClass(FloatValue,[{key:"clone",value:function clone(){var rtnv=new FloatValue(this.value,this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"getCode",value:function getCode(){var str=this.value.toString();return null!=str.match(/[Ee]/)?str:isInteger(this.value)?this.value+".0":this.value}},{key:"getValue",value:function getValue(){return this}}]),FloatValue}(Value),StringValue=function(_Value6){function StringValue(v,loc){_classCallCheck(this,StringValue);var _this9=_possibleConstructorReturn(this,(StringValue.__proto__||Object.getPrototypeOf(StringValue)).call(this,v,loc));return _this9.rtnv=_this9.value,_this9}return _inherits(StringValue,_Value6),_createClass(StringValue,[{key:"clone",value:function clone(){var rtnv=new StringValue(this.value,this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"getCode",value:function getCode(){return'"'+this.value.replace(/"/g,'\\"')+'"'}},{key:"makePython",value:function makePython(){return"'"+this.value.replace("'","\\'")+"'"}},{key:"getValue",value:function getValue(){return this}},{key:"length",get:function get(){return this.value.length}}]),StringValue}(Value),BooleanValue=function(_Value7){function BooleanValue(v,loc){_classCallCheck(this,BooleanValue);var _this10=_possibleConstructorReturn(this,(BooleanValue.__proto__||Object.getPrototypeOf(BooleanValue)).call(this,v,loc));return _this10.rtnv=_this10.value,_this10}return _inherits(BooleanValue,_Value7),_createClass(BooleanValue,[{key:"clone",value:function clone(){var rtnv=new BooleanValue(this.value,this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"getCode",value:function getCode(){return this.value?"True":"False"}},{key:"makePython",value:function makePython(){return this.value?"True":"False"}},{key:"getValue",value:function getValue(){return this}}]),BooleanValue}(Value),UNDEFINED=function(_Value8){function UNDEFINED(v,loc){return _classCallCheck(this,UNDEFINED),_possibleConstructorReturn(this,(UNDEFINED.__proto__||Object.getPrototypeOf(UNDEFINED)).call(this,v,loc))}return _inherits(UNDEFINED,_Value8),_createClass(UNDEFINED,[{key:"clone",value:function clone(){return new UNDEFINED(this.value,this.loc)}},{key:"getValue",value:function getValue(){throw new RuntimeError(this.first_line,"未完成のプログラムです")}},{key:"getCode",value:function getCode(){return this.value}},{key:"varname",get:function get(){return this.value}}]),UNDEFINED}(Value),Pow=function(_Value9){function Pow(x,y,loc){return _classCallCheck(this,Pow),_possibleConstructorReturn(this,(Pow.__proto__||Object.getPrototypeOf(Pow)).call(this,[x,y],loc))}return _inherits(Pow,_Value9),_createClass(Pow,[{key:"clone",value:function clone(){var rtnv=new Pow(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof IntValue&&v2 instanceof IntValue&&v2.value>=0){if(0==v1.value&&v2.value<=0)throw new RuntimeError(this.first_line,"0は正の数乗しかできません");var v=Math.pow(v1.value,v2.value);if(!isSafeInteger(v))throw new RuntimeError(this.first_line,"整数で表せる範囲を越えました");this.rtnv=new IntValue(v,this.loc)}else{if(!(v1 instanceof IntValue||v1 instanceof FloatValue)||!(v2 instanceof IntValue||v2 instanceof FloatValue))throw new RuntimeError("数値でないもののべき乗はできません");if(v1.value<0&&!Number.isInteger(v2.value))throw new RuntimeError(this.first_line,"負の数の非整数乗はできません");if(0==v1.value&&v2.value<=0)throw new RuntimeError(this.first_line,"0は正の数乗しかできません");var _v=Math.pow(v1.value,v2.value);if(!isFinite(_v))throw new RuntimeError(this.first_line,"オーバーフローしました");this.rtnv=new FloatValue(_v,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1&&"Mul"!=c1&&"Div"!=c1&&"DivInt"!=c1&&"Mod"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2&&"Mul"!=c2&&"Div"!=c2&&"DivInt"!=c2&&"Mod"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"**"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1&&"Mul"!=c1&&"Div"!=c1&&"DivInt"!=c1&&"Mod"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2&&"Mul"!=c2&&"Div"!=c2&&"DivInt"!=c2&&"Mod"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" ** "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Pow}(Value),Add=function(_Value10){function Add(x,y,loc){return _classCallCheck(this,Add),_possibleConstructorReturn(this,(Add.__proto__||Object.getPrototypeOf(Add)).call(this,[x,y],loc))}return _inherits(Add,_Value10),_createClass(Add,[{key:"clone",value:function clone(){var rtnv=new Add(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の足し算はできません");if(v1 instanceof BooleanValue||v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽型の足し算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)this.rtnv=new StringValue(v1.value+v2.value,this.loc);else{var v=v1.value+v2.value;if(v1 instanceof FloatValue||v2 instanceof FloatValue){if(!isFinite(v))throw new RuntimeError(this.first_line,"オーバーフローしました");this.rtnv=new FloatValue(v,this.loc)}else{if(!isSafeInteger(v))throw new RuntimeError(this.first_line,"整数で表される範囲を越えました");this.rtnv=new IntValue(v,this.loc)}}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1,c2,brace1=!1,brace2=!1;return"Minus"==constructor_name(v1)&&(brace1=!0),"Minus"==constructor_name(v2)&&(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"+"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1,c2,brace1=!1,brace2=!1;return"Minus"==constructor_name(v1)&&(brace1=!0),"Minus"==constructor_name(v2)&&(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" + "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Add}(Value),Sub=function(_Value11){function Sub(x,y,loc){return _classCallCheck(this,Sub),_possibleConstructorReturn(this,(Sub.__proto__||Object.getPrototypeOf(Sub)).call(this,[x,y],loc))}return _inherits(Sub,_Value11),_createClass(Sub,[{key:"clone",value:function clone(){var rtnv=new Sub(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の引き算はできません");if(v1 instanceof BooleanValue||v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽型の引き算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列の引き算はできません");var v=v1.value-v2.value;if(v1 instanceof FloatValue||v2 instanceof FloatValue){if(!isFinite(v))throw new RuntimeError(this.first_line,"オーバーフローしました");this.rtnv=new FloatValue(v,this.loc)}else{if(!isSafeInteger(v))throw new RuntimeError(this.first_line,"整数で表される範囲を越えました");this.rtnv=new IntValue(v,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1,c2,brace1=!1,brace2=!1;return"Minus"==constructor_name(v1)&&(brace1=!0),"Minus"==constructor_name(v2)&&(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"-"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1,c2,brace1=!1,brace2=!1;return"Minus"==constructor_name(v1)&&(brace1=!0),"Minus"==constructor_name(v2)&&(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" - "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Sub}(Value),Mul=function(_Value12){function Mul(x,y,loc){return _classCallCheck(this,Mul),_possibleConstructorReturn(this,(Mul.__proto__||Object.getPrototypeOf(Mul)).call(this,[x,y],loc))}return _inherits(Mul,_Value12),_createClass(Mul,[{key:"clone",value:function clone(){var rtnv=new Mul(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のかけ算はできません");if(v1 instanceof BooleanValue||v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽型のかけ算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のかけ算はできません");var v=v1.value*v2.value;if(v1 instanceof FloatValue||v2 instanceof FloatValue){if(!isFinite(v))throw new RuntimeError(this.first_line,"オーバーフローしました");this.rtnv=new FloatValue(v,this.loc)}else{if(!isSafeInteger(v))throw new RuntimeError(this.first_line,"整数で表される範囲を越えました");this.rtnv=new IntValue(v,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"*"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" * "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Mul}(Value),Div=function(_Value13){function Div(x,y,loc){return _classCallCheck(this,Div),_possibleConstructorReturn(this,(Div.__proto__||Object.getPrototypeOf(Div)).call(this,[x,y],loc))}return _inherits(Div,_Value13),_createClass(Div,[{key:"clone",value:function clone(){var rtnv=new Div(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のわり算はできません");if(v1 instanceof BooleanValue||v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽型のわり算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のわり算はできません");if(0==v2.value)throw new RuntimeError(this.first_line,"0でわり算をしました");var v=v1.value/v2.value;if(!isFinite(v))throw new RuntimeError(this.first_line,"オーバーフローしました");this.rtnv=new FloatValue(v,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"/"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" / "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Div}(Value),DivInt=function(_Value14){function DivInt(x,y,loc){return _classCallCheck(this,DivInt),_possibleConstructorReturn(this,(DivInt.__proto__||Object.getPrototypeOf(DivInt)).call(this,[x,y],loc))}return _inherits(DivInt,_Value14),_createClass(DivInt,[{key:"clone",value:function clone(){var rtnv=new DivInt(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のわり算はできません");if(v1 instanceof BooleanValue||v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽型のわり算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のわり算はできません");if(0==v2.value)throw new RuntimeError(this.first_line,"0でわり算をしました");var v=Math.floor(v1.value/v2.value);if(!isSafeInteger(v))throw new RuntimeError(this.first_line,"整数で表される範囲を越えました");this.rtnv=new IntValue(v,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"//"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" // "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),DivInt}(Value),Mod=function(_Value15){function Mod(x,y,loc){return _classCallCheck(this,Mod),_possibleConstructorReturn(this,(Mod.__proto__||Object.getPrototypeOf(Mod)).call(this,[x,y],loc))}return _inherits(Mod,_Value15),_createClass(Mod,[{key:"clone",value:function clone(){var rtnv=new Mod(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(!(v1 instanceof IntValue&&v2 instanceof IntValue))throw new RuntimeError(this.first_line,"余りを出す計算は整数でしかできません");if(0==v2.value)throw new RuntimeError(this.first_line,"0でわり算をしました");var v=v1.value-Math.floor(v1.value/v2.value)*v2.value;if(!isSafeInteger(v))throw new RuntimeError(this.first_line,"整数で表される範囲を越えました");this.rtnv=new IntValue(v,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"%"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"Minus"!=c2&&"Add"!=c2&&"Sub"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+"%"+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Mod}(Value),Minus=function(_Value16){function Minus(x,loc){return _classCallCheck(this,Minus),_possibleConstructorReturn(this,(Minus.__proto__||Object.getPrototypeOf(Minus)).call(this,[x],loc))}return _inherits(Minus,_Value16),_createClass(Minus,[{key:"clone",value:function clone(){var rtnv=new Minus(this.value[0],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue();if(!(v1 instanceof IntValue||v1 instanceof FloatValue))throw new RuntimeError(this.first_line,"マイナスは数値にしかつけられません");var v=-v1.value;if(v1 instanceof IntValue&&!isSafeInteger(v))throw new RuntimeError(this.first_line,"整数で表される範囲を越えました");if(v1 instanceof FloatValue&&!isFinite(v))throw new RuntimeError(this.first_line,"オーバーフローしました");this.rtnv=v1 instanceof IntValue?new IntValue(v,this.loc):new FloatValue(v,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],c1=constructor_name(v1),brace1=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"-"+(brace1?"(":"")+v1.getCode()+(brace1?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],c1=constructor_name(v1),brace1=!1;return"Minus"!=c1&&"Add"!=c1&&"Sub"!=c1||(brace1=!0),"-"+(brace1?"(":"")+v1.makePython()+(brace1?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Minus}(Value),And=function(_Value17){function And(x,y,loc){return _classCallCheck(this,And),_possibleConstructorReturn(this,(And.__proto__||Object.getPrototypeOf(And)).call(this,[x,y],loc))}return _inherits(And,_Value17),_createClass(And,[{key:"clone",value:function clone(){var rtnv=new And(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue();if(!(v1 instanceof BooleanValue))throw new RuntimeError(this.first_line,"「かつ」は真偽値にしか使えません");if(v1.value){var v2=this.value[1].getValue();v2 instanceof BooleanValue&&(this.rtnv=new BooleanValue(v2.value,this.loc))}else this.rtnv=new BooleanValue(!1,this.loc);code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"And"!=c2&&"Or"!=c2&&"Not"!=c2||(brace2=!0),v1.getCode()+"かつ"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"And"!=c2&&"Or"!=c2&&"Not"!=c2||(brace2=!0),v1.makePython()+" and "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),And}(Value),Or=function(_Value18){function Or(x,y,loc){return _classCallCheck(this,Or),_possibleConstructorReturn(this,(Or.__proto__||Object.getPrototypeOf(Or)).call(this,[x,y],loc))}return _inherits(Or,_Value18),_createClass(Or,[{key:"clone",value:function clone(){var rtnv=new Or(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue();if(!(v1 instanceof BooleanValue))throw new RuntimeError(this.first_line,"「または」は真偽値にしか使えません");if(v1.value)this.rtnv=new BooleanValue(!0,this.loc);else{var v2=this.value[1].getValue();v2 instanceof BooleanValue&&(this.rtnv=new BooleanValue(v2.value,this.loc))}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"And"!=c2&&"Or"!=c2&&"Not"!=c2||(brace2=!0),v1.getCode()+"または"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"And"!=c2&&"Or"!=c2&&"Not"!=c2||(brace2=!0),v1.makePython()+" or "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Or}(Value),Not=function(_Value19){function Not(x,loc){return _classCallCheck(this,Not),_possibleConstructorReturn(this,(Not.__proto__||Object.getPrototypeOf(Not)).call(this,[x],loc))}return _inherits(Not,_Value19),_createClass(Not,[{key:"clone",value:function clone(){var rtnv=new Not(this.value[0],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue();if(!(v1 instanceof BooleanValue))throw new RuntimeError(this.first_line,"「でない」は真偽値にしか使えません");this.rtnv=new BooleanValue(!v1.value,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],c1=constructor_name(v1),brace1=!1;return v1.getCode()+"でない"}},{key:"makePython",value:function makePython(){var v1=this.value[0],c1=constructor_name(v1),brace1=!1;return"And"!=c1&&"Or"!=c1&&"Not"!=c1||(brace2=!0),"not "+v1.getCode()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Not}(Value),BitAnd=function(_Value20){function BitAnd(x,y,loc){return _classCallCheck(this,BitAnd),_possibleConstructorReturn(this,(BitAnd.__proto__||Object.getPrototypeOf(BitAnd)).call(this,[x,y],loc))}return _inherits(BitAnd,_Value20),_createClass(BitAnd,[{key:"clone",value:function clone(){var rtnv=new BitAnd(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビット積はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビット積はできません");if(v1 instanceof BooleanValue&&v2 instanceof BooleanValue)this.rtnv=new BooleanValue(v1.value&v2.value,this.loc);else{if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビット積はできません");v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),this.rtnv=new IntValue(v1.value&v2.value,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1||(brace1=!0),"Minus"!=c2&&"BitRShift"!=c2&&"BitLShift"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"&"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitRShift"!=c2&&"BitLShift"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" & "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),BitAnd}(Value),BitOr=function(_Value21){function BitOr(x,y,loc){return _classCallCheck(this,BitOr),_possibleConstructorReturn(this,(BitOr.__proto__||Object.getPrototypeOf(BitOr)).call(this,[x,y],loc))}return _inherits(BitOr,_Value21),_createClass(BitOr,[{key:"clone",value:function clone(){var rtnv=new BitOr(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビット和はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビット和はできません");if(v1 instanceof BooleanValue&&v2 instanceof BooleanValue)this.rtnv=new BooleanValue(v1.value&v2.value,this.loc);else{if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビット和はできません");v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),this.rtnv=new IntValue(v1.value|v2.value,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitRShift"!=c2&&"BitLShift"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"|"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitRShift"!=c2&&"BitLShift"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" | "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),BitOr}(Value),BitXor=function(_Value22){function BitXor(x,y,loc){return _classCallCheck(this,BitXor),_possibleConstructorReturn(this,(BitXor.__proto__||Object.getPrototypeOf(BitXor)).call(this,[x,y],loc))}return _inherits(BitXor,_Value22),_createClass(BitXor,[{key:"clone",value:function clone(){var rtnv=new BitXor(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の排他的ビット和はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列の排他的ビット和はできません");if(v1 instanceof BooleanValue&&v2 instanceof BooleanValue)this.rtnv=new BooleanValue(v1.value&v2.value,this.loc);else{if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数の排他的ビット和はできません");v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),this.rtnv=new IntValue(v1.value^v2.value,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitRShift"!=c2&&"BitLShift"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"^"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitRShift"!=c2&&"BitLShift"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" ^ "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),BitXor}(Value),BitNot=function(_Value23){function BitNot(x,loc){return _classCallCheck(this,BitNot),_possibleConstructorReturn(this,(BitNot.__proto__||Object.getPrototypeOf(BitNot)).call(this,[x],loc))}return _inherits(BitNot,_Value23),_createClass(BitNot,[{key:"clone",value:function clone(){var rtnv=new BitNot(this.value[0],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue();if(v1 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビット反転はできません");if(v1 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビット反転はできません");if(v1 instanceof BooleanValue)this.rtnv=new BooleanValue(!v1.value,this.loc);else{if(v1 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビット反転はできません");this.rtnv=new IntValue(~v1.value,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],c1=constructor_name(v1),brace1=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1||(brace1=!0),"~"+(brace1?"(":"")+v1.getCode()+(brace1?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],c1=constructor_name(v1),brace1=!1;return"Minus"!=c1&&"BitRShift"!=c1&&"BitLShift"!=c1||(brace1=!0),"~"+(brace1?"(":"")+v1.getCode()+(brace1?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),BitNot}(Value),BitLShift=function(_Value24){function BitLShift(x,y,loc){return _classCallCheck(this,BitLShift),_possibleConstructorReturn(this,(BitLShift.__proto__||Object.getPrototypeOf(BitLShift)).call(this,[x,y],loc))}return _inherits(BitLShift,_Value24),_createClass(BitLShift,[{key:"clone",value:function clone(){var rtnv=new BitLShift(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビットシフトはできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビットシフトはできません");if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビットシフトはできません");v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),this.rtnv=new IntValue(v1.value<<v2.value,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+"<<"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" << "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),BitLShift}(Value),BitRShift=function(_Value25){function BitRShift(x,y,loc){return _classCallCheck(this,BitRShift),_possibleConstructorReturn(this,(BitRShift.__proto__||Object.getPrototypeOf(BitRShift)).call(this,[x,y],loc))}return _inherits(BitRShift,_Value25),_createClass(BitRShift,[{key:"clone",value:function clone(){var rtnv=new BitRShift(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビットシフトはできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビットシフトはできません");if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビットシフトはできません");v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),this.rtnv=new IntValue(v1.value>>v2.value,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.getCode()+(brace1?")":"")+">>"+(brace2?"(":"")+v2.getCode()+(brace2?")":"")}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],c1=constructor_name(v1),c2=constructor_name(v2),brace1=!1,brace2=!1;return"Minus"!=c1&&"BitNot"!=c1||(brace1=!0),"Minus"!=c2&&"BitNot"!=c2||(brace2=!0),(brace1?"(":"")+v1.makePython()+(brace1?")":"")+" >> "+(brace2?"(":"")+v2.makePython()+(brace2?")":"")}},{key:"getValue",value:function getValue(){return this.rtnv}}]),BitRShift}(Value);function ArrayCompare(v1,v2){var rtnv=!0;if(v1 instanceof ArrayValue&&v2 instanceof ArrayValue){if(v1.length!=v2.length)return!1;for(var _i2=0;_i2<v1.length;_i2++)rtnv=rtnv&&ArrayCompare(v1.getValue().value[_i2],v2.getValue().value[_i2])}else rtnv=rtnv&&(void 0===v1?"undefined":_typeof(v1))==(void 0===v2?"undefined":_typeof(v2))&&v1.value==v2.value;return rtnv}var EQ=function(_Value26){function EQ(x,y,loc){return _classCallCheck(this,EQ),_possibleConstructorReturn(this,(EQ.__proto__||Object.getPrototypeOf(EQ)).call(this,[x,y],loc))}return _inherits(EQ,_Value26),_createClass(EQ,[{key:"clone",value:function clone(){var rtnv=new EQ(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)this.rtnv=new BooleanValue(ArrayCompare(v1,v2),this.loc);else{if(v1 instanceof StringValue!=v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列とそれ以外の値は比べられません");if(v1 instanceof BooleanValue!=v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽値とそれ以外の値は比べられません");this.rtnv=new BooleanValue(v1.value==v2.value,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.getCode()+"="+v2.getCode()}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.makePython()+" == "+v2.makePython()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),EQ}(Value),NE=function(_Value27){function NE(x,y,loc){return _classCallCheck(this,NE),_possibleConstructorReturn(this,(NE.__proto__||Object.getPrototypeOf(NE)).call(this,[x,y],loc))}return _inherits(NE,_Value27),_createClass(NE,[{key:"clone",value:function clone(){var rtnv=new NE(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)this.rtnv=new BooleanValue(!ArrayCompare(v1,v2),this.loc);else{if(v1 instanceof StringValue!=v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列とそれ以外の値は比べられません");if(v1 instanceof BooleanValue!=v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽値とそれ以外の値は比べられません");this.rtnv=new BooleanValue(v1.value!=v2.value,this.loc)}code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.getCode()+"!="+v2.getCode()}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.makePython()+" != "+v2.makePython()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),NE}(Value),GT=function(_Value28){function GT(x,y,loc){return _classCallCheck(this,GT),_possibleConstructorReturn(this,(GT.__proto__||Object.getPrototypeOf(GT)).call(this,[x,y],loc))}return _inherits(GT,_Value28),_createClass(GT,[{key:"clone",value:function clone(){var rtnv=new GT(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列を比べることはできません");if(v1 instanceof StringValue!=v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列とそれ以外の値は比べられません");if(v1 instanceof BooleanValue!=v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽値とそれ以外の値は比べられません");this.rtnv=new BooleanValue(v1.value>v2.value,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.getCode()+">"+v2.getCode()}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.makePython()+" > "+v2.makePython()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),GT}(Value),GE=function(_Value29){function GE(x,y,loc){return _classCallCheck(this,GE),_possibleConstructorReturn(this,(GE.__proto__||Object.getPrototypeOf(GE)).call(this,[x,y],loc))}return _inherits(GE,_Value29),_createClass(GE,[{key:"clone",value:function clone(){var rtnv=new GE(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列を比べることはできません");if(v1 instanceof StringValue!=v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列とそれ以外の値は比べられません");if(v1 instanceof BooleanValue!=v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽値とそれ以外の値は比べられません");this.rtnv=new BooleanValue(v1.value>=v2.value,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.getCode()+">="+v2.getCode()}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.makePython()+" >= "+v2.makePython()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),GE}(Value),LT=function(_Value30){function LT(x,y,loc){return _classCallCheck(this,LT),_possibleConstructorReturn(this,(LT.__proto__||Object.getPrototypeOf(LT)).call(this,[x,y],loc))}return _inherits(LT,_Value30),_createClass(LT,[{key:"clone",value:function clone(){var rtnv=new LT(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列を比べることはできません");if(v1 instanceof StringValue!=v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列とそれ以外の値は比べられません");if(v1 instanceof BooleanValue!=v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽値とそれ以外の値は比べられません");this.rtnv=new BooleanValue(v1.value<v2.value,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.getCode()+"<"+v2.getCode()}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.makePython()+" < "+v2.makePython()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),LT}(Value),LE=function(_Value31){function LE(x,y,loc){return _classCallCheck(this,LE),_possibleConstructorReturn(this,(LE.__proto__||Object.getPrototypeOf(LE)).call(this,[x,y],loc))}return _inherits(LE,_Value31),_createClass(LE,[{key:"clone",value:function clone(){var rtnv=new LE(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue();if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列を比べることはできません");if(v1 instanceof StringValue!=v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列とそれ以外の値は比べられません");if(v1 instanceof BooleanValue!=v2 instanceof BooleanValue)throw new RuntimeError(this.first_line,"真偽値とそれ以外の値は比べられません");this.rtnv=new BooleanValue(v1.value<=v2.value,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.getCode()+"<="+v2.getCode()}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.makePython()+" <= "+v2.makePython()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),LE}(Value),IN=function(_Value32){function IN(x,y,loc){return _classCallCheck(this,IN),_possibleConstructorReturn(this,(IN.__proto__||Object.getPrototypeOf(IN)).call(this,[x,y],loc))}return _inherits(IN,_Value32),_createClass(IN,[{key:"clone",value:function clone(){var rtnv=new IN(this.value[0],this.value[1],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=this.value[0].getValue(),v2=this.value[1].getValue(),flag=!1;if(!(v1 instanceof ArrayValue))throw new RuntimeError(this.first_line,'"の中に"の前には配列が必要です');for(i=0;i<v1.value.length;i++)flag|=ArrayCompare(v1.value[i],v2);this.rtnv=new BooleanValue(flag,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var v1=this.value[0],v2=this.value[1],brace1=!1,brace2=!1;return v1.getCode()+"の中に"+v2.getCode()}},{key:"makePython",value:function makePython(){var v1=this.value[0],v2,brace1=!1,brace2=!1;return this.value[1].makePython()+" in "+v1.makePython()}},{key:"getValue",value:function getValue(){return this.rtnv}}]),IN}(Value),ConvertInt=function(_Value33){function ConvertInt(x,loc){return _classCallCheck(this,ConvertInt),_possibleConstructorReturn(this,(ConvertInt.__proto__||Object.getPrototypeOf(ConvertInt)).call(this,[x],loc))}return _inherits(ConvertInt,_Value33),_createClass(ConvertInt,[{key:"clone",value:function clone(){var rtnv=new ConvertInt(this.value[0],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v=this.value[0].getValue(),r=Number.NaN;if(v instanceof IntValue?r=v.value:v instanceof FloatValue?r=Math.floor(v.value):v instanceof StringValue?r=Math.floor(Number(v.value)):v instanceof BooleanValue&&(r=v.value?1:0),!isSafeInteger(r))throw new RuntimeError(this.loc.first_line,"整数に直せません");this.rtnv=new IntValue(r,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){return"整数("+this.value[0].getCode()+")"}},{key:"makePython",value:function makePython(){return"int("+this.value[0].makePython()+")"}},{key:"getValue",value:function getValue(){return this.rtnv}}]),ConvertInt}(Value),ConvertFloat=function(_Value34){function ConvertFloat(x,loc){return _classCallCheck(this,ConvertFloat),_possibleConstructorReturn(this,(ConvertFloat.__proto__||Object.getPrototypeOf(ConvertFloat)).call(this,[x],loc))}return _inherits(ConvertFloat,_Value34),_createClass(ConvertFloat,[{key:"clone",value:function clone(){var rtnv=new ConvertFloat(this.value[0],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v=this.value[0].getValue(),r=Number.NaN;if(v instanceof IntValue||v instanceof FloatValue?r=v.value:v instanceof StringValue?r=Number(v.value):v instanceof BooleanValue&&(r=v.value?1:0),!isFinite(r))throw new RuntimeError(this.loc.first_line,"実数に直せません");this.rtnv=new FloatValue(r,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){return"実数("+this.value[0].getCode()+")"}},{key:"makePython",value:function makePython(){return"float("+this.value[0].makePython()+")"}},{key:"getValue",value:function getValue(){return this.rtnv}}]),ConvertFloat}(Value),ConvertString=function(_Value35){function ConvertString(x,loc){return _classCallCheck(this,ConvertString),_possibleConstructorReturn(this,(ConvertString.__proto__||Object.getPrototypeOf(ConvertString)).call(this,[x],loc))}return _inherits(ConvertString,_Value35),_createClass(ConvertString,[{key:"clone",value:function clone(){var rtnv=new ConvertString(this.value[0],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v=this.value[0].getValue(),r="";v instanceof IntValue||v instanceof FloatValue?r=String(v.value):v instanceof StringValue?r=v.value:v instanceof BooleanValue&&(r=v.value?"True":"False"),this.rtnv=new StringValue(r,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){return"文字列("+this.value[0].getCode()+")"}},{key:"makePython",value:function makePython(){return"str("+this.value[0].makePython()+")"}},{key:"getValue",value:function getValue(){return this.rtnv}}]),ConvertString}(Value),ConvertBool=function(_Value36){function ConvertBool(x,loc){return _classCallCheck(this,ConvertBool),_possibleConstructorReturn(this,(ConvertBool.__proto__||Object.getPrototypeOf(ConvertBool)).call(this,[x],loc))}return _inherits(ConvertBool,_Value36),_createClass(ConvertBool,[{key:"clone",value:function clone(){var rtnv=new ConvertBool(this.value[0],this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v=this.value[0].getValue(),r="",re=/^(0+|false|偽|)$/i;v instanceof IntValue||v instanceof FloatValue?r=0!=v.value:v instanceof StringValue?r=!re.exec(v.value):v instanceof BooleanValue&&(r=v.value),this.rtnv=new BooleanValue(r,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){return"真偽("+this.value[0].getCode()+")"}},{key:"makePython",value:function makePython(){return"bool("+this.value[0].makePython()+")"}},{key:"getValue",value:function getValue(){return this.rtnv}}]),ConvertBool}(Value),Variable=function(_Value37){function Variable(x,y,loc){_classCallCheck(this,Variable);var _this40=_possibleConstructorReturn(this,(Variable.__proto__||Object.getPrototypeOf(Variable)).call(this,[x,y],loc));return _this40.rtnv=null,_this40}return _inherits(Variable,_Value37),_createClass(Variable,[{key:"clone",value:function clone(){var rtnv=new Variable(this.value[0],this.value[1]?this.value[1]:null,this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var vn=this.value[0],vt=findVarTable(vn);if(!vt)throw new RuntimeError(this.first_line,"変数"+this.value[0]+"が定義されていません");var v=vt.vars[vn];this.rtnv=getValueByArgs(v,this.args,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){var vn=this.value[0],pm=this.value[1];if(null!=pm){for(var ag=new Array(pm.length),_i3=0;_i3<pm.length;_i3++)ag[_i3]=pm.value[_i3].getCode();vn+="["+ag.join(",")+"]"}return vn}},{key:"makePython",value:function makePython(){var vn=this.value[0],pm=this.value[1];if(null!=pm){for(var ag=new Array(pm.length),_i4=0;_i4<pm.length;_i4++)ag[_i4]="["+pm.value[_i4].makePython()+"]";vn+=ag.join("")}return vn}},{key:"getValue",value:function getValue(){return this.rtnv}},{key:"append",value:function append(a){this.args?this.args.append(a):this.value[1]=new ArrayValue(a,this.loc)}},{key:"varname",get:function get(){return this.value[0]}},{key:"args",get:function get(){return this.value[1]}}]),Variable}(Value),DefinedFunction=function(){function DefinedFunction(argc,func,module,convert){_classCallCheck(this,DefinedFunction),this.argc=argc,this.func=func,this.module=module,this.convert=convert,this.caller=null,this.loc=null}return _createClass(DefinedFunction,[{key:"run",value:function run(){if(!(this.argc instanceof Array&&this.argc[0]<=this.parameters.length&&this.argc[1]>=this.parameters.length||this.parameters.length==this.argc))throw new RuntimeError(this.loc.first_line,"引数の個数が違います");code[0].stack[0].index++,this.caller.setValue(this.func(this.parameters,this.loc)),code.shift()}},{key:"clone",value:function clone(){return new DefinedFunction(this.argc,this.func,this.module,this.convert)}},{key:"setCaller",value:function setCaller(caller){this.caller=caller}},{key:"setParameter",value:function setParameter(params){this.parameters=params}},{key:"setLocation",value:function setLocation(loc){this.loc=loc}}]),DefinedFunction}(),definedFunction={keys:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof DictionaryValue){var args=[],keys=Object.keys(par1.value);keys.sort();for(var _i5=0;_i5<keys.length;_i5++)args.push(new StringValue(keys[_i5],loc));return new ArrayValue(args,this.loc)}throw new RuntimeError(loc.first_line,"keysは辞書にしか使えません")}),null,null),abs:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue)return new IntValue(Math.abs(par1.value),loc);if(par1 instanceof FloatValue)return new FloatValue(Math.abs(par1.value),loc);throw new RuntimeError(loc.first_line,"absは数値にしか使えません")}),null,null),random:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue)return new IntValue(Math.floor(Math.random()*Math.floor(par1.value+1)),this.loc);throw new RuntimeError(loc.first_line,"randomは整数にしか使えません")}),"random",(function(argc){return"random.randint(0,"+argc[0]+")"})),ceil:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue)return par1;if(par1 instanceof FloatValue)return new IntValue(Math.ceil(par1.value),this.loc);throw new RuntimeError(loc.first_line,"ceilは数値にしか使えません")}),"math",null),floor:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue)return par1;if(par1 instanceof FloatValue)return new IntValue(Math.floor(par1.value),this.loc);throw new RuntimeError(loc.first_line,"floorは数値にしか使えません")}),"math",null),round:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue)return par1;if(par1 instanceof FloatValue)return new IntValue(Math.round(par1.value),this.loc);throw new RuntimeError(loc.first_line,"roundは数値にしか使えません")}),null,null),sin:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue)return new FloatValue(Math.sin(par1.value),this.loc);throw new RuntimeError(loc.first_line,"sinは数値にしか使えません")}),"math",null),cos:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue)return new FloatValue(Math.cos(par1.value),this.loc);throw new RuntimeError(loc.first_line,"cosは数値にしか使えません")}),"math",null),tan:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue){var v=Math.tan(par1.value);if(isFinite(v))return new FloatValue(v,this.loc);throw new RuntimeError(loc.first_line,"オーバーフローしました")}throw new RuntimeError(loc.first_line,"tanは数値にしか使えません")}),"math",null),asin:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue){if(par1.value>1||par1.value<-1)throw new RuntimeError(loc.first_line,"asinの定義域外の値が使われました");return new FloatValue(Math.asin(par1.value),this.loc)}throw new RuntimeError(loc.first_line,"asinは数値にしか使えません")}),"math",null),acos:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue){if(par1.value>1||par1.value<-1)throw new RuntimeError(loc.first_line,"acosの定義域外の値が使われました");return new FloatValue(Math.acos(par1.value),this.loc)}throw new RuntimeError(loc.first_line,"acosは数値にしか使えません")}),"math",null),atan:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue)return new FloatValue(Math.atan(par1.value),this.loc);throw new RuntimeError(loc.first_line,"atanは数値にしか使えません")}),"math",null),atan2:new DefinedFunction(2,(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue();if((par1 instanceof IntValue||par1 instanceof FloatValue)&&(par2 instanceof IntValue||par2 instanceof FloatValue))return new FloatValue(Math.atan2(par1.value,par2.value),this.loc);throw new RuntimeError(loc.first_line,"atan2は数値にしか使えません")}),"math",null),sqrt:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue){if(par1.value<0)throw new RuntimeError(loc.first_line,"負の数のルートを求めようとしました");return new FloatValue(Math.sqrt(par1.value),this.loc)}throw new RuntimeError(this.first_line,"sqrtは数値にしか使えません")}),"math",null),log:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue){if(par1.value<=0)throw new RuntimeError(loc.first_line,"正でない数の対数を求めようとしました");var v=Math.log(par1.value);if(isFinite(v))return new FloatValue(v,this.loc);throw new RuntimeError(this.first_line,"オーバーフローしました")}throw new RuntimeError(loc.first_line,"logは数値にしか使えません")}),"math",null),exp:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof IntValue||par1 instanceof FloatValue){var v=Math.exp(par1.value);if(isFinite(v))return new FloatValue(v,this.loc);throw new RuntimeError(loc.first_line,"オーバーフローしました")}throw new RuntimeError(loc.first_line,"expは数値にしか使えません")}),"math",null),pow:new DefinedFunction(2,(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue();if(par1 instanceof IntValue&&par2 instanceof IntValue&&par2.value>=0){if(0==par1.value&&par2.value<=0)throw new RuntimeError(loc.first_line,"0は正の数乗しかできません");var v=Math.pow(par1.value,par2.value);if(isSafeInteger(v))return new IntValue(v,this.loc);throw new RuntimeError(loc.first_line,"整数で表せる範囲を越えました")}if((par1 instanceof IntValue||par1 instanceof FloatValue)&&(par2 instanceof IntValue||par2 instanceof FloatValue)){if(par1.value<0&&!Number.isInteger(par2.value))throw new RuntimeError(loc.first_line,"負の数の非整数乗はできません");if(0==par1.value&&par2.value<=0)throw new RuntimeError(loc.first_line,"0は正の数乗しかできません");var _v2=Math.pow(par1.value,par2.value);if(isFinite(_v2))return new FloatValue(_v2,this.loc);throw new RuntimeError(loc.first_line,"オーバーフローしました")}throw new RuntimeError(loc.first_line,"powerは数値にしか使えません")}),null,null),length:new DefinedFunction(1,(function(param,loc){var par1=param[0].getValue();if(par1 instanceof StringValue)return new IntValue(par1.value.length,this.loc);if(par1 instanceof ArrayValue)return new IntValue(par1.length,this.loc);throw new RuntimeError(loc.first_line,"lengthは文字列と配列にしか使えません")}),null,(function(argc){return"len("+argc[0]+")"})),substring:new DefinedFunction([2,3],(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue(),par3=3==param.length?param[2].getValue():null,v;if(par1 instanceof StringValue&&par2 instanceof IntValue&&(null==par3||par3 instanceof IntValue))return v=null==par3?par1.value.substr(par2.value):par1.value.substr(par2.value,par3.value),new StringValue(v,this.loc);throw new RuntimeError(loc.first_line,"substringの引数の型が違います")}),null,(function(argc){var code=argc[0]+"["+argc[1]+":";return argc[2]&&(code+=argc[1]+"+"+argc[2]),code+"]"})),append:new DefinedFunction(2,(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue();if(par2 instanceof StringValue&&par2 instanceof StringValue)return new StringValue(par1.value+par2.value,this.loc);throw new RuntimeError(loc.first_line,"appendの引数の型が違います")}),null,(function(argc){return argc[0]+"+"+argc[1]})),split:new DefinedFunction(2,(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue();if(par1 instanceof StringValue&&par2 instanceof StringValue){for(var v1=par1.value,v2=par2.value,v=v1.split(v2),vr=[],i=0;i<v.length;i++)vr.push(new StringValue(v[i],this.loc));return new ArrayValue(vr,this.loc)}throw new RuntimeError(loc.first_line,"splitの引数の型が違います")}),null,(function(argc){return argc[0]+".split("+argc[1]+")"})),extract:new DefinedFunction(3,(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue(),par3=param[2].getValue();if(par1 instanceof StringValue&&par2 instanceof StringValue&&par3 instanceof IntValue){var v1=par1.value,v2=par2.value,v3=par3.value,v=v1.split(v2);if(v3>=0&&v3<v.length)return new StringValue(v[v3],this.loc);throw new RuntimeError(loc.first_line,"番号の値が不正です")}throw new RuntimeError(loc.first_line,"extractの引数の型が違います")}),null,(function(argc){return argc[0]+".split("+argc[1]+")["+argc[2]+"]"})),insert:new DefinedFunction(3,(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue(),par3=param[2].getValue();if(par1 instanceof StringValue&&par2 instanceof IntValue&&par3 instanceof StringValue){var v1=par1.value,v2=par2.value,v3=par3.value;if(v2<0||v2>v1.length)throw new RuntimeError(loc.first_line,"位置の値が不正です");var s1=v1.substr(0,v2),s2=v1.substr(v2);return new StringValue(s1+v3+s2,this.loc)}throw new RuntimeError(loc.first_line,"insertの引数の型が違います")}),null,(function(argc){return argc[0]+"[:"+argc[1]+"]+"+argc[2]+"+"+argc[0]+"["+argc[1]+":]"})),replace:new DefinedFunction(4,(function(param,loc){var par1=param[0].getValue(),par2=param[1].getValue(),par3=param[2].getValue(),par4=param[3].getValue();if(par1 instanceof StringValue&&par2 instanceof IntValue&&par3 instanceof IntValue&&par4 instanceof StringValue){var v1=par1.value,v2=par2.value,v3=par3.value,v4=par4.value;if(v2<0||v2>v1.length)throw new RuntimeError(loc.first_line,"位置の値が不正です");if(v3<0||v2+v3>v1.length)throw new RuntimeError(loc.first_line,"長さの値が不正です");var s1=v1.substr(0,v2),s2=v1.substr(v2+v3);return new StringValue(s1+v4+s2,this.loc)}throw new RuntimeError(loc.first_line,"replaceの引数の型が違います")}),null,(function(argc){return argc[0]+"[:"+argc[1]+"]+"+argc[3]+"+"+argc[0]+"["+argc[1]+"+"+argc[2]+":]"}))};function setCaller(statementlist,caller){for(var _i6=0;_i6<statementlist.length;_i6++)statementlist[_i6].statementlist&&setCaller(statementlist[_i6].statementlist,caller),statementlist[_i6].state&&setCaller(statementlist[_i6].state,caller),statementlist[_i6].state1&&setCaller(statementlist[_i6].state1,caller),statementlist[_i6].state2&&setCaller(statementlist[_i6].state2,caller),statementlist[_i6]instanceof ReturnStatement&&statementlist[_i6].setCaller(caller,!0)}function cloneStatementlist(statementlist){for(var rtnv=[],_i7=0;_i7<statementlist.length;_i7++){var statement=statementlist[_i7];rtnv.push(statement.clone())}return rtnv}var CallFunction=function(_Value38){function CallFunction(funcname,parameter,loc){_classCallCheck(this,CallFunction);var _this41=_possibleConstructorReturn(this,(CallFunction.__proto__||Object.getPrototypeOf(CallFunction)).call(this,{funcname:funcname,parameter:parameter},loc));return _this41.rtnv=null,_this41}return _inherits(CallFunction,_Value38),_createClass(CallFunction,[{key:"clone",value:function clone(){var rtnv;return this.rtnv.clone()}},{key:"run",value:function run(){var func=this.value.funcname,param=this.value.parameter;if(definedFunction[func]){var index=code[0].stack[0].index,fn=definedFunction[func].clone();fn.setCaller(this),fn.setParameter(param),fn.setLocation(this.loc);var statementlist=[new runBeforeGetValue(param),fn];code.unshift(new parsedFunction(statementlist)),code[1].stack[0].index=index+1}else{if(!myFuncs[func])throw new RuntimeError(this.first_line,"関数 "+func+" は定義されていません");code[0].stack[0].index++;var _fn=myFuncs[func],vt=new varTable,globalVarTable=varTables[varTables.length-1],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=Object.keys(globalVarTable.vars)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _i8=_step.value;vt.vars[_i8]=globalVarTable.vars[_i8].getValue().clone()}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}for(var _i9=0;_i9<_fn.params.length;_i9++)vt.vars[_fn.params[_i9].varname]=param[_i9].getValue().clone();var _statementlist=cloneStatementlist(_fn.statementlist);_statementlist.unshift(new runBeforeGetValue(_fn.param)),setCaller(_statementlist,this),_statementlist.push(new notReturnedFunction(_fn.loc));var pf=new parsedFunction(_statementlist);code.unshift(pf),varTables.unshift(vt)}}},{key:"setValue",value:function setValue(v){this.rtnv=v.clone()}},{key:"getValue",value:function getValue(){return this.rtnv}},{key:"getCode",value:function getCode(){for(var func=this.value.funcname,param=this.value.parameter,ag=[],_i10=0;_i10<param.length;_i10++)ag.push(param[_i10].getCode());return func+"("+ag.join(",")+")"}},{key:"makePython",value:function makePython(){var func=this.value.funcname,param=this.value.parameter,deffunc=null;definedFunction[func]?deffunc=definedFunction[func]:myFuncs[func]&&(deffunc=myFuncs[func]);for(var ag=[],_i11=0;_i11<param.length;_i11++)ag.push(param[_i11].makePython());if(deffunc){var prefix="";return deffunc.module&&(prefix=deffunc.module+".",python_lib[deffunc.module]=1),deffunc.convert?deffunc.convert(ag):prefix+func+"("+ag.join(",")+")"}return func+"("+ag.join(",")+")"}}]),CallFunction}(Value),Connect=function(_Value39){function Connect(x,y,loc){return _classCallCheck(this,Connect),_possibleConstructorReturn(this,(Connect.__proto__||Object.getPrototypeOf(Connect)).call(this,[x,y],loc))}return _inherits(Connect,_Value39),_createClass(Connect,[{key:"clone",value:function clone(){var rtnv=new Connect(this.value[0].clone(),this.value[1].clone(),this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var v1=void 0,v2=void 0,v=(v1=array2text(this.value[0].getValue()))+(v2=array2text(this.value[1].getValue()));this.rtnv=new StringValue(v,this.loc),code[0].stack[0].index++}},{key:"getCode",value:function getCode(){return this.value[0].getCode()+"と"+this.value[1].getCode()}},{key:"makePython",value:function makePython(){var re=/^str\(/,p1=this.value[0].makePython(),p2=this.value[1].makePython();return re.exec(p1)||this.value[0]instanceof StringValue||(p1="str("+p1+")"),re.exec(p2)||this.value[1]instanceof StringValue||(p2="str("+p2+")"),p1+"+"+p2}},{key:"getValue",value:function getValue(){return this.rtnv}}]),Connect}(Value),SliceValue=function(_Value40){function SliceValue(x,y,loc){return _classCallCheck(this,SliceValue),_possibleConstructorReturn(this,(SliceValue.__proto__||Object.getPrototypeOf(SliceValue)).call(this,[x,y],loc))}return _inherits(SliceValue,_Value40),_createClass(SliceValue,[{key:"clone",value:function clone(){var rtnv=new SliceValue(this.value[0].clone(),this.value[1].clone(),this.loc);return rtnv.rtnv=this.rtnv,rtnv}},{key:"run",value:function run(){var idx=code[0].stack[0].index;this.value[0].run(),this.value[1].run(),code[0].stack[0].index=idx+1}},{key:"getCode",value:function getCode(){return this.value[0].getCode()+":"+this.value[1].getCode()}},{key:"makePython",value:function makePython(){var p1,p2;return this.value[0].makePython()+":"+this.value[1].makePython()}},{key:"getValue",value:function getValue(){return this}},{key:"getValue1",value:function getValue1(){return this.value[0]}},{key:"getValue2",value:function getValue2(){return this.value[1]}}]),SliceValue}(Value),Statement=function(){function Statement(loc){_classCallCheck(this,Statement),this._loc=loc}return _createClass(Statement,[{key:"run",value:function run(){code[0].stack[0].index++}},{key:"makePython",value:function makePython(indent){return Parts.makeIndent(indent)}},{key:"clone",value:function clone(){throw new RuntimeError(this.first_line,constructor_name(this)+"はcloneが作られていません")}},{key:"first_line",get:function get(){return this._loc.first_line}},{key:"last_line",get:function get(){return this._loc.last_line}},{key:"loc",get:function get(){return this._loc}}]),Statement}(),DefineStep=function(_Statement){function DefineStep(funcName,params,statementlist,loc){_classCallCheck(this,DefineStep);var _this44=_possibleConstructorReturn(this,(DefineStep.__proto__||Object.getPrototypeOf(DefineStep)).call(this,loc));if(definedFunction[funcName])throw new RuntimeError(_this44.first_line,"手続き "+funcName+" と同名の標準関数が存在します");if(myFuncs[funcName])throw new RuntimeError(_this44.first_line,"手続き "+funcName+" と同名の関数、または手続きが既に定義されています");return _this44.params=params,_this44.statementlist=statementlist,_this44.funcName=funcName,myFuncs[funcName]=_this44,_this44}return _inherits(DefineStep,_Statement),_createClass(DefineStep,[{key:"makePython",value:function makePython(indent){for(var code="def "+this.funcName+"(",i=0;i<this.params.length;i++)i>0&&(code+=","),code+=this.params[i].varname;code+="):\n";for(var codes=0,i=0;i<this.statementlist.length;i++)this.statementlist[i]&&(codes=1,code+=this.statementlist[i].makePython(1));return 0==codes&&(code+=Parts.makeIndent(1)+"None\n"),code}}]),DefineStep}(Statement),afterCallStep=function(){function afterCallStep(){_classCallCheck(this,afterCallStep)}return _createClass(afterCallStep,[{key:"run",value:function run(){varTables.shift(),code.shift()}}]),afterCallStep}(),CallStep=function(_Statement2){function CallStep(funcName,args,loc){_classCallCheck(this,CallStep);var _this45=_possibleConstructorReturn(this,(CallStep.__proto__||Object.getPrototypeOf(CallStep)).call(this,loc));return _this45.funcName=funcName,_this45.args=args,_this45}return _inherits(CallStep,_Statement2),_createClass(CallStep,[{key:"clone",value:function clone(){return new CallStep(this.funcName,this.args.clone(),this.loc)}},{key:"run",value:function run(){code[0].stack[0].index++;var fn=this.funcName,args=this.args;if(!myFuncs[fn])throw new RuntimeError(this.first_line,"手続き "+fn+" は定義されていません");var vt=new varTable,globalVarTable=varTables[varTables.length-1],_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _iterator2=Object.keys(globalVarTable.vars)[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var _i12=_step2.value;vt.vars[_i12]=globalVarTable.vars[_i12].getValue().clone()}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}for(var _i13=0;_i13<myFuncs[fn].params.length;_i13++)vt.vars[myFuncs[fn].params[_i13].varname]=args[_i13].getValue().clone();var statementlist=myFuncs[fn].statementlist.concat();statementlist.push(new afterCallStep),code.unshift(new parsedStep(statementlist)),varTables.unshift(vt)}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);code+=this.funcName+"(";for(var i=0;i<this.args.length;i++)i>0&&(code+=","),code+=this.args[i].varname;return code+")\n"}}]),CallStep}(Statement),ExitStatement=function(_Statement3){function ExitStatement(loc){return _classCallCheck(this,ExitStatement),_possibleConstructorReturn(this,(ExitStatement.__proto__||Object.getPrototypeOf(ExitStatement)).call(this,loc))}return _inherits(ExitStatement,_Statement3),_createClass(ExitStatement,[{key:"clone",value:function clone(){return new ExitStatement(this.loc)}},{key:"run",value:function run(){if(!(code[0]instanceof parsedStep))throw new RuntimeError(this.first_line,"手続きの中ではありません");code.shift(),varTables.shift()}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);return code+="break\n"}}]),ExitStatement}(Statement),DefineFunction=function(_Statement4){function DefineFunction(funcName,params,statementlist,loc){_classCallCheck(this,DefineFunction);var _this47=_possibleConstructorReturn(this,(DefineFunction.__proto__||Object.getPrototypeOf(DefineFunction)).call(this,loc));if(definedFunction[funcName])throw new RuntimeError(_this47.first_line,"関数 "+funcName+" と同名の標準関数が存在します");if(myFuncs[funcName])throw new RuntimeError(_this47.first_line,"関数 "+funcName+" と同名の関数、または手続きが既に定義されています");return _this47.params=params,_this47.funcName=funcName,myFuncs[funcName]=_this47,_this47.statementlist=statementlist,_this47}return _inherits(DefineFunction,_Statement4),_createClass(DefineFunction,[{key:"run",value:function run(){_get(DefineFunction.prototype.__proto__||Object.getPrototypeOf(DefineFunction.prototype),"run",this).call(this)}},{key:"makePython",value:function makePython(indent){var code="def ";code+=this.funcName+"(";for(var i=0;i<this.params.length;i++)i>0&&(code+=","),code+=this.params[i].makePython();code+="):\n";for(var codes=0,i=0;i<this.statementlist.length;i++)this.statementlist[i]&&(codes=1,code+=this.statementlist[i].makePython(1));return 0==codes&&(code+=Parts.makeIndent(1)+"None\n"),code}}]),DefineFunction}(Statement),ReturnStatement=function(_Statement5){function ReturnStatement(value,loc){_classCallCheck(this,ReturnStatement);var _this48=_possibleConstructorReturn(this,(ReturnStatement.__proto__||Object.getPrototypeOf(ReturnStatement)).call(this,loc));return _this48.value=value,_this48.caller=null,_this48.flag=!1,_this48}return _inherits(ReturnStatement,_Statement5),_createClass(ReturnStatement,[{key:"clone",value:function clone(){return new ReturnStatement(this.value,this.loc)}},{key:"setCaller",value:function setCaller(caller,flag){this.caller=caller,this.flag=flag}},{key:"run",value:function run(){if(!(code[0]instanceof parsedFunction))throw new RuntimeError(this.first_line,"関数の中ではありません");this.caller.setValue(this.value.getValue()),code.shift(),this.flag&&varTables.shift()}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);return code+="return",this.value&&(code+=" "+this.value.makePython()),code+"\n"}}]),ReturnStatement}(Statement),notReturnedFunction=function(_Statement6){function notReturnedFunction(loc){return _classCallCheck(this,notReturnedFunction),_possibleConstructorReturn(this,(notReturnedFunction.__proto__||Object.getPrototypeOf(notReturnedFunction)).call(this,loc))}return _inherits(notReturnedFunction,_Statement6),_createClass(notReturnedFunction,[{key:"clone",value:function clone(){return new notReturnedFunction(this.loc)}},{key:"run",value:function run(){throw new RuntimeError(this.last_line,"関数が値を返さずに終了しました")}},{key:"makePython",value:function makePython(){return""}}]),notReturnedFunction}(Statement);function dump(){textareaAppend("*** 変数確認 ***\n");var vars=varTables[0].varnames([]);varTables.length>1&&(vars=varTables[varTables.length-1].varnames(vars));for(var i=0;i<vars.length;i++){var vartable,v=findVarTable(vars[i]).vars[vars[i]];textareaAppend(vars[i]+":"+array2code(v)+"\n")}}var DumpStatement=function(_Statement7){function DumpStatement(loc){return _classCallCheck(this,DumpStatement),_possibleConstructorReturn(this,(DumpStatement.__proto__||Object.getPrototypeOf(DumpStatement)).call(this,loc))}return _inherits(DumpStatement,_Statement7),_createClass(DumpStatement,[{key:"clone",value:function clone(){return new DumpStatement(this.loc)}},{key:"run",value:function run(){dump(),_get(DumpStatement.prototype.__proto__||Object.getPrototypeOf(DumpStatement.prototype),"run",this).call(this)}},{key:"makePython",value:function makePython(){return""}}]),DumpStatement}(Statement);function valuelist2stack(args,queue){if(args instanceof Array)for(var _i14=0;_i14<args.length;_i14++){var v=args[_i14];v instanceof ArrayValue?valuelist2stack(v.value,queue):v instanceof DictionaryValue?valuelist2stack(v.value,queue):v instanceof Variable&&v.args?valuelist2stack(v.args,queue):v&&!(v instanceof Variable)&&v.value instanceof Array?valuelist2stack(v.value,queue):v instanceof CallFunction&&valuelist2stack(v.value.parameter,queue),queue.push(v)}else if(args instanceof ArrayValue)for(var _i15=0;_i15<args.length;_i15++){var _v3=args.value[_i15];_v3 instanceof ArrayValue?valuelist2stack(_v3.value,queue):_v3 instanceof DictionaryValue?valuelist2stack(_v3.value,queue):_v3 instanceof Variable&&_v3.args?valuelist2stack(_v3.args,queue):_v3&&!(_v3 instanceof Variable)&&_v3.value instanceof Array?valuelist2stack(_v3.value,queue):_v3 instanceof CallFunction&&valuelist2stack(_v3.value.parameter,queue),queue.push(_v3)}else if(args instanceof DictionaryValue)for(var key in args.getValue().value){var _v4=args.getValue().value[key];_v4 instanceof ArrayValue?valuelist2stack(_v4.value,queue):_v4 instanceof DictionaryValue?valuelist2stack(_v4.value,queue):_v4 instanceof Variable&&_v4.args?valuelist2stack(_v4.args,queue):_v4&&!(_v4 instanceof Variable)&&_v4.value instanceof Array?valuelist2stack(_v4.value,queue):_v4 instanceof CallFunction&&valuelist2stack(_v4.value.parameter,queue),queue.push(_v4)}else for(var key in args){var _v5=args[key];_v5&&(_v5 instanceof ArrayValue?valuelist2stack(_v5.value,queue):_v5 instanceof DictionaryValue?valuelist2stack(_v5.value,queue):_v5 instanceof Variable&&_v5.args?valuelist2stack(_v5.args,queue):_v5&&!(_v5 instanceof Variable)&&_v5.value instanceof Array?valuelist2stack(_v5.value,queue):_v5 instanceof CallFunction&&valuelist2stack(_v5.value.parameter,queue),_v5&&queue.push(_v5))}}var runBeforeGetValue=function(_Statement8){function runBeforeGetValue(args,loc){_classCallCheck(this,runBeforeGetValue);var _this51=_possibleConstructorReturn(this,(runBeforeGetValue.__proto__||Object.getPrototypeOf(runBeforeGetValue)).call(this,loc));return _this51.args=args,_this51}return _inherits(runBeforeGetValue,_Statement8),_createClass(runBeforeGetValue,[{key:"clone",value:function clone(){return new runBeforeGetValue(this.args,this.loc)}},{key:"run",value:function run(){_get(runBeforeGetValue.prototype.__proto__||Object.getPrototypeOf(runBeforeGetValue.prototype),"run",this).call(this);var queue=[];valuelist2stack(this.args,queue),code[0].stack.unshift({statementlist:queue,index:0})}},{key:"makePython",value:function makePython(){return""}}]),runBeforeGetValue}(Statement),runArgsBeforeGetValue=function(_Statement9){function runArgsBeforeGetValue(args,loc){_classCallCheck(this,runArgsBeforeGetValue);var _this52=_possibleConstructorReturn(this,(runArgsBeforeGetValue.__proto__||Object.getPrototypeOf(runArgsBeforeGetValue)).call(this,loc));return _this52.args=args,_this52}return _inherits(runArgsBeforeGetValue,_Statement9),_createClass(runArgsBeforeGetValue,[{key:"clone",value:function clone(){for(var args=[],i=0;i<this.args.length;i++)args.push(this.args[i].clone());return new runArgsBeforeGetValue(this.args,this.loc)}},{key:"run",value:function run(){_get(runArgsBeforeGetValue.prototype.__proto__||Object.getPrototypeOf(runArgsBeforeGetValue.prototype),"run",this).call(this);for(var queue=[],_i16=0;_i16<this.args.length;_i16++)this.args[_i16]instanceof SliceValue?(valuelist2stack(this.args[_i16].getValue1(),queue),valuelist2stack(this.args[_i16].getValue2(),queue)):(this.args[_i16].parameter&&valuelist2stack(this.args[_i16].parameter,queue),this.args[_i16].args&&valuelist2stack(this.args[_i16].args,queue));code[0].stack.unshift({statementlist:queue,index:0})}},{key:"makePython",value:function makePython(){return""}}]),runArgsBeforeGetValue}(Statement);function argsString(args){if(args instanceof ArrayValue){for(var a=[],_i17=0;_i17<args.value.length;_i17++)a.push(args.value[_i17].getValue().value);return"["+a.join(",")+"]"}return""}var Assign=function(_Statement10){function Assign(variable,value,operator,loc){_classCallCheck(this,Assign);var _this53=_possibleConstructorReturn(this,(Assign.__proto__||Object.getPrototypeOf(Assign)).call(this,loc));if(!(variable instanceof Variable||variable instanceof UNDEFINED))throw new RuntimeError(loc.first_line,"変数でないものに代入はできません");return _this53.variable=variable,_this53.value=value,_this53.operator=operator,_this53}return _inherits(Assign,_Statement10),_createClass(Assign,[{key:"clone",value:function clone(){return new Assign(this.variable,this.value,this.operator,this.loc)}},{key:"run",value:function run(){if(this.variable instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");var index=code[0].stack[0].index,vn=this.variable.varname,ag=this.variable.args,vl=this.value.getValue(),vt=findVarTable(vn);if(vt){var va=vt.vars[vn];if(this.operator){var v1=(va=getValueByArgs(va,ag,this.loc)).getValue(),v2=vl,v3=null;switch(this.operator){case"+":if(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の足し算はまだサポートしていません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書の足し算はまだサポートしていません");v1 instanceof StringValue||v2 instanceof StringValue?v3=new StringValue(String(v1.value)+String(v2.value),this.loc):v1 instanceof IntValue&&v2 instanceof IntValue?v3=new IntValue(v1.value+v2.value,this.loc):(v1 instanceof FloatValue||v2 instanceof FloatValue)&&(v3=new FloatValue(v1.value+v2.value,this.loc));break;case"-":if(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の引き算はできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書の引き算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列の引き算はできません");v1 instanceof IntValue&&v2 instanceof IntValue?v3=new IntValue(v1.value-v2.value,this.loc):(v1 instanceof FloatValue||v2 instanceof FloatValue)&&(v3=new FloatValue(v1.value-v2.value,this.loc));break;case"*":if(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の掛け算は出来ません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書の掛け算はできません");if(v1 instanceof StringValue){if(!(v2 instanceof IntValue))throw new RuntimeError(this.first_line,"文字列に掛けられるのは整数だけです");v3=new StringValue(v1.value.repeat(v2.value>=0?v2.value:0),this.loc)}else v1 instanceof IntValue&&v2 instanceof IntValue?v3=new IntValue(v1.value*v2.value,this.loc):(v1 instanceof FloatValue||v2 instanceof FloatValue)&&(v3=new FloatValue(v1.value*v2.value,this.loc));break;case"/":if(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の割り算はできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書の割り算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列の割り算はできません");if(0==v2.value)throw new RuntimeError(this.first_line,"0で割り算をしました");v3=new FloatValue(v1.value/v2.value,this.loc);break;case"//":if(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の割り算はできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書の割り算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列の割り算はできません");if(0==v2.value)throw new RuntimeError(this.first_line,"0で割り算をしました");var v4=v1.value-Math.floor(v1.value/v2.value)*v2.value;v3=v1 instanceof IntValue&&v2 instanceof IntValue?new IntValue(v4,this.loc):new FloatValue(v4,this.loc);break;case"%":if(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の割り算はできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書の割り算はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列の割り算はできません");if(0==v2.value)throw new RuntimeError(this.first_line,"0で割り算をしました");var _v6=v1.value-Math.floor(v1.value/v2.value)*v2.value;v3=v1 instanceof IntValue&&v2 instanceof IntValue?new IntValue(_v6,this.loc):new FloatValue(_v6,this.loc);break;case"&":if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビット積はできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書のビット積はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビット積はできません");if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビット積はできません");v1 instanceof BooleanValue&&v2 instanceof BooleanValue?v3=new BooleanValue(v1.value&&v2.value,this.loc):(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v3=new IntValue(v1.value&v2.value,this.loc));break;case"|":if(v1 instanceof ArrayValue||v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビット和はできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書のビット和はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビット和はできません");if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビット和はできません");v1 instanceof BooleanValue&&v2 instanceof BooleanValue?v3=new BooleanValue(v1.value&&v2.value,this.loc):(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v3=new IntValue(v1.value|v2.value,this.loc));break;case"^":if(v1 instanceof ArrayValue&&v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列の排他的論理和はできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書の排他的論理和はできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列の排他的論理和はできません");if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数の排他的論理和はできません");v1 instanceof BooleanValue&&v2 instanceof BooleanValue?v3=new BooleanValue(v1.value&&v2.value,this.loc):(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v3=new IntValue(v1.value^v2.value,this.loc));break;case"<<":if(v1 instanceof ArrayValue&&v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビットシフトはできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書のビットシフトはできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビットシフトはできません");if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビットシフトはできません");v1 instanceof BooleanValue&&v2 instanceof BooleanValue?v3=new BooleanValue(v1.value&&v2.value,this.loc):(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v3=new IntValue(v1.value<<v2.value,this.loc));break;case">>":if(v1 instanceof ArrayValue&&v2 instanceof ArrayValue)throw new RuntimeError(this.first_line,"配列のビットシフトはできません");if(v1 instanceof DictionaryValue||v2 instanceof DictionaryValue)throw new RuntimeError(this.first_line,"辞書のビットシフトはできません");if(v1 instanceof StringValue||v2 instanceof StringValue)throw new RuntimeError(this.first_line,"文字列のビットシフトはできません");if(v1 instanceof FloatValue||v2 instanceof FloatValue)throw new RuntimeError(this.first_line,"実数のビットシフトはできません");v1 instanceof BooleanValue&&v2 instanceof BooleanValue?v3=new BooleanValue(v1.value&&v2.value,this.loc):(v1 instanceof BooleanValue&&(v1=new IntValue(v1.value?1:0,this.loc)),v2 instanceof BooleanValue&&(v2=new IntValue(v2.value?1:0,this.loc)),v3=new IntValue(v1.value>>v2.value,this.loc))}if(!v3)throw new RuntimeError(this.first_line,"複合代入演算子の使い方が間違っています");setVariableByArgs(vt,vn,ag,v3,this.loc)}else setVariableByArgs(vt,vn,ag,vl.clone(),this.loc)}else{if(this.operator)throw new RuntimeError(this.first_line,"宣言されていない変数に複合代入演算子が使われました");(vt=varTables[0]).vars[vn]=new NullValue(this.loc),setVariableByArgs(vt,vn,ag,vl.clone(),this.loc)}code[0].stack[0].index=index+1}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);return code+=this.variable.makePython()+" ",this.operator&&(code+=this.operator),code+="= "+this.value.makePython()+"\n"}}]),Assign}(Statement),Append=function(_Statement11){function Append(variable,value,loc){_classCallCheck(this,Append);var _this54=_possibleConstructorReturn(this,(Append.__proto__||Object.getPrototypeOf(Append)).call(this,loc));if(!(variable instanceof Variable||variable instanceof UNDEFINED))throw new RuntimeError(loc.first_line,"追加されるものは変数でなくてはいけません");return _this54.variable=variable,_this54.value=value,_this54}return _inherits(Append,_Statement11),_createClass(Append,[{key:"clone",value:function clone(){return new Append(this.variable,this.value,this.loc)}},{key:"run",value:function run(){if(this.variable instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");var index=code[0].stack[0].index,vn=this.variable.varname,ag=this.variable.args,vl=this.value.getValue(),vt=findVarTable(vn);if(!vt)throw new RuntimeError(this.first_line,"存在しない配列に追加はできません");var va=vt.vars[vn];if(ag&&ag.value.length>0)for(var _i18=0;_i18<ag.value.length;_i18++)if(ag.value[_i18].getValue()instanceof StringValue)va=va.value[ag.value[_i18].getValue().value];else{if(!(ag.value[_i18].getValue()instanceof IntValue))throw new RuntimeError(this.first_line,"添字に使えないデータ型です");if(!va.value[ag.value[_i18].getValue().value])throw new RuntimeError(this.first_line,"配列の範囲を超えたところに追加しようとしました");va=va.value[ag.value[_i18].getValue().value]}if(!(va instanceof ArrayValue))throw new RuntimeError(this.first_line,"配列でない変数に追加はできません");va.value.push(vl.clone()),code[0].stack[0].index=index+1}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);return code+=this.variable.makePython()+".append("+this.value.makePython()+")\n"}}]),Append}(Statement),Extend=function(_Statement12){function Extend(variable,value,loc){_classCallCheck(this,Extend);var _this55=_possibleConstructorReturn(this,(Extend.__proto__||Object.getPrototypeOf(Extend)).call(this,loc));if(!(variable instanceof Variable||variable instanceof UNDEFINED))throw new RuntimeError(loc.first_line,"連結されるものは変数でなくてはいけません");return _this55.variable=variable,_this55.value=value,_this55}return _inherits(Extend,_Statement12),_createClass(Extend,[{key:"clone",value:function clone(){return new Extend(this.variable,this.value,this.loc)}},{key:"run",value:function run(){if(this.variable instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");var index=code[0].stack[0].index,vn=this.variable.varname,ag=this.variable.args,vl=this.value.getValue(),vt=findVarTable(vn);if(!vt)throw new RuntimeError(this.first_line,"存在しない配列に連結はできません");var va=vt.vars[vn];if(ag&&ag.value.length>0)for(var _i19=0;_i19<ag.value.length;_i19++)if(ag.value[_i19]instanceof StringValue)va=va.value[ag.value[_i19].getValue().value];else{if(!(ag.value[_i19]instanceof IntValue))throw new RuntimeError(this.first_line,"添字に使えないデータ型です");if(!va.value[ag.value[_i19].getValue().value])throw new RuntimeError(this.first_line,"配列の範囲を超えたところに連結しようとしました");va=va.value[ag.value[_i19].getValue().value]}if(!(va instanceof ArrayValue))throw new RuntimeError(this.first_line,"配列でない変数に連結はできません");if(!(vl instanceof ArrayValue))throw new RuntimeError(this.first_line,"配列でない値を連結することはできません");for(var l=vl.value.length,i=0;i<l;i++)va.value.push(vl.value[i].clone());code[0].stack[0].index=index+1}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);return code+=this.variable.makePython()+".extend("+this.value.makePython()+")\n"}}]),Extend}(Statement),Input=function(_Statement13){function Input(x,type,loc){_classCallCheck(this,Input);var _this56=_possibleConstructorReturn(this,(Input.__proto__||Object.getPrototypeOf(Input)).call(this,loc));if(!(x instanceof Variable||x instanceof UNDEFINED))throw new RuntimeError(loc.first_line,"入力されるものは変数でなくてはいけません");return _this56.varname=x,_this56.type=type,_this56}return _inherits(Input,_Statement13),_createClass(Input,[{key:"clone",value:function clone(){new Input(this.varname,this.type,this.loc)}},{key:"run",value:function run(){if(selected_quiz<0){if(this.varname instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");var list=[new InputBegin(this.loc),new InputEnd(this.varname,this.type,this.loc)];code.unshift(new parsedCode(list))}else{if(!(selected_quiz_input<Quizzes[selected_quiz].inputs(selected_quiz_case).length))throw new RuntimeError(this.first_line,"必要以上の入力を求めています。");var index=code[0].stack[0].index;if(this.varname instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");var va=new Variable(this.varname.varname,this.varname.args,this.loc),vl=Quizzes[selected_quiz].inputs(selected_quiz_case)[selected_quiz_input++],assign=null,re=/^(0+|false|偽|)$/i;this.type==typeOfValue.typeInt?assign=new Assign(va,new IntValue(Number(toHalf(vl,this.loc)),this.loc),null,this.loc):this.type==typeOfValue.typeFloat?assign=new Assign(va,new FloatValue(Number(toHalf(vl,this.loc)),this.loc),null,this.loc):this.type==typeOfValue.typeString?assign=new Assign(va,new StringValue(vl+"",this.loc),null,this.loc):this.type==typeOfValue.typeBoolean&&(assign=new Assign(va,new BooleanValue(!re.exec(vl),this.loc),null,this.loc)),assign.run(),code[0].stack[0].index=index+1}}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);switch(code+=this.varname.makePython()+" = ",this.type){case typeOfValue.typeInt:code+="int(input())\n";break;case typeOfValue.typeFloat:code+="float(input())\n";break;case typeOfValue.typeString:code+="input()\n";break;case typeOfValue.typeBoolean:code+="bool(input())\n"}return code}}]),Input}(Statement),InputBegin=function(_Statement14){function InputBegin(loc){return _classCallCheck(this,InputBegin),_possibleConstructorReturn(this,(InputBegin.__proto__||Object.getPrototypeOf(InputBegin)).call(this,loc))}return _inherits(InputBegin,_Statement14),_createClass(InputBegin,[{key:"clone",value:function clone(){return new InputBegin(this.loc)}},{key:"run",value:function run(){openInputWindow(),_get(InputBegin.prototype.__proto__||Object.getPrototypeOf(InputBegin.prototype),"run",this).call(this)}}]),InputBegin}(Statement),InputEnd=function(_Statement15){function InputEnd(x,type,loc){_classCallCheck(this,InputEnd);var _this58=_possibleConstructorReturn(this,(InputEnd.__proto__||Object.getPrototypeOf(InputEnd)).call(this,loc));return _this58.varname=x,_this58.type=type,_this58}return _inherits(InputEnd,_Statement15),_createClass(InputEnd,[{key:"clone",value:function clone(){return new InputEnd(this.varname,this.type,this.loc)}},{key:"run",value:function run(){if(this.varname instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");try{var va=new Variable(this.varname.varname,this.varname.args,this.loc),vl=closeInputWindow(),assign=null,re=/^(0+|false|偽|)$/i;code.shift();var index=code[0].stack[0].index;this.type==typeOfValue.typeInt?assign=new Assign(va,new IntValue(Number(toHalf(vl,this.loc)),this.loc),null,this.loc):this.type==typeOfValue.typeFloat?assign=new Assign(va,new FloatValue(Number(toHalf(vl,this.loc)),this.loc),null,this.loc):this.type==typeOfValue.typeString?assign=new Assign(va,new StringValue(vl+"",this.loc),null,this.loc):this.type==typeOfValue.typeBoolean&&(assign=new Assign(va,new BooleanValue(!re.exec(vl),this.loc),null,this.loc)),assign.run(),code[0].stack[0].index=index+1}catch(e){throw closeInputWindow(),code.shift(),e}}}]),InputEnd}(Statement),Newline=function(_Statement16){function Newline(loc){return _classCallCheck(this,Newline),_possibleConstructorReturn(this,(Newline.__proto__||Object.getPrototypeOf(Newline)).call(this,loc))}return _inherits(Newline,_Statement16),_createClass(Newline,[{key:"clone",value:function clone(){return new Newline(this.loc)}},{key:"run",value:function run(){selected_quiz<0?textareaAppend("\n"):output_str+="\n",_get(Newline.prototype.__proto__||Object.getPrototypeOf(Newline.prototype),"run",this).call(this)}},{key:"makePython",value:function makePython(indent){return Parts.makeIndent(indent)+"print()\n"}}]),Newline}(Statement),Output=function(_Statement17){function Output(x,ln,loc){_classCallCheck(this,Output);var _this60=_possibleConstructorReturn(this,(Output.__proto__||Object.getPrototypeOf(Output)).call(this,loc));return _this60.value=x,_this60.ln=ln,_this60}return _inherits(Output,_Statement17),_createClass(Output,[{key:"clone",value:function clone(){for(var val=[],i=0;i<this.value.length;i++)val.push(this.value[i]);return new Output(val,this.ln,this.loc)}},{key:"run",value:function run(){var index=code[0].stack[0].index;if(selected_quiz<0){for(var i=0;i<this.value.length;i++){var v;textareaAppend((i>0?" ":"")+array2text(this.value[i].getValue()))}this.ln&&textareaAppend("\n")}else{for(var i=0;i<this.value.length;i++){var _v7=this.value[i].getValue();output_str+=(i>0?" ":"")+array2text(_v7)}this.ln&&(output_str+="\n")}code[0].stack[0].index=index+1}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);code+="print(";for(var i=0;i<this.value.length;i++)code+=(i>0?",":"")+this.value[i].makePython();return this.ln||(code+=",end=''"),code+")\n"}}]),Output}(Statement);function array2text(v){if(!v)return"";if(v instanceof Value){var v0=v.getValue();if(v0 instanceof ArrayValue){for(var v1=[],_i20=0;_i20<v0.value.length;_i20++)v1.push(array2text(v0.value[_i20]));return"["+v1.join(",")+"]"}if(v0 instanceof DictionaryValue){var _v8=[],keys=Object.keys(v0.value);keys.sort();for(var _i21=0;_i21<keys.length;_i21++)_v8.push(keys[_i21]+":"+array2text(v0.value[keys[_i21]]));return"{"+_v8.join(",")+"}"}return v0 instanceof BooleanValue?v0.value?"True":"False":v0 instanceof FloatValue&&isInteger(v0.value)&&!v0.value.toString().match(/[Ee]/)?v0.value+".0":new String(v0.value)}return new String(v)}function array2code(v){if(!v)return"";var v0=v.getValue();if(v0 instanceof ArrayValue){for(var v1=[],_i22=0;_i22<v0.value.length;_i22++)v1.push(array2text(v0.value[_i22]));return"["+v1.join(",")+"]"}if(v0 instanceof DictionaryValue){var _v9=[],keys=Object.keys(v0.value);keys.sort();for(var _i23=0;_i23<keys.length;_i23++)_v9.push(keys[_i23]+":"+array2text(v0.value[keys[_i23]]));return"{"+_v9.join(",")+"}"}return v0 instanceof StringValue?'"'+v0.value+'"':v0 instanceof FloatValue&&isInteger(v0.value)&&!v0.value.toString().match(/[Ee]/)?v0.value+".0":v0.value}var GraphicStatement=function(_Statement18){function GraphicStatement(command,args,loc){_classCallCheck(this,GraphicStatement);var _this61=_possibleConstructorReturn(this,(GraphicStatement.__proto__||Object.getPrototypeOf(GraphicStatement)).call(this,loc));return _this61.command=command,_this61.args=args,_this61}return _inherits(GraphicStatement,_Statement18),_createClass(GraphicStatement,[{key:"clone",value:function clone(){for(var args=[],i=0;i<this.args.length;i++)args.push(this.args[i]);return new GraphicStatement(this.command,args,this.loc)}},{key:"run",value:function run(){if(_get(GraphicStatement.prototype.__proto__||Object.getPrototypeOf(GraphicStatement.prototype),"run",this).call(this),"gOpenWindow"==this.command){var canvas=document.getElementById("canvas");context=canvas.getContext("2d"),canvas.setAttribute("width",this.args[0].getValue().value+"px"),canvas.setAttribute("height",this.args[1].getValue().value+"px"),canvas.style.display="block"}else if("gCloseWindow"==this.command){var canvas;(canvas=document.getElementById("canvas")).style.display="none",context=null}else if("gClearWindow"==this.command){var canvas=document.getElementById("canvas");context.clearRect(0,0,canvas.width,canvas.height)}else if("gSetLineColor"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var r=this.args[0].getValue().value,g=this.args[1].getValue().value,b=this.args[2].getValue().value;context.strokeStyle="rgb("+r+","+g+","+b+")"}else if("gSetFillColor"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _r=this.args[0].getValue().value,_g=this.args[1].getValue().value,_b=this.args[2].getValue().value;context.fillStyle="rgb("+_r+","+_g+","+_b+")"}else if("gSetTextColor"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _r2=this.args[0].getValue().value,_g2=this.args[1].getValue().value,_b2=this.args[2].getValue().value;context.textStyle="rgb("+_r2+","+_g2+","+_b2+")"}else if("gSetLineWidth"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");context.lineWidth=this.args[0].getValue().value}else if("gSetFontSize"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");context.font=this.args[0].getValue().value+"px 'sans-serif'"}else if("gDrawText"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var temp=context.fillStyle;context.fillStyle=context.textStyle,context.fillText(this.args[0].getValue().value,this.args[1].getValue().value,this.args[2].getValue().value),context.fillStyle=temp}else if("gDrawLine"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var x1=this.args[0].getValue().value,y1=this.args[1].getValue().value,x2=this.args[2].getValue().value,y2=this.args[3].getValue().value;context.beginPath(),context.moveTo(x1,y1),context.lineTo(x2,y2),context.stroke()}else if("gDrawPoint"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _x=this.args[0].getValue().value,_y=this.args[1].getValue().value;context.beginPath(),context.arc(_x,_y,1,0,2*Math.PI,!1),context.stroke()}else if("gDrawBox"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _x2=this.args[0].getValue().value,_y2=this.args[1].getValue().value,width=this.args[2].getValue().value,height=this.args[3].getValue().value;context.beginPath(),context.strokeRect(_x2,_y2,width,height),context.stroke()}else if("gFillBox"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _x3=this.args[0].getValue().value,_y3=this.args[1].getValue().value,_width=this.args[2].getValue().value,_height=this.args[3].getValue().value;context.fillRect(_x3,_y3,_width,_height),context.beginPath(),context.strokeRect(_x3,_y3,_width,_height),context.stroke()}else if("gDrawCircle"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _x4=this.args[0].getValue().value,_y4=this.args[1].getValue().value,_r3=this.args[2].getValue().value;context.beginPath(),context.arc(_x4,_y4,_r3,0,2*Math.PI,!1),context.stroke()}else if("gFillCircle"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");for(var _x5=this.args[0].getValue().value,_y5=this.args[1].getValue().value,_r4=this.args[2].getValue().value,i=0;i<2;i++)context.beginPath(),context.arc(_x5,_y5,_r4,0,2*Math.PI,!1),0==i?context.fill():context.stroke()}else if("gDrawOval"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _x6=this.args[0].getValue().value,_y6=this.args[1].getValue().value,_w=this.args[2].getValue().value,_h=this.args[3].getValue().value;context.beginPath(),context.ellipse(_x6+_w/2,_y6+_h/2,_w/2,_h/2,0,0,2*Math.PI),context.stroke()}else if("gFillOval"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");for(var _x7=this.args[0].getValue().value,_y7=this.args[1].getValue().value,_w2=this.args[2].getValue().value,_h2=this.args[3].getValue().value,i=0;i<2;i++)context.beginPath(),context.ellipse(_x7+_w2/2,_y7+_h2/2,_w2/2,_h2/2,0,0,2*Math.PI),0==i?context.fill():context.stroke()}else if("gDrawArc"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");var _x8=this.args[0].getValue().value,_y8=this.args[1].getValue().value,_w3=this.args[2].getValue().value,_h3=this.args[3].getValue().value,theta1=this.args[4].getValue().value,theta2=this.args[5].getValue().value,style=this.args[6].getValue().value;switch(context.beginPath(),context.ellipse(_x8+_w3/2,_y8+_h3/2,_w3/2,_h3/2,0,-theta1*Math.PI/180,-theta2*Math.PI/180,!0),style){case 2:context.lineTo(_x8+_w3/2,_y8+_h3/2);case 1:context.closePath()}context.stroke()}else if("gFillArc"==this.command){if(null==context)throw new RuntimeError(this.first_line,"描画領域がありません");for(var _x9=this.args[0].getValue().value,_y9=this.args[1].getValue().value,_w4=this.args[2].getValue().value,_h4=this.args[3].getValue().value,_theta=this.args[4].getValue().value,_theta2=this.args[5].getValue().value,_style=this.args[6].getValue().value,i=0;i<2;i++){switch(context.beginPath(),context.ellipse(_x9+_w4/2,_y9+_h4/2,_w4/2,_h4/2,0,-_theta*Math.PI/180,-_theta2*Math.PI/180,!0),_style){case 2:context.lineTo(_x9+_w4/2,_y9+_h4/2);case 1:context.closePath()}0==i?context.fill():context.stroke()}}else if("gBarplot"==this.command){if(null==context){var canvas=document.getElementById("canvas"),w=this.args[0].getValue().value,h=this.args[1].getValue().value;context=canvas.getContext("2d"),canvas.setAttribute("width",w+"px"),canvas.setAttribute("height",h+"px"),canvas.style.display="block"}for(var values=array2values(this.args[2],this.loc),max=0,min=0,maxn=0,i=0;i<values.length;i++){var l;(l=values[i].length)>maxn&&(maxn=l);for(var j=0;j<l;j++){var v1;(v1=values[i][j])>max&&(max=v1),v1<min&&(min=v1)}}0==max&&(max=1);var x0=.05*w,y0=.95*h;if(y0*=max/(max-min),w*=.9,h*=.9,context.beginPath(),context.moveTo(x0,y0-h*max/(max-min)),context.lineTo(x0,y0-h*min/(max-min)),context.moveTo(x0,y0),context.lineTo(x0+w,y0),context.stroke(),values.length>0)for(var w0=w/maxn/values.length,i=0;i<values.length;i++){context.fillStyle=graphColor[i%6],context.beginPath();for(var j=0;j<values[i].length;j++){var x=x0+w0*j+w0/2,y=y0-values[i][j]/(max-min)*h;values[i][j]>=0?context.fillRect(x0+w0*j*values.length+.8*w0*i+.1*w0,y0-h*(values[i][j]/(max-min)),.8*w0,h*(values[i][j]/(max-min))):context.fillRect(x0+w0*j*values.length+.8*w0*i+.1*w0,y0,.8*w0,h*(-values[i][j]/(max-min)))}context.stroke()}}else if("gLineplot"==this.command){if(null==context){var canvas=document.getElementById("canvas"),w=this.args[0].getValue().value,h=this.args[1].getValue().value;context=canvas.getContext("2d"),canvas.setAttribute("width",w+"px"),canvas.setAttribute("height",h+"px"),canvas.style.display="block"}for(var values=array2values(this.args[2],this.loc),max=0,min=0,maxn=0,i=0;i<values.length;i++){var l;(l=values[i].length)>maxn&&(maxn=l);for(var j=0;j<l;j++){var v1;(v1=values[i][j])>max&&(max=v1),v1<min&&(min=v1)}}0==max&&(max=1);var x0=.05*w,y0=.95*h;if(y0*=max/(max-min),w*=.9,h*=.9,context.beginPath(),context.moveTo(x0,y0-h*max/(max-min)),context.lineTo(x0,y0-h*min/(max-min)),context.moveTo(x0,y0),context.lineTo(x0+w,y0),context.stroke(),values.length>0)for(var w0=w/maxn,i=0;i<values.length;i++){context.strokeStyle=graphColor[i%6],context.beginPath();for(var j=0;j<values[i].length;j++){var x=x0+w0*j+w0/2,y=y0-values[i][j]/(max-min)*h;0==j?context.moveTo(x,y):context.lineTo(x,y)}context.stroke()}}else if("gDrawGraph"==this.command)drawGraph(this.args[0].getValue(),this.args[1].getValue(),this.loc);else{if("gClearGraph"!=this.command)throw new RuntimeError(this.first_line,"未実装のコマンド"+this.command+"が使われました");clearGraph()}}},{key:"makePython",value:function makePython(indent){throw new RuntimeError(this.first_line,"グラフィック命令はPythonに変換できません")}}]),GraphicStatement}(Statement);function clearGraph(){Plotly.purge(document.getElementById("graph"))}function drawGraph(layout,data,loc){var div=document.getElementById("graph"),graph_data=[],graph_layout={};if(layout instanceof DictionaryValue)for(var key in layout.value){var val;if((val=layout.value[key].getValue())instanceof ArrayValue)for(var key1 in graph_layout[key]={},val.value)graph_layout[key][key1]=val2obj(val.value[key1].getValue());else graph_layout[key]=val2obj(val)}else if(layout)throw new RuntimeError(loc.first_line,"レイアウト情報が辞書になっていません");if(!(data instanceof ArrayValue))throw new RuntimeError(loc.first_line,"データが配列になっていません");for(var dl=data.value.length,i=0;i<dl;i++){var d=data.value[i].getValue();if(!(d instanceof DictionaryValue))throw new RuntimeError(loc.first_line,"データの"+i+"番目の要素が辞書になっていません");var va={};for(var key in d.value){var val=d.value[key].getValue();va[key]=val2obj(val)}graph_data.push(va)}Plotly.newPlot(div,graph_data,graph_layout)}function val2obj(val){if(val instanceof ArrayValue){for(var rtnv=[],l=val.value.length,i=0;i<l;i++)rtnv.push(val2obj(val.value[i]));return rtnv}if(val instanceof DictionaryValue){var rtnv={};for(var key in val.value)rtnv[key]=val2obj(val.value[key].getValue());return rtnv}return val.value}function array2values(a,loc){var rtnv=[],array=null;if(a.rtnv instanceof ArrayValue)if(a.rtnv.value[0]instanceof ArrayValue)array=a.rtnv;else{if(!(a.rtnv.value instanceof Array))throw new RuntimeError(loc.first_line,"グラフに誤った型が使われています");array=new ArrayValue([a.rtnv.value],loc)}else{if(!(a.rtnv instanceof Array))throw new RuntimeError(loc.first_line,"棒グラフ・線グラフには配列が必要です");array=new ArrayValue(a.rtnv,loc)}for(var i=0;i<array.length;i++){for(var rtnv1=[],j=0;j<array.value[i].length;j++)rtnv1.push(array.value[i]instanceof ArrayValue?array.value[i].value[j].value:array.value[i][j].value);rtnv.push(rtnv1)}return rtnv}var If=function(_Statement19){function If(condition,state1,state2,loc){_classCallCheck(this,If);var _this62=_possibleConstructorReturn(this,(If.__proto__||Object.getPrototypeOf(If)).call(this,loc));return _this62.condition=condition,_this62.state1=state1,_this62.state2=state2,_this62}return _inherits(If,_Statement19),_createClass(If,[{key:"clone",value:function clone(){var state1=[],state2=[];if(this.state1)for(var i=0;i<this.state1.length;i++)state1.push(this.state1[i].clone());if(this.state2)for(var i=0;i<this.state2.length;i++)state2.push(this.state2[i].clone());return new If(this.condition,state1,state2,this.loc)}},{key:"run",value:function run(){if(_get(If.prototype.__proto__||Object.getPrototypeOf(If.prototype),"run",this).call(this),!(this.condition.getValue()instanceof BooleanValue))throw new RuntimeError(this.first_line,"もし〜の構文で条件式が使われていません");this.condition.getValue().value?code[0].stack.unshift({statementlist:this.state1,index:0}):null!=this.state2&&code[0].stack.unshift({statementlist:this.state2,index:0})}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);code+="if "+this.condition.makePython()+":\n";var codes=0;if(this.state1)for(var i=0;i<this.state1.length;i++)this.state1[i]&&(code+=this.state1[i].makePython(indent+1),codes=1);if(0==codes&&(code+=Parts.makeIndent(indent+1)+"None\n"),this.state2){codes=0;for(var code2="",i=0;i<this.state2.length;i++)this.state2[i]&&(code2+=this.state2[i].makePython(indent+1),codes=1);codes>0&&(code+=Parts.makeIndent(indent)+"else:\n"+code2)}return code}}]),If}(Statement),LoopBegin=function(_Statement20){function LoopBegin(condition,continuous,loc){_classCallCheck(this,LoopBegin);var _this63=_possibleConstructorReturn(this,(LoopBegin.__proto__||Object.getPrototypeOf(LoopBegin)).call(this,loc));return _this63.condition=condition,_this63.continuous=continuous,_this63}return _inherits(LoopBegin,_Statement20),_createClass(LoopBegin,[{key:"clone",value:function clone(){return new LoopBegin(this.condifion.clone(),this.condition,this.loc)}},{key:"run",value:function run(){null==this.condition||this.condition.getValue().value==this.continuous?_get(LoopBegin.prototype.__proto__||Object.getPrototypeOf(LoopBegin.prototype),"run",this).call(this):code[0].stack[0].index=-1}}]),LoopBegin}(Statement),LoopEnd=function(_Statement21){function LoopEnd(condition,continuous,loc){_classCallCheck(this,LoopEnd);var _this64=_possibleConstructorReturn(this,(LoopEnd.__proto__||Object.getPrototypeOf(LoopEnd)).call(this,loc));return _this64.condition=condition,_this64.continuous=continuous,_this64}return _inherits(LoopEnd,_Statement21),_createClass(LoopEnd,[{key:"clone",value:function clone(){return new LoopEnd(this.condition.clone(),this.continuous,this.loc)}},{key:"run",value:function run(){null==this.condition||this.condition.getValue().value==this.continuous?code[0].stack[0].index=0:code[0].stack[0].index=-1}}]),LoopEnd}(Statement),ForInc=function(_Statement22){function ForInc(varname,begin,end,step,statementlist,loc){_classCallCheck(this,ForInc);var _this65=_possibleConstructorReturn(this,(ForInc.__proto__||Object.getPrototypeOf(ForInc)).call(this,loc));if(!(varname instanceof Variable||varname instanceof UNDEFINED))throw new RuntimeError(loc.first_line,"繰り返しのカウンタは変数でなくてはいけません");return _this65.varname=varname,_this65.begin=begin,_this65.end=end,_this65.step=step,_this65.statementlist=statementlist,_this65}return _inherits(ForInc,_Statement22),_createClass(ForInc,[{key:"clone",value:function clone(){for(var state=[],i=0;i<this.statementlist.length;i++)state.push(this.statementlist[i].clone());return new ForInc(this.varname.clone(),this.begin.clone(),this.end.clone(),this.step.clone(),state,this.loc)}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent),pv,pb,pe,ps;code+="for "+this.varname.makePython()+" in range("+this.begin.makePython()+","+this.end.makePython()+"+1,"+this.step.makePython()+"):\n";for(var codes=0,i=0;i<this.statementlist.length;i++)this.statementlist[i]&&(codes=1,code+=this.statementlist[i].makePython(indent+1));return 0==codes&&(code+=Parts.makeIndent(indent+1)+"None\n"),code}},{key:"run",value:function run(){var index=code[0].stack[0].index;if(this.varname instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");var last_token={first_line:this.last_line,last_line:this.last_line},last_loc=new Location(last_token,last_token),varTable=findVarTable(this.varname.varname),assign;if(varTable||(varTable=varTables[0],this.begin.getValue()instanceof IntValue?varTable.vars[this.varname.varname]=new IntValue(0,this.loc):this.begin.getValue()instanceof FloatValue?varTable.vars[this.varname.varname]=new FloatValue(0,this.loc):varTable=null),!varTable)throw new RuntimeError(this.first_line,this.varname.varname+"は数値型の変数ではありません");new Assign(this.varname,this.begin.getValue(),null,this.loc).run();var loop=[];loop.push(new runBeforeGetValue([this.varname.args],this.loc));var variable=new Variable(this.varname.varname,this.varname.args,this.loc);loop.push(new runBeforeGetValue([variable,this.end],this.loc));var condition=new LE(variable,this.end,this.loc);loop.push(new runBeforeGetValue([condition],this.loc)),loop.push(new LoopBegin(condition,!0,this.loc));for(var _i24=0;_i24<this.statementlist.length;_i24++)loop.push(this.statementlist[_i24]);loop.push(new runBeforeGetValue([this.step,this.varname.args],this.loc));var new_counter=new Add(variable,this.step,this.loc);loop.push(new runBeforeGetValue([variable,new_counter],this.loc)),loop.push(new Assign(this.varname,new_counter,null,this.loc)),loop.push(new LoopEnd(null,!0,last_loc)),code[0].stack.unshift({statementlist:loop,index:0}),code[0].stack[1].index=index+1}}]),ForInc}(Statement),ForDec=function(_Statement23){function ForDec(varname,begin,end,step,statementlist,loc){_classCallCheck(this,ForDec);var _this66=_possibleConstructorReturn(this,(ForDec.__proto__||Object.getPrototypeOf(ForDec)).call(this,loc));if(!(varname instanceof Variable||varname instanceof Variable))throw new RuntimeError(loc.first_line,"繰り返しのカウンタは変数でなくてはいけません");return _this66.varname=varname,_this66.begin=begin,_this66.end=end,_this66.step=step,_this66.statementlist=statementlist,_this66}return _inherits(ForDec,_Statement23),_createClass(ForDec,[{key:"clone",value:function clone(){for(var state=[],i=0;i<this.statementlist.length;i++)state.push(this.statementlist[i].clone());return new ForInc(this.varname.clone(),this.begin.clone(),this.end.clone(),this.step.clone(),state,this.loc)}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent),pv,pb,pe,ps;code+="for "+this.varname.makePython()+" in range("+this.begin.makePython()+","+this.end.makePython()+"-1,-"+this.step.makePython()+"):\n";for(var codes=0,i=0;i<this.statementlist.length;i++)this.statementlist[i]&&(codes=1,code+=this.statementlist[i].makePython(indent+1));return 0==codes&&(code+=Parts.makeIndent(indent+1)+"None\n"),code}},{key:"run",value:function run(){if(this.varname instanceof UNDEFINED)throw new RuntimeError(this.first_line,"未完成のプログラムです");var last_token={first_line:this.last_line,last_line:this.last_line},last_loc=new Location(last_token,last_token),varTable=findVarTable(this.varname.varname),assign;if(varTable||(varTable=varTables[0],this.begin.getValue()instanceof IntValue?varTable.vars[this.varname.varname]=new IntValue(0,this.loc):this.begin.getValue()instanceof FloatValue?varTable.vars[this.varname.varname]=new FloatValue(0,this.loc):varTable=null),!varTable)throw new RuntimeError(this.first_line,this.varname.varname+"は数値型の変数ではありません");new Assign(this.varname,this.begin.getValue(),null,this.loc).run();var loop=[];loop.push(new runBeforeGetValue([this.varname.args],this.loc));var variable=new Variable(this.varname.varname,this.varname.args,this.loc);loop.push(new runBeforeGetValue([variable,this.end],this.loc));var condition=new GE(variable,this.end,this.loc);loop.push(new runBeforeGetValue([condition],this.loc)),loop.push(new LoopBegin(condition,!0,this.loc));for(var _i25=0;_i25<this.statementlist.length;_i25++)loop.push(this.statementlist[_i25]);loop.push(new runBeforeGetValue([this.step,this.varname.args],last_loc));var new_counter=new Sub(variable,this.step,last_loc);loop.push(new runBeforeGetValue([variable,new_counter],last_loc)),loop.push(new Assign(this.varname,new_counter,null,last_loc)),loop.push(new LoopEnd(null,!0,last_loc)),code[0].stack.unshift({statementlist:loop,index:0}),_get(ForDec.prototype.__proto__||Object.getPrototypeOf(ForDec.prototype),"run",this).call(this)}}]),ForDec}(Statement),While=function(_Statement24){function While(condition,statementlist,loc){_classCallCheck(this,While);var _this67=_possibleConstructorReturn(this,(While.__proto__||Object.getPrototypeOf(While)).call(this,loc));return _this67.condition=condition,_this67.statementlist=statementlist,_this67}return _inherits(While,_Statement24),_createClass(While,[{key:"clone",value:function clone(){for(var state=[],i=0;i<this.statementlist.length;i++)state.push(this.statementlist[i].clone());return new While(this.condition.clone(),state,this.loc)}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);code+="while "+this.condition.makePython()+":\n";for(var codes=0,i=0;i<this.statementlist.length;i++)this.statementlist[i]&&(codes=1,code+=this.statementlist[i].makePython(indent+1));return 0==codes&&(code+=Parts.makeIndent(indent+1)+"None\n"),code}},{key:"run",value:function run(){_get(While.prototype.__proto__||Object.getPrototypeOf(While.prototype),"run",this).call(this);for(var last_token={first_line:this.last_line,last_line:this.last_line},loop=[new runBeforeGetValue([this.condition],this.loc),new LoopBegin(this.condition,!0,this.loc)],i=0;i<this.statementlist.length;i++)loop.push(this.statementlist[i]);loop.push(new LoopEnd(null,!1,new Location(last_token,last_token))),code[0].stack.unshift({statementlist:loop,index:0})}}]),While}(Statement),SleepStatement=function(_Statement25){function SleepStatement(sec,loc){_classCallCheck(this,SleepStatement);var _this68=_possibleConstructorReturn(this,(SleepStatement.__proto__||Object.getPrototypeOf(SleepStatement)).call(this,loc));return _this68.sec=new IntValue(sec.value,loc),_this68}return _inherits(SleepStatement,_Statement25),_createClass(SleepStatement,[{key:"clone",value:function clone(){return new SleepStatement(this.sec,this.loc)}},{key:"run",value:function run(){wait_time=this.sec.value,_get(SleepStatement.prototype.__proto__||Object.getPrototypeOf(SleepStatement.prototype),"run",this).call(this)}},{key:"makePython",value:function makePython(indent){var code=Parts.makeIndent(indent);return python_lib.time=1,code+"time.sleep("+this.sec.makePython()+"/1000)\n"}}]),SleepStatement}(Statement),NopStatement=function(_Statement26){function NopStatement(loc){return _classCallCheck(this,NopStatement),_possibleConstructorReturn(this,(NopStatement.__proto__||Object.getPrototypeOf(NopStatement)).call(this,loc))}return _inherits(NopStatement,_Statement26),_createClass(NopStatement,[{key:"clone",value:function clone(){return new NopStatement(this.loc)}},{key:"run",value:function run(){_get(NopStatement.prototype.__proto__||Object.getPrototypeOf(NopStatement.prototype),"run",this).call(this)}},{key:"makePython",value:function makePython(indent){return Parts.makeIndent(indent)+"None\n"}}]),NopStatement}(Statement),BreakStatement=function(_Statement27){function BreakStatement(loc){return _classCallCheck(this,BreakStatement),_possibleConstructorReturn(this,(BreakStatement.__proto__||Object.getPrototypeOf(BreakStatement)).call(this,loc))}return _inherits(BreakStatement,_Statement27),_createClass(BreakStatement,[{key:"clone",value:function clone(){return new BreakStatement(this.loc)}},{key:"run",value:function run(){for(;;){var block=code[0].stack.shift();if(!block)throw new RuntimeError(this.first_line,"繰り返しの中ではありません。");for(var i=0;i<block.statementlist.length;i++)if(block.statementlist[i]instanceof LoopBegin)return}}},{key:"makePython",value:function makePython(indent){return Parts.makeIndent(indent)+"break\n"}}]),BreakStatement}(Statement);function highlightLine(l){var scroll_elem,code_elems=editor.getScrollerElement().getElementsByClassName("CodeMirror-code");if(code_elems)for(var code_elem,ln=1,line_elem=code_elems[0].firstElementChild;line_elem;line_elem=line_elem.nextElementSibling){var number_elems=line_elem.getElementsByClassName("CodeMirror-linenumber");if(number_elems){var number_elem=number_elems[0];ln++==l?(number_elem.style.background="red",number_elem.style.color="white"):(number_elem.style.background="transparent",number_elem.style.color="#999")}}}function reset(){var canvas;varTables=[new varTable],myFuncs={},current_line=-1,selected_quiz<0&&textareaClear(),setRunflag(!1),code=null,highlightLine(-1),returnValues=[],document.getElementById("canvas").style.display="none";var input_area=document.getElementById("input_area");input_area.readOnly=!0,input_area.value="",document.getElementById("input_status").style.visibility="hidden",context=null,wait_time=0,timeouts=[],selected_quiz_input=selected_quiz_output=0,output_str="",Plotly.purge(document.getElementById("graph"))}function setRunflag(b){run_flag=b,document.getElementById("sourceTextarea").readOnly=b,editor.options.readOnly=b,b?editor.getWrapperElement().classList.add("readonly"):editor.getWrapperElement().classList.remove("readonly"),document.getElementById("runButton").innerHTML=b&!step_flag?"中断":"実行",document.getElementById("dumpButton").disabled=!step_flag,setEditableflag(!b)}function setEditableflag(b){editable_flag=b,document.getElementById("drawButton").disabled=!b,document.getElementById("pythonButton").disabled=!b,document.getElementById("urlButton").disabled=!b}function run(){if(null==code)try{reset();var python_source=editor.getValue(),dncl_source=python_to_dncl(python_source);code=[new parsedMainRoutine(dncl.parse(dncl_source))]}catch(e){if(selected_quiz<0)return e.line&&textareaAppend(e.line+"行目"),textareaAppend("構文エラーです\n"+e.message+"\n"),setRunflag(!1),void(code=null);throw e}setRunflag(!0),step()}function wait(ms){for(var t1=Date.now();Date.now()-t1<ms;);}function step(){if(selected_quiz<0){var l=current_line;do{next_line()}while(run_flag&&l==current_line);if(!code)return;code[0]&&code[0].stack.length>0?run_flag&&!step_flag&&(wait_time>0&&(wait(wait_time),wait_time=0),setZeroTimeout(step,0)):finish()}else do{if(next_line(),Date.now()>test_limit_time)throw new RuntimeError(-1,"時間がかかりすぎです。")}while(run_flag&&code[0]&&code[0].stack.length>0)}function next_line(){var index=code[0].stack[0].index,statement=code[0].stack[0].statementlist[index];if(statement)try{statement.run()}catch(e){if(!(selected_quiz<0))throw e;textareaAppend(e instanceof RuntimeError?"実行時エラーです\n"+e.line+"行目:"+e.message+"\n":"実行時エラーです\n"+e+"\n"),setRunflag(!1),code=null}else code[0].stack[0].index++;if(code&&code[0]){for(index=code[0].stack[0]?code[0].stack[0].index:-1;(index<0||index>=code[0].stack[0].statementlist.length)&&(code[0].stack.shift(),code[0].stack.length<1&&code.shift(),!(code.length<1));)index=code[0]&&code[0].stack[0]?code[0].stack[0].index:-1;selected_quiz<0&&(code[0]&&code[0].stack[0]?(index=code[0].stack[0].index,(statement=code[0].stack[0].statementlist[index])&&statement instanceof Statement&&statement.loc&&highlightLine(current_line=statement.first_line)):highlightLine(++current_line))}}function openInputWindow(){setRunflag(!1),setEditableflag(!1);var input_area=document.getElementById("input_area");input_area.value="",input_area.readOnly=!1,input_area.focus(),document.getElementById("input_status").style.visibility="visible",document.getElementById("sourceTextarea").readOnly=!0,editor.options.readOnly=!0,editor.getWrapperElement().classList.add("readonly")}function closeInputWindow(){var val=document.getElementById("input_area").value;return document.getElementById("input_area").readOnly=!0,document.getElementById("input_status").style.visibility="hidden",val}function keydownInput(e){var evt=e||window.event;13==evt.keyCode?(setRunflag(!0),step()):27==evt.keyCode&&(closeInputWindow(),code.shift())}function editButton(add_code){if(document.getElementById("sourceTextarea").readOnly)window.alert("プログラム実行・中断中はプログラムを編集できません");else{var pos=editor.getCursor(),code=editor.getValue(),lines=code.split(/\r|\n|\r\n/),code1=lines[pos.line].slice(0,pos.ch),code2=lines[pos.line].slice(pos.ch,code.length),re1=/^[｜| 　]*$/,add_codes=add_code.split("\n"),tab="",array=re1.exec(code1);if(array&&(tab=array[0]),code2)return alert("カーソルの右側に文字や空白があるときに\n入力支援ボタンを押してはいけません"),void editor.focus();for(var c in add_codes)add_codes[c]=tab+add_codes[c];(code=lines.slice(0,pos.line).join("\n"))&&(code+="\n"),code+=add_codes.join("\n")+"\n",code+=lines.slice(pos.line+1,lines.length).join("\n"),editor.setValue(code),editor.setCursor({line:pos.line,ch:pos.ch}),editor.focus()}}function keyDown(e){var evt=e||window.event,sourceTextArea=document.getElementById("sourceTextarea"),pos1=sourceTextArea.selectionStart,pos2=sourceTextArea.selectionEnd,code=sourceTextArea.value,code1=code.slice(0,pos1),code2=code.slice(pos1,pos2),code3=code.slice(pos2,code.length),re1=/^(    |　　|  　| 　 |　  )/,re2=/(    |　　|  　| 　 |　  )$/,tab="    ";switch(evt.keyCode){case 9:if(evt.shiftKey)re2.exec(code1)?code1=code1.replace(re2,""):pos1==pos2?re1.exec(code3)&&(code3=code3.replace(re1,"")):code2=code2.replace(/([\n])(    |　　|  　| 　 |　  )/g,"$1").replace(/^(    |　　|  　| 　 |　  )/,""),sourceTextArea.value=code1+code2+code3,sourceTextArea.setSelectionRange(code1.length,code1.length+code2.length);else{pos1<pos2&&(code2=code2.replace(/\n([^$])/g,"\n    $1")),sourceTextArea.value=code1+tab+code2+code3;var pos3=code1.length+tab.length,pos4=pos3;pos1<pos2&&(pos4=pos3+code2.length,pos3-=tab.length),sourceTextArea.setSelectionRange(pos3,pos4)}return evt.preventDefault(),!1;case 8:return code1=re2.exec(code1)?code1.replace(re2,""):code1.slice(0,-1),sourceTextArea.value=code1+code3,sourceTextArea.setSelectionRange(code1.length,code1.length),evt.preventDefault(),!1}return!0}function keyUp(e){var evt;switch((e||window.event).keyCode){case 37:case 38:case 39:case 40:var pos=editor.getCursor(),lines=editor.getValue().split(/\r|\n|\r\n/),line1=lines[pos.line].slice(0,pos.ch),line2=lines[pos.line].slice(pos.ch),re1,re2=/^[^》《]*》/,match1=/《[^》《]*$/.exec(line1),match2=re2.exec(line2);if(match1&&match2){var start=pos.ch-match1[0].length,end=pos.ch+match2[0].length;editor.setSelection({line:pos.line,ch:end},{line:pos.line,ch:start})}}}function mouseClick(evt){var pos=editor.coordsChar({left:evt.x,top:evt.y}),lines=editor.getValue().split(/\r|\n|\r\n/),line1=lines[pos.line].slice(0,pos.ch),line2=lines[pos.line].slice(pos.ch-1),re1,re2=/^[^》《]*》/,match1=/《[^》《]*$/.exec(line1),match2=re2.exec(line2);if(match1&&match2){var start=pos.ch-match1[0].length,end=pos.ch+match2[0].length-1;editor.setSelection({line:pos.line,ch:end},{line:pos.line,ch:start})}}function sampleButton(num){dirty&&!window.confirm("プログラムをサンプルプログラムに変更していいですか？")||(editor.setValue(sample[num]),reset(),flowchart&&codeChange(),editor.focus(),makeDirty(!1))}function insertCode(add_code){document.getElementById("sourceTextarea").readOnly?window.alert("プログラム実行・中断中はプログラムを編集できません"):editor.replaceSelection(add_code)}function registerEvent(elem,ev,func){elem.addEventListener?elem.addEventListener(ev,func):elem.attachEvent&&elem.attachEvent("on"+ev,func)}var dragging=!1,mouseX,mouseY,point=function(){function point(){_classCallCheck(this,point),this._x=this._y=0}return _createClass(point,[{key:"clone",value:function clone(){var p=new point;return p.x=this.x,p.y=this.y,p}},{key:"x",get:function get(){return this._x},set:function set(v){this._x=v}},{key:"y",get:function get(){return this._y},set:function set(v){this._y=v}}]),point}();function mouseDown(e){var rect=document.getElementById("flowchart").getBoundingClientRect(),x=e.clientX-rect.left,y=e.clientY-rect.top,parts;null!=flowchart.findParts(x,y)&&(dragging=!0,mouseX=x,mouseY=y)}function mouseUp(e){dragging=!1}function mouseMove(e){if(dragging){var rect=document.getElementById("flowchart").getBoundingClientRect(),x=e.clientX-rect.left,y=e.clientY-rect.top;flowchart.moveOrigin(x-mouseX,y-mouseY),mouseX=x,mouseY=y,flowchart.paint()}}function doubleclick_Flowchart(evt){if(editable_flag){dragging=!1;var rect=evt.target.getBoundingClientRect(),x=evt.clientX-rect.left,y=evt.clientY-rect.top,parts=flowchart.findParts(x,y);null==parts||parts instanceof Parts_Terminal||parts instanceof Parts_Bar||parts instanceof Parts_Null||parts.editMe()}else alert("プログラム実行・中断中はプログラムを編集できません")}function variableChange(e){flowchart.flowchart2code(),makeDirty(!0)}function contextMenu_Flowchart(trigger,event){dragging=!1;var x=event.offsetX,y=event.offsetY,parts=flowchart.findParts(x,y);return!(null==parts||parts instanceof Parts_Terminal||parts instanceof Parts_Null)&&(parts instanceof Parts_Bar?{selectableSubMenu:!0,events:{show:function show(){parts.highlight()},hide:function hide(){flowchart.paint(),flowchart.flowchart2code()}},callback:function callback(k,e){callbackPartsBar(parts,k)},items:{input:{name:"入力",icon:"input"},output:{name:"出力",icon:"output"},substitute:{name:"代入",icon:"assign"},if:{name:"分岐",icon:"if"},loop:{name:"ループ",icon:"loop",items:{loop1:{name:"〜の間"},loopinc:{name:"増やしながら"},loopdec:{name:"減らしながら"}}},array:{name:"配列操作",items:{append:{name:"追加"},extend:{name:"連結"}}},misc:{name:"各種命令"}}}:{callback:function callback(k,e){callbackParts(parts,k)},events:{show:function show(){parts.highlight()},hide:function hide(){flowchart.paint(),flowchart.flowchart2code()}},items:{edit:{name:"編集"},delete:{name:"削除"}}})}function callbackPartsBar(bar,key){if(document.getElementById("sourceTextarea").readOnly)window.alert("プログラム実行・中断中はプログラムを編集できません");else{if(bar.highlight(),"input"==key)Parts_Input.appendMe(bar);else if("output"==key)Parts_Output.appendMe(bar);else if("substitute"==key)Parts_Substitute.appendMe(bar);else if("append"==key)Parts_Append.appendMe(bar);else if("extend"==key)Parts_Extend.appendMe(bar);else if("if"==key)Parts_If.appendMe(bar);else if("loop1"==key)Parts_LoopBegin1.appendMe(bar);else if("loopinc"==key)Parts_LoopBeginInc.appendMe(bar);else if("loopdec"==key)Parts_LoopBeginDec.appendMe(bar);else{if("misc"!=key)return;Parts_Misc.appendMe(bar)}makeDirty(!0)}}function callbackParts(parts,key){if(!document.getElementById("sourceTextarea").readOnly)return!(parts instanceof Parts_Terminal)&&void("edit"==key?parts.editMe():"delete"==key?(parts.deleteMe(),makeDirty(!0)):"cut"==key&&(parts.cutMe(),makeDirty(!0)));window.alert("プログラム実行・中断中はプログラムを編集できません")}var FlowchartSetting={size:6,fontsize:12};function changeSize(v){v>0?FlowchartSetting.size++:v<0?FlowchartSetting.size>3&&FlowchartSetting.size--:FlowchartSetting.size=6,flowchart.paint()}function variable2code(ty,id){var code=document.getElementById(id).value.trim();return""!=code?ty+" "+code+"\n":""}var Flowchart=function(){function Flowchart(){_classCallCheck(this,Flowchart),this._canvas=document.getElementById("flowchart"),this._context=this._canvas.getContext("2d"),this.makeEmpty()}return _createClass(Flowchart,[{key:"setOrigin",value:function setOrigin(x,y){this._x0=x,this._y0=y}},{key:"moveOrigin",value:function moveOrigin(x,y){this._x0+=x,this._y0+=y}},{key:"makeEmpty",value:function makeEmpty(){this.setOrigin(this.canvas.width/2,FlowchartSetting.size),this.top=new Parts_Terminal;var bar=new Parts_Bar,end=new Parts_Terminal;this.top.next=bar,bar.next=end,this.top.setValue("はじめ"),end.setValue("おわり")}},{key:"code2flowchart",value:function code2flowchart(parse){flowchart.makeEmpty(),Flowchart.appendParts(this.top.next,parse),flowchart.paint()}},{key:"flowchart2code",value:function flowchart2code(){if(flowchart_display){var newcode=this.top.appendCode("",0);editor.setValue(newcode),editor.focus()}}},{key:"paint",value:function paint(){if(flowchart_display){var canvas_width=this.canvas.width,canvas_height=this.canvas.height,p0=new point,p1=new point,p2=new point;this.context.clearRect(0,0,canvas_width,canvas_height),FlowchartSetting.fontsize=2*FlowchartSetting.size,this.context.font=FlowchartSetting.fontsize+"px 'sans-serif'",this.context.strokeStyle="rgb(0,0,0)",this.context.fillStyle="rgb(0,0,0)",this.context.lineWidth="1px",this.top.calcSize(p0,p1,p2),this.top.paint({x:this.x0,y:this.y0})}}},{key:"findParts",value:function findParts(x,y){return this.top.findParts(x,y)}},{key:"x0",get:function get(){return this._x0}},{key:"y0",get:function get(){return this._y0}},{key:"canvas",get:function get(){return this._canvas}},{key:"context",get:function get(){return this._context}}],[{key:"appendParts",value:function appendParts(parts,statementlist){for(var i=0;i<statementlist.length;i++){var p=statementlist[i];if(p){var statement=constructor_name(p);if("Assign"==statement){var p1=new Parts_Substitute,b1=new Parts_Bar;p1.setValue(p.variable.getCode(),p.value.getCode(),p.operator),parts.next=p1,parts=p1.next=b1}else if("Append"==statement){var p1=new Parts_Append,b1=new Parts_Bar;p1.setValue(p.variable.getCode(),p.value.getCode()),parts.next=p1,parts=p1.next=b1}else if("Extend"==statement){var p1=new Parts_Extend,b1=new Parts_Bar;p1.setValue(p.variable.getCode(),p.value.getCode()),parts.next=p1,parts=p1.next=b1}else if("Input"==statement){var p1=new Parts_Input,b1=new Parts_Bar;p1.setValue(p.varname.getCode(),p.type),parts.next=p1,parts=p1.next=b1}else if("Output"==statement){for(var p1=new Parts_Output,b1=new Parts_Bar,v0=[],j=0;j<p.value.length;j++)v0.push(p.value[j].getCode());p1.setValue(v0.join(","),p.ln),parts.next=p1,parts=p1.next=b1}else if("Newline"==statement){var p1=new Parts_Output,b1=new Parts_Bar;p1.setValue("改行",!0),parts.next=p1,parts=p1.next=b1}else if("If"==statement){var p1=new Parts_If,b1=new Parts_Bar,b2=new Parts_Bar,b3=new Parts_Bar,n1=new Parts_Null,n2=new Parts_Null,n3=new Parts_Null;p1.setValue(p.condition.getCode()),parts.next=p1,p1.next=n1,n1.next=b1,p1.left=b2,b2._prev=p1,b2.next=n2,p1.right=b3,b3._prev=p1,b3.next=n3,p.state1&&Flowchart.appendParts(b2,p.state1),p.state2&&Flowchart.appendParts(b3,p.state2),parts=b1}else if("ForInc"==statement){var p1=new Parts_LoopBeginInc,p2=new Parts_LoopEnd,b1=new Parts_Bar,b2=new Parts_Bar;p1.setValue(p.varname.getCode(),p.begin.getCode(),p.end.getCode(),p.step.getCode()),parts.next=p1,p1.next=b1,b1.next=p2,p2.next=b2,p1._end=p2,p2._begin=p1,Flowchart.appendParts(b1,p.statementlist),parts=b2}else if("ForDec"==statement){var p1=new Parts_LoopBeginDec,p2=new Parts_LoopEnd,b1=new Parts_Bar,b2=new Parts_Bar;p1.setValue(p.varname.getCode(),p.begin.getCode(),p.end.getCode(),p.step.getCode()),parts.next=p1,p1.next=b1,b1.next=p2,p2.next=b2,p1._end=p2,p2._begin=p1,Flowchart.appendParts(b1,p.statementlist),parts=b2}else if("While"==statement){var p1=new Parts_LoopBegin1,p2=new Parts_LoopEnd,b1=new Parts_Bar,b2=new Parts_Bar;p1.setValue(p.condition.getCode()),parts.next=p1,p1.next=b1,b1.next=p2,p2.next=b2,p1._end=p2,p2._begin=p1,Flowchart.appendParts(b1,p.statementlist),parts=b2}else if("GraphicStatement"==statement){var p1=new Parts_Misc,b1=new Parts_Bar;p1.setValue(p.command,p.args),parts.next=p1,parts=p1.next=b1}else if("SleepStatement"==statement){var p1=new Parts_Misc,b1=new Parts_Bar;p1.setValue("sleep",[p.sec]),parts.next=p1,parts=p1.next=b1}else if("BreakStatement"==statement){var p1=new Parts_Misc,b1=new Parts_Bar;p1.setValue("break",[]),parts.next=p1,parts=p1.next=b1}else if("DumpStatement"==statement){var p1=new Parts_Misc,b1=new Parts_Bar;p1.setValue("dump",[]),parts.next=p1,parts=p1.next=b1}else if("NopStatement"==statement){var p1=new Parts_Misc,b1=new Parts_Bar;p1.setValue("NopStatement",[]),parts.next=p1,parts=p1.next=b1}}}}}]),Flowchart}(),Parts=function(){function Parts(){_classCallCheck(this,Parts),this._text="",this._next=this._prev=null,this._textwidth=this._textheight=this._width=this._height=0,this._hspace=this._hspace2=0}return _createClass(Parts,[{key:"inside",value:function inside(x,y){return this.x1<=x&&x<=this.x2&&this.y1<=y&&y<=this.y2}},{key:"findParts",value:function findParts(x,y){for(var p=this;null!=p&&!(p instanceof Parts_Null);){if(p.inside(x,y))return p;if(p instanceof Parts_If){var p1=p.left.findParts(x,y);if(p1)return p1;if(p1=p.right.findParts(x,y))return p1;p=p.end.next}else p=p.next}return null!=p&&null!=p.next?p.next.findParts(x,y):null}},{key:"paint",value:function paint(position){return null!=this.next?this.next.paint(position):this}},{key:"calcTextsize",value:function calcTextsize(){if(null!=this.text&&""!=this.text){var size=FlowchartSetting.size,metrics=flowchart.context.measureText(this.text);this._hspace=0,this._textwidth=metrics.width,this._textwidth<4*size&&(this._hspace=(4*size-this._textwidth)/2,this._textwidth=4*size),this._textheight=FlowchartSetting.fontsize}}},{key:"calcSize",value:function calcSize(p0,p1,p2){return null==this.next||this.isBlockEnd?this:this.next.calcSize(p0,p1,p2)}},{key:"appendCode",value:function appendCode(code,indent){return null!=this.next?this.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){}},{key:"deleteMe",value:function deleteMe(){this.prev._next=this.end.next.next,this.end.next.next._prev=this.prev,this.end._next=null,this._next=null}},{key:"cutMe",value:function cutMe(){}},{key:"paint_highlight",value:function paint_highlight(){flowchart.context.strokeStyle="rgb(255,0,0)",flowchart.context.fillStyle="rgb(255,0,0)",flowchart.context.clearRect(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1),this.paint(null),flowchart.context.strokeStyle="rgb(0,0,0)",flowchart.context.fillStyle="rgb(0,0,0)"}},{key:"paint_unhighlight",value:function paint_unhighlight(){flowchart.context.clearRect(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1),this.paint(null)}},{key:"highlight",value:function highlight(){this.paint_highlight()}},{key:"unhighlight",value:function unhighlight(){this.paint_unhighlight()}},{key:"x1",get:function get(){return this._x1},set:function set(x){this._x1=x}},{key:"y1",get:function get(){return this._y1},set:function set(y){this._y1=y}},{key:"x2",get:function get(){return this._x2},set:function set(x){this._x2=x}},{key:"y2",get:function get(){return this._y2},set:function set(y){this._y2=y}},{key:"text",get:function get(){return this._text}},{key:"next",get:function get(){return this._next},set:function set(p){p._next=this.next,p._prev=this,null!=this.next&&(this.next._prev=p),this._next=p}},{key:"prev",get:function get(){return this._prev}},{key:"end",get:function get(){return this}},{key:"width",get:function get(){return this._width}},{key:"height",get:function get(){return this._height}},{key:"textWidth",get:function get(){return this._textwidth}},{key:"textHeight",get:function get(){return this._textheight}},{key:"hspace",get:function get(){return this._hspace}},{key:"hspace2",get:function get(){return this._hspace2}},{key:"isBlockEnd",get:function get(){return!1}}],[{key:"appendMe",value:function appendMe(bar){}},{key:"makeIndent",value:function makeIndent(indent_level){for(var s="",i=0;i<indent_level;i++)s+="    ";return s}}]),Parts}(),Parts_Null=function(_Parts){function Parts_Null(){return _classCallCheck(this,Parts_Null),_possibleConstructorReturn(this,(Parts_Null.__proto__||Object.getPrototypeOf(Parts_Null)).apply(this,arguments))}return _inherits(Parts_Null,_Parts),_createClass(Parts_Null,[{key:"isBlockEnd",get:function get(){return!0}}]),Parts_Null}(Parts),Parts_Bar=function(_Parts2){function Parts_Bar(){return _classCallCheck(this,Parts_Bar),_possibleConstructorReturn(this,(Parts_Bar.__proto__||Object.getPrototypeOf(Parts_Bar)).apply(this,arguments))}return _inherits(Parts_Bar,_Parts2),_createClass(Parts_Bar,[{key:"calcSize",value:function calcSize(p0,p1,p2){return this._width=0,this._height=3*FlowchartSetting.size,p0.y+=this._height,p0.y>p2.y&&(p2.y=p0.y),this.next.calcSize(p0,p1,p2)}},{key:"inside",value:function inside(x,y){var near=4;return this.x1-4<=x&&x<=this.x2+4&&this.y1<=y&&y<=this.y2}},{key:"paint",value:function paint(position){return null!=position&&(this.x1=this.x2=position.x,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,this.y1),flowchart.context.lineTo(this.x2,this.y2),flowchart.context.stroke(),null!=position?(position.x=this.x2,position.y=this.y2,this.next.paint(position)):this}}]),Parts_Bar}(Parts),Parts_Terminal=function(_Parts3){function Parts_Terminal(){return _classCallCheck(this,Parts_Terminal),_possibleConstructorReturn(this,(Parts_Terminal.__proto__||Object.getPrototypeOf(Parts_Terminal)).apply(this,arguments))}return _inherits(Parts_Terminal,_Parts3),_createClass(Parts_Terminal,[{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize(),this._height=this._textheight+2*FlowchartSetting.size,this._width=this._textwidth+this._height;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,null==this.next?this:this.next.calcSize(p0,p1,p2)}},{key:"setValue",value:function setValue(v){this._text=v}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.textWidth/2-this.height/2,this.x2=position.x+this.textWidth/2+this.height/2,this.y1=position.y,this.y2=position.y+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1+this.height/2,this.y1),flowchart.context.lineTo(this.x2-this.height/2,this.y1),flowchart.context.stroke(),flowchart.context.beginPath(),flowchart.context.arc(this.x2-this.height/2,this.y1+this.height/2,this.height/2,Math.PI/2,-Math.PI/2,!0),flowchart.context.stroke(),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1+this.height/2,this.y2),flowchart.context.lineTo(this.x2-this.height/2,this.y2),flowchart.context.stroke(),flowchart.context.beginPath(),flowchart.context.arc(this.x1+this.height/2,this.y1+this.height/2,this.height/2,3*Math.PI/2,Math.PI/2,!0),flowchart.context.stroke(),flowchart.context.fillText(this.text,this.x1+this.height/2,this.y2-FlowchartSetting.size),null!=position?(position.y+=this.height,null!=this.end.next?this.end.next.paint(position):this.end):this}}]),Parts_Terminal}(Parts),Parts_Output=function(_Parts4){function Parts_Output(){_classCallCheck(this,Parts_Output);var _this74=_possibleConstructorReturn(this,(Parts_Output.__proto__||Object.getPrototypeOf(Parts_Output)).call(this));return _this74.setValue("《値》",!0),_this74}return _inherits(Parts_Output,_Parts4),_createClass(Parts_Output,[{key:"setValue",value:function setValue(v,nl){this._text=v,this._newline=nl}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this._textheight+2*size,this._width=this._textwidth+2*size+this._height/2;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,this.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;if(null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x2-this.height/2,this.y1),flowchart.context.lineTo(this.x1+2*size,this.y1),flowchart.context.lineTo(this.x1,(this.y1+this.y2)/2),flowchart.context.lineTo(this.x1+2*size,this.y2),flowchart.context.lineTo(this.x2-this.height/2,this.y2),flowchart.context.stroke(),flowchart.context.beginPath(),flowchart.context.arc(this.x2-this.height/2,(this.y1+this.y2)/2,this.height/2,Math.PI/2,-Math.PI/2,!0),flowchart.context.stroke(),flowchart.context.fillText(this.text,this.x1+2*size+this.hspace,this.y2-size),!this.newline&&"改行"!=this.text){var x=this.x2-this.height/2,y=this.y1+size;flowchart.context.beginPath(),flowchart.context.moveTo(x+size,y),flowchart.context.lineTo(x+size,y+this.textHeight),flowchart.context.lineTo(x,y+this.textHeight),flowchart.context.stroke(),flowchart.context.beginPath(),flowchart.context.moveTo(x+size/2,y+this.textHeight-size/4),flowchart.context.lineTo(x,y+this.textHeight),flowchart.context.lineTo(x+size/2,y+this.textHeight+size/4),flowchart.context.stroke(),x+=this.height/4,y+=this.textHeight/2,flowchart.context.beginPath(),flowchart.context.moveTo(x-size/2,y-size/2),flowchart.context.lineTo(x+size/2,y+size/2),flowchart.context.stroke(),flowchart.context.beginPath(),flowchart.context.moveTo(x+size/2,y-size/2),flowchart.context.lineTo(x-size/2,y+size/2),flowchart.context.stroke()}return null!=position?(position.y=this.y2,null!=this.end.next?this.end.next.paint(position):this.end):this}},{key:"appendCode",value:function appendCode(code,indent){return code+=Parts.makeIndent(indent),"改行"==this.text?code+="改行する\n":code+=this.text+"を"+(this.newline?"":"改行なしで")+"表示する\n",null!=this.next?this.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindowforOutput("出力の編集",["値","改行"],[this.text,this.newline],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0],values[1]),flowchart.paint(),flowchart.flowchart2code()}},{key:"newline",get:function get(){return this._newline}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_Output;return bar.next=parts,parts.next=new Parts_Bar,parts.next}}]),Parts_Output}(Parts),Parts_Input=function(_Parts5){function Parts_Input(){_classCallCheck(this,Parts_Input);var _this75=_possibleConstructorReturn(this,(Parts_Input.__proto__||Object.getPrototypeOf(Parts_Input)).call(this));return _this75.setValue("《変数》",0),_this75}return _inherits(Parts_Input,_Parts5),_createClass(Parts_Input,[{key:"setValue",value:function setValue(v,type){this._var=v,this.type=type,this._text=v+"を入力",this.type>0&&(this._text+="（"+nameOfType[this.type]+"）")}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this._textheight+2*size,this._width=this._textwidth+4*size;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,null==this.next||this.isBlockEnd?this:this.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,this.y1+size),flowchart.context.lineTo(this.x2,this.y1-size),flowchart.context.lineTo(this.x2,this.y2),flowchart.context.lineTo(this.x1,this.y2),flowchart.context.lineTo(this.x1,this.y1+size),flowchart.context.stroke(),flowchart.context.fillText(this.text,this.x1+2*size,this.y2-size),null!=position?(position.y=this.y2,null!=this.end.next?this.end.next.paint(position):this.end):this}},{key:"appendCode",value:function appendCode(code,indent){return code+=Parts.makeIndent(indent),code+=this.var,this.type>0&&(code+="に"+nameOfType[this.type]),code+="を入力する\n",null!=this.next?this.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindowforInput("入力の編集",["変数","型"],[this.var,this.type],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0],values[1]),flowchart.paint(),flowchart.flowchart2code()}},{key:"var",get:function get(){return this._var}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_Input;return bar.next=parts,parts.next=new Parts_Bar,parts.next}}]),Parts_Input}(Parts),Parts_Substitute=function(_Parts6){function Parts_Substitute(){_classCallCheck(this,Parts_Substitute);var _this76=_possibleConstructorReturn(this,(Parts_Substitute.__proto__||Object.getPrototypeOf(Parts_Substitute)).call(this));return _this76.setValue("《変数》","《値》",null),_this76}return _inherits(Parts_Substitute,_Parts6),_createClass(Parts_Substitute,[{key:"setValue",value:function setValue(variable,value,operator){this._var=variable,this._val=value,this._operator=operator,this._text=this._var+(this._operator?this._operator:"")+"←"+this._val}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this._textheight+2*size,this._width=this._textwidth+4*size;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,null==this.next||this.isBlockEnd?this:this.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,this.y1),flowchart.context.lineTo(this.x2,this.y1),flowchart.context.lineTo(this.x2,this.y2),flowchart.context.lineTo(this.x1,this.y2),flowchart.context.lineTo(this.x1,this.y1),flowchart.context.stroke(),flowchart.context.fillText(this.text,this.x1+2*size,this.y2-size),null!=position?(position.y=this.y2,null!=this.end.next?this.end.next.paint(position):this.end):this}},{key:"appendCode",value:function appendCode(code,indent){return code+=Parts.makeIndent(indent),code+=this.var+(this.operator?this.operator:"")+"←"+this.val+"\n",null!=this.next?this.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindowforSubstitute("代入の編集",["変数","値","演算"],[this.var,this.val,this.operator],this)}},{key:"edited",value:function edited(values){null!=values&&("（なし）"==values[2]&&(values[2]=null),this.setValue(values[0],values[1],values[2])),flowchart.paint(),flowchart.flowchart2code()}},{key:"var",get:function get(){return this._var}},{key:"val",get:function get(){return this._val}},{key:"operator",get:function get(){return this._operator}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_Substitute;return bar.next=parts,parts.next=new Parts_Bar,parts.next}}]),Parts_Substitute}(Parts),Parts_Append=function(_Parts7){function Parts_Append(){_classCallCheck(this,Parts_Append);var _this77=_possibleConstructorReturn(this,(Parts_Append.__proto__||Object.getPrototypeOf(Parts_Append)).call(this));return _this77.setValue("《変数》","《値》"),_this77}return _inherits(Parts_Append,_Parts7),_createClass(Parts_Append,[{key:"setValue",value:function setValue(variable,value){this._var=variable,this._val=value,this._text=this._var+"に"+this._val+"を追加"}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this._textheight+2*size,this._width=this._textwidth+4*size;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,null==this.next||this.isBlockEnd?this:this.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,this.y1),flowchart.context.lineTo(this.x2,this.y1),flowchart.context.lineTo(this.x2,this.y2),flowchart.context.lineTo(this.x1,this.y2),flowchart.context.lineTo(this.x1,this.y1),flowchart.context.stroke(),flowchart.context.fillText(this.text,this.x1+2*size,this.y2-size),null!=position?(position.y=this.y2,null!=this.end.next?this.end.next.paint(position):this.end):this}},{key:"appendCode",value:function appendCode(code,indent){return code+=Parts.makeIndent(indent),code+=this.var+"に"+this.val+"を追加する\n",null!=this.next?this.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindow("追加の編集",["変数","値"],[this.var,this.val],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0],values[1]),flowchart.paint(),flowchart.flowchart2code()}},{key:"var",get:function get(){return this._var}},{key:"val",get:function get(){return this._val}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_Append;return bar.next=parts,parts.next=new Parts_Bar,parts.next}}]),Parts_Append}(Parts),Parts_Extend=function(_Parts8){function Parts_Extend(){_classCallCheck(this,Parts_Extend);var _this78=_possibleConstructorReturn(this,(Parts_Extend.__proto__||Object.getPrototypeOf(Parts_Extend)).call(this));return _this78.setValue("《変数》","《値》"),_this78}return _inherits(Parts_Extend,_Parts8),_createClass(Parts_Extend,[{key:"setValue",value:function setValue(variable,value){this._var=variable,this._val=value,this._text=this._var+"に"+this._val+"を連結"}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this._textheight+2*size,this._width=this._textwidth+4*size;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,null==this.next||this.isBlockEnd?this:this.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,this.y1),flowchart.context.lineTo(this.x2,this.y1),flowchart.context.lineTo(this.x2,this.y2),flowchart.context.lineTo(this.x1,this.y2),flowchart.context.lineTo(this.x1,this.y1),flowchart.context.stroke(),flowchart.context.fillText(this.text,this.x1+2*size,this.y2-size),null!=position?(position.y=this.y2,null!=this.end.next?this.end.next.paint(position):this.end):this}},{key:"appendCode",value:function appendCode(code,indent){return code+=Parts.makeIndent(indent),code+=this.var+"に"+this.val+"を連結する\n",null!=this.next?this.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindow("追加の編集",["変数","値"],[this.var,this.val],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0],values[1]),flowchart.paint(),flowchart.flowchart2code()}},{key:"var",get:function get(){return this._var}},{key:"val",get:function get(){return this._val}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_Append;return bar.next=parts,parts.next=new Parts_Bar,parts.next}}]),Parts_Extend}(Parts),Parts_If=function(_Parts9){function Parts_If(){_classCallCheck(this,Parts_If);var _this79=_possibleConstructorReturn(this,(Parts_If.__proto__||Object.getPrototypeOf(Parts_If)).call(this));return _this79.setValue("《条件》"),_this79.left=_this79.right=null,_this79.left_bar_expand=_this79.right_bar_expand=0,_this79}return _inherits(Parts_If,_Parts9),_createClass(Parts_If,[{key:"setValue",value:function setValue(cond){this._cond=cond,this._text=this._cond}},{key:"calcTextsize",value:function calcTextsize(){if(null!=this.text&&""!=this.text){var size=FlowchartSetting.size,metrics=flowchart.context.measureText(this.text);this._hspace=0,this._textwidth=metrics.width,this._textwidth<6*size&&(this._hspace=(6*size-this._textwidth)/2,this._textwidth=6*size),this._textheight=FlowchartSetting.fontsize}}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this.v_margin=2*size,this.h_margin=this.textWidth*this.textHeight/this.v_margin/4,this._height=this.textHeight+2*this.v_margin,this._width=this.textWidth+2*this.h_margin;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,pl=new point;pl.x=x1,pl.y=p0.y;var pl1=pl.clone(),pl2=pl.clone();this.left.calcSize(pl,pl1,pl2),this.left_bar_expand=pl2.x-pl.x,this.left_bar_expand<size&&(this.left_bar_expand=size),pl1.x-=this.left_bar_expand,pl2.x-=this.left_bar_expand,pl1.x<p1.x&&(p1.x=pl1.x),pl1.y>p1.y&&(p1.y=pl1.y),pl2.y>p1.y&&(p1.y=pl2.y);var pr=new point;pr.x=x2,pr.y=p0.y;var pr1=pr.clone(),pr2=pr.clone();return this.right.calcSize(pr,pr1,pr2),this.right_bar_expand=pr.x-pr1.x,this.right_bar_expand<size&&(this.right_bar_expand=size),pr1.x+=this.right_bar_expand,pr2.x+=this.right_bar_expand,pr2.x>p2.x&&(p2.x=pr2.x),pr1.y>p2.y&&(p2.y=pr1.y),pr2.y>p2.y&&(p2.y=pr2.y),pr1.x<pl2.x+size&&(this.right_bar_expand+=pl2.x-pr1.x+size,p2.x+=pl2.x-pr1.x+size),this.end.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height);var x0=(this.x1+this.x2)/2,y0=(this.y1+this.y2)/2;if(flowchart.context.beginPath(),flowchart.context.moveTo(x0,this.y1),flowchart.context.lineTo(this.x1,y0),flowchart.context.lineTo(x0,this.y2),flowchart.context.lineTo(this.x2,y0),flowchart.context.lineTo(x0,this.y1),flowchart.context.stroke(),flowchart.context.fillText(this.text,x0-this.textWidth/2+this.hspace,y0+this.textHeight/2),null!=position){flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,y0),flowchart.context.lineTo(this.x1-this.left_bar_expand,y0),flowchart.context.stroke(),flowchart.context.fillText("Y",this.x1-1*size,y0-size);var left_parts=this.left.paint({x:this.x1-this.left_bar_expand,y:y0}).prev;flowchart.context.beginPath(),flowchart.context.moveTo(this.x2,y0),flowchart.context.lineTo(this.x2+this.right_bar_expand,y0),flowchart.context.stroke(),flowchart.context.fillText("N",this.x2+0*size,y0-size);var right_parts=this.right.paint({x:this.x2+this.right_bar_expand,y:y0}).prev,y;if(left_parts.y2>right_parts.y2?(y=left_parts.y2,flowchart.context.beginPath(),flowchart.context.moveTo(this.x2+this.right_bar_expand,right_parts.y2),flowchart.context.lineTo(this.x2+this.right_bar_expand,y),flowchart.context.stroke(),right_parts.y2=y):(y=right_parts.y2,flowchart.context.beginPath(),flowchart.context.moveTo(this.x1-this.left_bar_expand,left_parts.y2),flowchart.context.lineTo(this.x1-this.left_bar_expand,y),flowchart.context.stroke(),left_parts.y2=y),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1-this.left_bar_expand,y),flowchart.context.lineTo(this.x2+this.right_bar_expand,y),flowchart.context.stroke(),position.y=y,null!=this.end.next)return this.end.next.paint(position)}return this.end.next}},{key:"appendCode",value:function appendCode(code,indent){return code+=Parts.makeIndent(indent),code+="もし"+this.condition+"ならば：\n",this.left.next instanceof Parts_Null?code+=Parts.makeIndent(indent+1)+"\n":code+=this.left.appendCode("",indent+1),this.right.next instanceof Parts_Null||(code+=Parts.makeIndent(indent)+"そうでなければ：\n",code+=this.right.appendCode("",indent+1)),null!=this.end.next?this.end.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindow("分岐の編集",["条件"],[this.condition],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0]),flowchart.paint(),flowchart.flowchart2code()}},{key:"condition",get:function get(){return this._cond}},{key:"end",get:function get(){return this.next}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_If;return bar.next=parts,parts.next=new Parts_Null,parts.next.next=new Parts_Bar,parts.left=new Parts_Bar,parts.left._prev=parts,parts.left.next=new Parts_Null,parts.right=new Parts_Bar,parts.right._prev=parts,parts.right.next=new Parts_Null,parts.end.next.next}}]),Parts_If}(Parts),Parts_LoopBegin=function(_Parts10){function Parts_LoopBegin(){return _classCallCheck(this,Parts_LoopBegin),_possibleConstructorReturn(this,(Parts_LoopBegin.__proto__||Object.getPrototypeOf(Parts_LoopBegin)).apply(this,arguments))}return _inherits(Parts_LoopBegin,_Parts10),_createClass(Parts_LoopBegin,[{key:"calcTextsize",value:function calcTextsize(){if(this.hasText){var size=FlowchartSetting.size;this._textwidth=6*size,this._hspace=this._hspace2=0;var tw=flowchart.context.measureText(this.text).width;tw>this._textwidth&&(this._textwidth=tw);var tw2=flowchart.context.measureText(this.text2).width;tw2>this._textwidth&&(this._textwidth=tw2),tw<this._textwidth&&(this._hspace=(this._textwidth-tw)/2),tw2<this._textwidth&&(this._hspace2=(this._textwidth-tw2)/2),this._textheight=FlowchartSetting.fontsize}else this.end.calcTextsize(),this._textwidth=this.end.textWidth,this._textheight=this.end.textHeight}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this.textHeight*(this.hasText?2:1)+2*size,this._width=this.textWidth+2*size;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2;for(var n=this.next;n!=this.end;)n=n.calcSize(p0,p1,p2);return this.end.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1+size,this.y1),flowchart.context.lineTo(this.x2-size,this.y1),flowchart.context.lineTo(this.x2,this.y1+size),flowchart.context.lineTo(this.x2,this.y2),flowchart.context.lineTo(this.x1,this.y2),flowchart.context.lineTo(this.x1,this.y1+size),flowchart.context.lineTo(this.x1+size,this.y1),flowchart.context.stroke(),this.hasText&&(flowchart.context.fillText(this.text,this.x1+size+this.hspace,this.y1+size+this.textHeight),flowchart.context.fillText(this.text2,this.x1+size+this.hspace2,this.y1+size+2*this.textHeight)),null!=position?(position.y=this.y2,this.next.paint(position),this.end.next.paint(position)):this}},{key:"deleteMe",value:function deleteMe(){this.prev._next=this.end.next.next,this.end.next.next._prev=this.prev,this.end._next=null,this._next=null}},{key:"highlight",value:function highlight(){this.paint_highlight(),this.end.paint_highlight()}},{key:"unhighlight",value:function unhighlight(){this.paint_unhighlight(),this.end.paint_unhighlight()}},{key:"hasText",get:function get(){return!1}},{key:"end",get:function get(){return this._end}}]),Parts_LoopBegin}(Parts),Parts_LoopBegin1=function(_Parts_LoopBegin){function Parts_LoopBegin1(){_classCallCheck(this,Parts_LoopBegin1);var _this81=_possibleConstructorReturn(this,(Parts_LoopBegin1.__proto__||Object.getPrototypeOf(Parts_LoopBegin1)).call(this));return _this81.setValue("《条件》"),_this81}return _inherits(Parts_LoopBegin1,_Parts_LoopBegin),_createClass(Parts_LoopBegin1,[{key:"hasText",get:function get(){return!0}}]),_createClass(Parts_LoopBegin1,[{key:"setValue",value:function setValue(cond){this._cond=cond,this._text=this._cond}},{key:"appendCode",value:function appendCode(code,indent){code+=Parts.makeIndent(indent),code+=this.condition+"の間：\n";var code_inner=this.next.appendCode("",indent+1);return code+=""==code_inner?Parts.makeIndent(indent+1)+"\n":code_inner,null!=this.end.next?this.end.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindow("繰り返しの編集",["条件（〜の間）"],[this.condition],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0]),flowchart.paint(),flowchart.flowchart2code()}},{key:"condition",get:function get(){return this._cond}},{key:"text2",get:function get(){return"の間"}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_LoopBegin1;return bar.next=parts,parts.next=new Parts_Bar,parts.next.next=new Parts_LoopEnd,parts.next.next.next=new Parts_Bar,parts._end=parts.next.next,parts.next.next._begin=parts,parts.end}}]),Parts_LoopBegin1}(Parts_LoopBegin),Parts_LoopBeginInc=function(_Parts_LoopBegin2){function Parts_LoopBeginInc(){_classCallCheck(this,Parts_LoopBeginInc);var _this82=_possibleConstructorReturn(this,(Parts_LoopBeginInc.__proto__||Object.getPrototypeOf(Parts_LoopBeginInc)).call(this));return _this82.setValue("《変数》","《値》","《値》","《値》"),_this82}return _inherits(Parts_LoopBeginInc,_Parts_LoopBegin2),_createClass(Parts_LoopBeginInc,[{key:"hasText",get:function get(){return!0}}]),_createClass(Parts_LoopBeginInc,[{key:"setValue",value:function setValue(variable,start,goal,step){this._var=variable,this._start=start,this._goal=goal,this._step=step,this._text=this.var+":"+this.start+"→"+this.goal}},{key:"appendCode",value:function appendCode(code,indent){code+=Parts.makeIndent(indent),code+=this.var+"を"+this.start+"から"+this.goal+"まで"+this.step+"ずつ増やしながら：\n";var code_inner=this.next.appendCode("",indent+1);return code+=""==code_inner?Parts.makeIndent(indent+1)+"\n":code_inner,null!=this.end.next?this.end.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindow("繰り返しの編集",["変数","〜から","〜まで","増加分"],[this.var,this.start,this.goal,this.step],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0],values[1],values[2],values[3]),flowchart.paint(),flowchart.flowchart2code()}},{key:"var",get:function get(){return this._var}},{key:"start",get:function get(){return this._start}},{key:"goal",get:function get(){return this._goal}},{key:"step",get:function get(){return this._step}},{key:"text2",get:function get(){return this.step+"ずつ増"}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_LoopBeginInc;return bar.next=parts,parts.next=new Parts_Bar,parts.next.next=new Parts_LoopEnd,parts.next.next.next=new Parts_Bar,parts._end=parts.next.next,parts.next.next._begin=parts,parts.end}}]),Parts_LoopBeginInc}(Parts_LoopBegin),Parts_LoopBeginDec=function(_Parts_LoopBegin3){function Parts_LoopBeginDec(){_classCallCheck(this,Parts_LoopBeginDec);var _this83=_possibleConstructorReturn(this,(Parts_LoopBeginDec.__proto__||Object.getPrototypeOf(Parts_LoopBeginDec)).call(this));return _this83.setValue("《変数》","《値》","《値》","《値》"),_this83}return _inherits(Parts_LoopBeginDec,_Parts_LoopBegin3),_createClass(Parts_LoopBeginDec,[{key:"hasText",get:function get(){return!0}}]),_createClass(Parts_LoopBeginDec,[{key:"setValue",value:function setValue(variable,start,goal,step){this._var=variable,this._start=start,this._goal=goal,this._step=step,this._text=this.var+":"+this.start+"→"+this.goal}},{key:"appendCode",value:function appendCode(code,indent){code+=Parts.makeIndent(indent),code+=this.var+"を"+this.start+"から"+this.goal+"まで"+this.step+"ずつ減らしながら：\n";var code_inner=this.next.appendCode("",indent+1);return code+=""==code_inner?Parts.makeIndent(indent+1)+"\n":code_inner,null!=this.end.next?this.end.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){var subtitle,values;openModalWindow("繰り返しの編集",["変数","〜から","〜まで","減少分"],[this.var,this.start,this.goal,this.step],this)}},{key:"edited",value:function edited(values){null!=values&&this.setValue(values[0],values[1],values[2],values[3]),flowchart.paint(),flowchart.flowchart2code()}},{key:"var",get:function get(){return this._var}},{key:"start",get:function get(){return this._start}},{key:"goal",get:function get(){return this._goal}},{key:"step",get:function get(){return this._step}},{key:"text2",get:function get(){return this.step+"ずつ減"}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_LoopBeginDec;return bar.next=parts,parts.next=new Parts_Bar,parts.next.next=new Parts_LoopEnd,parts.next.next.next=new Parts_Bar,parts._end=parts.next.next,parts.next.next._begin=parts,parts.end}}]),Parts_LoopBeginDec}(Parts_LoopBegin),Parts_LoopEnd=function(_Parts11){function Parts_LoopEnd(){return _classCallCheck(this,Parts_LoopEnd),_possibleConstructorReturn(this,(Parts_LoopEnd.__proto__||Object.getPrototypeOf(Parts_LoopEnd)).apply(this,arguments))}return _inherits(Parts_LoopEnd,_Parts11),_createClass(Parts_LoopEnd,[{key:"editMe",value:function editMe(){this.begin.editMe()}},{key:"calcTextsize",value:function calcTextsize(){if(this.hasText){var size=FlowchartSetting.size;this._textwidth=6*size,this._hspace=this._hspace2=0;var tw=flowchart.context.measureText(this.text).width;tw>this._textwidth&&(this._textwidth=tw);var tw2=flowchart.context.measureText(this.text2).width;tw2>this._textwidth&&(this._textwidth=tw2),tw<this._textwidth&&(this._hspace=(this._textwidth-tw)/2),tw2<this._textwidth&&(this._hspace2=(this._textwidth-tw2)/2),this._textheight=FlowchartSetting.fontsize,this._textheight=FlowchartSetting.fontsize}else this._textwidth=this.begin.textWidth,this._textheight=this.begin.textHeight}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this.textHeight*(this.hasText?2:1)+2*size,this._width=this.textWidth+2*size;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,this}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,this.y1),flowchart.context.lineTo(this.x2,this.y1),flowchart.context.lineTo(this.x2,this.y2-size),flowchart.context.lineTo(this.x2-size,this.y2),flowchart.context.lineTo(this.x1+size,this.y2),flowchart.context.lineTo(this.x1,this.y2-size),flowchart.context.lineTo(this.x1,this.y1),flowchart.context.stroke(),this.hasText&&(flowchart.context.fillText(this.text,this.x1+size+this.hspace,this.y1+size+this.textHeight),flowchart.context.fillText(this.text2,this.x1+size+this.hspace2,this.y1+size+2*this.textHeight)),null!=position&&(position.y=this.y2),this}},{key:"appendCode",value:function appendCode(code,indent){return code}},{key:"editMe",value:function editMe(){this.begin.editMe()}},{key:"deleteMe",value:function deleteMe(){this.begin.deleteMe()}},{key:"cutMe",value:function cutMe(){this.begin.cutMe()}},{key:"highlight",value:function highlight(){this.paint_highlight(),this.begin.paint_highlight()}},{key:"unhighlight",value:function unhighlight(){this.paint_unhighlight(),this.begin.paint_unhighlight()}},{key:"hasText",get:function get(){return!1}},{key:"begin",get:function get(){return this._begin}},{key:"isBlockEnd",get:function get(){return!0}}]),Parts_LoopEnd}(Parts),misc_menu_ja=[["《各種処理》","none","《各種処理》",[]],["何もしない","NopStatement","何もしない",[]],["描画領域開く","gOpenWindow","描画領域開く(\t,\t)",["幅","高さ"]],["描画領域閉じる","gCloseWindow","描画領域閉じる()",[]],["描画領域全消去","gClearWindow","描画領域全消去()",[]],["線色設定","gSetLineColor","線色設定(\t,\t,\t)",["赤","青","緑"]],["塗色設定","gSetFillColor","塗色設定(\t,\t,\t)",["赤","青","緑"]],["文字色設定","gSetTextColor","文字色設定(\t,\t,\t)",["赤","青","緑"]],["線太さ設定","gSetLineWidth","線太さ設定(\t)",["太さ"]],["文字サイズ設定","gSetFontSize","文字サイズ設定(\t)",["サイズ"]],["文字描画","gDrawText","文字描画(\t,\t,\t)",["文字列","x","y"]],["点描画","gDrawPoint","点描画(\t,\t,\t,\t)",["x","y"]],["線描画","gDrawLine","線描画(\t,\t,\t,\t)",["x1","y1","x2","y2"]],["矩形描画","gDrawBox","矩形描画(\t,\t,\t,\t)",["x","y","幅","高さ"]],["矩形塗描画","gFillBox","矩形塗描画(\t,\t,\t,\t)",["x","y","幅","高さ"]],["円描画","gDrawCircle","円描画(\t,\t,\t)",["x","y","半径"]],["円塗描画","gFillCircle","円塗描画(\t,\t,\t)",["x","y","半径"]],["楕円描画","gDrawCircle","楕円描画(\t,\t,\t,\t)",["x","y","幅","高さ"]],["楕円塗描画","gFillCircle","楕円塗描画(\t,\t,\t,\t)",["x","y","幅","高さ"]],["弧描画","gDrawArc","弧描画(\t,\t,\t,\t,\t,\t,\t)",["x","y","幅","高さ","開始角","終了角","閉じ方"]],["弧塗描画","gFillArc","弧塗描画(\t,\t,\t,\t,\t,\t,\t)",["x","y","幅","高さ","開始角","終了角","閉じ方"]],["棒グラフ描画","gBarplot","棒グラフ描画(\t,\t,\t)",["幅","高さ","配列"]],["線グラフ描画","gLineplot","線グラフ描画(\t,\t,\t)",["幅","高さ","配列"]],["グラフ描画","gDrawGraph","グラフ描画(\t,\t)",["レイアウト情報","値の配列"]],["グラフ消去","gClearGraph","グラフ消去()",[]],["待つ","sleep","\tミリ秒待つ",["ミリ秒数"]],["繰り返しを抜ける","break","繰り返しを抜ける",[]],["変数を確認する","dump","変数を確認する",[]]],misc_menu_en=[["《各種処理》","none","《各種処理》",[]],["何もしない","NopStatement","何もしない",[]],["gOpenWindow","gOpenWindow","gOpenWindow(\t,\t)",["幅","高さ"]],["gCloseWindow","gCloseWindow","gCloseWindow()",[]],["gClearWindow","gClearWindow","gClearWindow()",[]],["gSetLineColor","gSetLineColor","gSetLineColor(\t,\t,\t)",["赤","青","緑"]],["gSetFillColor","gSetFillColor","gSetFillColor(\t,\t,\t)",["赤","青","緑"]],["gSetTextColor","gSetTextColor","gSetTextColor(\t,\t,\t)",["赤","青","緑"]],["gSetLineWidth","gSetLineWidth","gSetLineWidth(\t)",["太さ"]],["gSetFontSize","gSetFontSize","gSetFontSize(\t)",["サイズ"]],["gDrawText","gDrawText","gDrawText(\t,\t,\t)",["文字列","x","y"]],["gDrawPoint","gDrawPoint","gDrawPoint(\t,\t,\t,\t)",["x","y"]],["gDrawLine","gDrawLine","gDrawLine(\t,\t,\t,\t)",["x1","y1","x2","y2"]],["gDrawBox","gDrawBox","gDrawBox(\t,\t,\t,\t)",["x","y","幅","高さ"]],["gFillBox","gFillBox","gFillBox(\t,\t,\t,\t)",["x","y","幅","高さ"]],["gDrawCircle","gDrawCircle","gDrawCicle(\t,\t,\t)",["x","y","半径"]],["gFillCircle","gFillCircle","gFillCircle(\t,\t,\t)",["x","y","半径"]],["gDrawOval","gDrawCircle","gDrawOval(\t,\t,\t,\t)",["x","y","幅","高さ"]],["gFillOval","gFillCircle","gFillOval(\t,\t,\t,\t)",["x","y","幅","高さ"]],["gDrawArc","gDrawArc","gDrawArc(\t,\t,\t,\t,\t,\t,\t)",["x","y","幅","高さ","開始角","終了角","閉じ方"]],["gFillArc","gFillArc","gFillArc(\t,\t,\t,\t,\t,\t,\t)",["x","y","幅","高さ","開始角","終了角","閉じ方"]],["gBarplot","gBarplot","gBarplot(\t,\t,\t)",["幅","高さ","値"]],["gLineplot","gLineplot","gLineplot(\t,\t,\t)",["幅","高さ","値"]],["gDrawGraph","gDrawGraph","gDrawGraph(\t,\t)",["レイアウト情報","値の配列"]],["gClearGraph","gClearGraph","gClearGraph()",,[]],["待つ","sleep","\tミリ秒待つ",["ミリ秒数"]],["繰り返しを抜ける","break","繰り返しを抜ける",[]],["変数を確認する","dump","変数を確認する",[]]],misc_menu=0==setting.graphic_command?misc_menu_ja:misc_menu_en,Parts_Misc=function(_Parts12){function Parts_Misc(){_classCallCheck(this,Parts_Misc);var _this85=_possibleConstructorReturn(this,(Parts_Misc.__proto__||Object.getPrototypeOf(Parts_Misc)).call(this));return _this85.setValue("none",[]),_this85}return _inherits(Parts_Misc,_Parts12),_createClass(Parts_Misc,[{key:"setValue",value:function setValue(identifier,values){this._identifier=identifier,this._values=[];for(var i=0;i<values.length;i++)this._values.push(values[i].getCode());for(var i=0;i<misc_menu.length;i++)if(this._identifier==misc_menu[i][1]){this._command=misc_menu[i][0];for(var code=misc_menu[i][2],j=0;j<this.values.length;j++)code=code.replace("\t",this.values[j]);this._text=code;break}}},{key:"setValuebyText",value:function setValuebyText(identifier,values){this._identifier=identifier,this._values=[];for(var i=0;i<values.length;i++)this._values.push(values[i]);for(var i=0;i<misc_menu.length;i++)if(this._identifier==misc_menu[i][1]){this._command=misc_menu[i][0];for(var code=misc_menu[i][2],j=0;j<this.values.length;j++)code=code.replace("\t",this.values[j]);this._text=code;break}}},{key:"calcSize",value:function calcSize(p0,p1,p2){this.calcTextsize();var size=FlowchartSetting.size;this._height=this._textheight+2*size,this._width=this._textwidth+4*size;var x1=p0.x-this.width/2,x2=p0.x+this.width/2,y2=p0.y+this.height;return x1<p1.x&&(p1.x=x1),x2>p2.x&&(p2.x=x2),y2>p2.y&&(p2.y=y2),p0.y=y2,null==this.next||this.isBlockEnd?this:this.next.calcSize(p0,p1,p2)}},{key:"paint",value:function paint(position){var size=FlowchartSetting.size;return null!=position&&(this.x1=position.x-this.width/2,this.x2=position.x+this.width/2,this.y1=position.y,this.y2=this.y1+this.height),flowchart.context.beginPath(),flowchart.context.moveTo(this.x1,this.y1),flowchart.context.lineTo(this.x2,this.y1),flowchart.context.lineTo(this.x2,this.y2),flowchart.context.lineTo(this.x1,this.y2),flowchart.context.lineTo(this.x1,this.y1),flowchart.context.stroke(),flowchart.context.fillText(this.text,this.x1+2*size,this.y2-size),null!=position?(position.y=this.y2,null!=this.end.next?this.end.next.paint(position):this.end):this}},{key:"appendCode",value:function appendCode(code,indent){return code+=Parts.makeIndent(indent),code+=this.text+"\n",null!=this.next?this.next.appendCode(code,indent):code}},{key:"editMe",value:function editMe(){openModalWindowforMisc(this)}},{key:"edited",value:function edited(identifier,values){null!=values&&this.setValuebyText(identifier,values),flowchart.paint(),flowchart.flowchart2code()}},{key:"identifier",get:function get(){return this._identifier}},{key:"values",get:function get(){return this._values}}],[{key:"appendMe",value:function appendMe(bar){var parts=new Parts_Misc;return bar.next=parts,parts.next=new Parts_Bar,parts.next}}]),Parts_Misc}(Parts),modal_title,modal_subtitle,modal_values,modal_parts,misc_identifier;function openModalWindow(title,subtitle,values,parts){var html="<p>"+title+"</p>";modal_subtitle=subtitle,modal_values=values,modal_parts=parts,html+="<table>";for(var i=0;i<modal_subtitle.length;i++)html+="<tr><td>"+subtitle[i]+'</td><td><input type="text" id="inputarea'+i+'" value="'+values[i].replace(/\"/g,"&quot;")+'" onfocus="select();" onkeydown="keydownModal(event);" spellcheck="false"></td></tr>';html+="</table>",html+='<button type="button" onclick="closeModalWindow(true);">OK</button>',html+='<button type="button" onclick="closeModalWindow(false);">キャンセル</button>',modal_parts.highlight(),$("#input").html(html),$("#input").height(100+30*subtitle.length),$("#input-overlay").fadeIn(),$("#input").fadeIn(),$("#inputarea0").focus()}function openModalWindowforSubstitute(title,subtitle,values,parts){var operator=values[2]?values[2]:"（なし）",operators=["（なし）","+","-","*","/","//","%","&","|","<<",">>"],html="<p>"+title+"</p>";modal_subtitle=subtitle,modal_values=values,modal_parts=parts,html+="<table>",html+="<tr><td>"+subtitle[0]+'</td><td><input type="text" id="inputarea0" value="'+values[0].replace(/\"/g,"&quot;")+'" onfocus="select();" onkeydown="keydownModal(event);" spellcheck="false"></td></tr>',html+="<tr><td>"+subtitle[1]+'</td><td><input type="text" id="inputarea1" value="'+values[1].replace(/\"/g,"&quot;")+'" onfocus="select();" onkeydown="keydownModal(event);" spellcheck="false"></td></tr>',html+="<tr><td>"+subtitle[2]+'</td><td><select id="inputarea2">';for(var i=0;i<=operators.length;i++)html+='<option value="'+operators[i]+'"'+(operator==operators[i]?'selected="selected"':"")+">"+operators[i]+"</option>";html+="</td></tr>",html+="</table>",html+='<button type="button" onclick="closeModalWindow(true);">OK</button>',html+='<button type="button" onclick="closeModalWindow(false);">キャンセル</button>',modal_parts.highlight(),$("#input").html(html),$("#input").height(100+40*subtitle.length),$("#input-overlay").fadeIn(),$("#input").fadeIn(),$("#inputarea0").focus()}function openModalWindowforInput(title,subtitle,values,parts){var html="<p>"+title+"</p>";modal_subtitle=subtitle,modal_values=values,modal_parts=parts,html+="<table>",html+="<tr><td>"+subtitle[0]+'</td><td><input type="text" id="inputarea0" value="'+values[0].replace(/\"/g,"&quot;")+'" onfocus="select();" onkeydown="keydownModal(event);" spellcheck="false"></td></tr>',html+="<tr><td>"+subtitle[1]+'</td><td><select id="inputarea1">';for(var i=typeOfValue.typeInt;i<=typeOfValue.typeBoolean;i++)html+='<option value="'+i+'"'+(i==values[1]?'selected="selected"':"")+">"+nameOfType[i]+"</option>";html+="</td></tr>",html+="</table>",html+='<button type="button" onclick="closeModalWindow(true);">OK</button>',html+='<button type="button" onclick="closeModalWindow(false);">キャンセル</button>',modal_parts.highlight(),$("#input").html(html),$("#input").height(100+40*subtitle.length),$("#input-overlay").fadeIn(),$("#input").fadeIn(),$("#inputarea0").focus()}function openModalWindowforOutput(title,subtitle,values,parts){var html="<p>"+title+"</p>";modal_subtitle=subtitle,modal_values=values,modal_parts=parts,html+="<table>",html+="<tr><td>"+subtitle[0]+'</td><td><input type="text" id="inputarea0" value="'+values[0].replace(/\"/g,"&quot;")+'" onfocus="select();" onkeydown="keydownModal(event);" spellcheck="false"></td></tr>',html+='<tr><td></td><td><input type="checkbox" id="inputarea1"'+(values[1]?' checked="checked"':"")+">改行する</td></tr>",html+="</table>",html+='<button type="button" onclick="closeModalWindow(true);">OK</button>',html+='<button type="button" onclick="closeModalWindow(false);">キャンセル</button>',modal_parts.highlight(),$("#input").html(html),$("#input").height(100+40*subtitle.length),$("#input-overlay").fadeIn(),$("#input").fadeIn(),$("#inputarea0").focus()}function closeModalWindow(ok){if(ok)for(var i=0;i<modal_subtitle.length;i++){var $j=$("#inputarea"+i);"checkbox"==$j.prop("type")?modal_values[i]=$j.prop("checked"):modal_values[i]=$j.val()}$("#input").hide(),$("#input-overlay").hide(),modal_parts.unhighlight(),ok&&makeDirty(!0),modal_parts.edited(ok?modal_values:null)}function keydownModal(e){var evt=e||window.event;27==evt.keyCode?closeModalWindow(!1):13==evt.keyCode&&(evt.preventDefault(),closeModalWindow(!0))}function openModalWindowforMisc(parts){var html="<p>各種処理の編集</p>";modal_parts=parts,modal_values=[];for(var i=0;i<parts.values.length;i++)modal_values.push(parts.values[i]);html+='<select id="misccommands" onchange="onmiscchanged();">';for(var i=0;i<misc_menu.length;i++)html+='<option value="'+misc_menu[i][1]+'"'+(misc_menu[i][1]==parts.identifier?" selected":"")+">"+misc_menu[i][0]+"</option>";html+="</select>",html+='<table id="miscvalues">',html+="</table>",html+='<button type="button" onclick="closeModalWindowforMisc(true);">OK</button>',html+='<button type="button" onclick="closeModalWindowforMisc(false);">キャンセル</button>',modal_parts.highlight(),$("#input").html(html),$("#input-overlay").fadeIn(),$("#input").fadeIn(),setIdentifierforMisc(parts.identifier)}function onmiscchanged(){var index=document.getElementById("misccommands").selectedIndex;setIdentifierforMisc(misc_menu[index][1])}function setIdentifierforMisc(identifier){misc_identifier=identifier;for(var i=0;i<modal_values.length;i++){var elem=document.getElementById("inputarea"+i);elem&&(modal_values[i]=elem.value),/《.*》/.test(modal_values[i])&&(modal_values[i]=null)}for(var table=document.getElementById("miscvalues");table.firstChild;)table.removeChild(table.firstChild);for(var i=0;i<misc_menu.length;i++)if(identifier==misc_menu[i][1]){for(var tmp_values=[],j=0;j<misc_menu[i][3].length;j++){var v="《"+misc_menu[i][3][j]+"》";modal_values.length>j&&null!=modal_values[j]?v=modal_values[j]:modal_parts.values.length>j&&null!=modal_parts.values[j]&&(v=modal_parts.values[j]),tmp_values.push(v);var tr=document.createElement("tr"),td=document.createElement("td");td.innerHTML=misc_menu[i][3][j],tr.appendChild(td),td=document.createElement("td");var input=document.createElement("input");input.setAttribute("id","inputarea"+j),input.setAttribute("value",v),input.setAttribute("onfocus","select();"),input.setAttribute("onkeydown","keydownModalforMisc(event);"),input.setAttribute("spellcheck","false"),td.appendChild(input),tr.appendChild(td),table.appendChild(tr)}modal_values=tmp_values}$("#input").height(120+35*modal_values.length)}function closeModalWindowforMisc(ok){if(ok)for(var i=0;i<modal_values.length;i++)modal_values[i]=document.getElementById("inputarea"+i).value;$("#input").hide(),$("#input-overlay").hide(),modal_parts.unhighlight(),modal_parts.edited(misc_identifier,ok?modal_values:null)}function keydownModalforMisc(e){var evt=e||window.event;27==evt.keyCode?closeModalWindowforMisc(!1):13==evt.keyCode&&closeModalWindowforMisc(!0)}function cmBackspace(cm){var pos=cm.getCursor(),code,lines,code1=cm.getValue().split(/\r|\n|\r\n/)[pos.line].slice(0,pos.ch);/^\s+$/.exec(code1)?cm.execCommand("indentLess"):cm.execCommand("delCharBefore")}function cmCtrlRight(cm){var pos=cm.getCursor(),code,lines=cm.getValue().split(/\r|\n|\r\n/),selected=cm.getSelection(),ch=pos.ch;selected&&(ch+=selected.length);var code2=lines[pos.line].slice(ch),find=/《[^《]*》/.exec(code2);if(find){var ch1=ch+find.index,ch2=ch1+find[0].length;cm.setSelection({line:pos.line,ch:ch2},{line:pos.line,ch:ch1})}else cm.execCommand("goLineEnd")}function cmCtrlLeft(cm){var pos=cm.getCursor(),code,lines,code1=cm.getValue().split(/\r|\n|\r\n/)[pos.line].slice(0,pos.ch),re1=new RegExp("《[^《]*》","g"),find=re1.exec(code1);if(find){do{var ch1=find.index,ch2=ch1+find[0].length;find=re1.exec(code1)}while(re1.lastIndex>0);cm.setSelection({line:pos.line,ch:ch2},{line:pos.line,ch:ch1})}else/^\s*$/.exec(code1)?cm.execCommand("goLineStart"):cm.execCommand("goLineStartSmart")}onload=function onload(){var sourceTextArea=document.getElementById("sourceTextarea"),resultTextArea=document.getElementById("resultTextarea"),newButton=document.getElementById("newButton"),runButton=document.getElementById("runButton"),flowchartButton=document.getElementById("flowchartButton"),resetButton=document.getElementById("resetButton"),stepButton=document.getElementById("stepButton"),dumpButton=document.getElementById("dumpButton"),loadButton=document.getElementById("loadButton"),file_prefix=document.getElementById("file_prefix"),flowchart_canvas=document.getElementById("flowchart");(editor=CodeMirror.fromTextArea(sourceTextArea,{mode:{name:"pypen"},lineNumbers:!0,lineWrapping:!0,indentUnit:4,indentWithTabs:!1,extraKeys:{Tab:"indentMore","Shift-Tab":"indentLess",Backspace:cmBackspace,"Ctrl-Left":cmCtrlLeft,"Ctrl-Right":cmCtrlRight}})).setSize(500,300),editor.on("change",(function(){editor.save(),makeDirty(!0)})),resultTextArea.style.width=document.getElementById("input_area").clientWidth+"px",new ResizeObserver((function(){var w=editor.getWrapperElement().width,h=resultTextArea.offsetHeight-4;editor.setSize(w,h),editor.refresh()})).observe(resultTextArea),editor.getWrapperElement().id="CMSourceTextArea",editor.getWrapperElement().addEventListener("mousedown",mouseClick),editor.getWrapperElement().addEventListener("keyup",keyUp),sourceTextArea.onchange=function(){makeDirty(!0)},makeDirty(!1),textarea=resultTextArea,runButton.onclick=function(){run_flag&&!step_flag?(setRunflag(!1),document.getElementById("sourceTextarea").readOnly=!0,editor.options.readOnly=!0,editor.getWrapperElement().classList.add("readonly"),dumpButton.disabled=!1):(step_flag=!1,dumpButton.disabled=!0,run())},stepButton.onclick=function(){step_flag=!0,run()},newButton.onclick=function(){dirty&&!window.confirm("プログラムを削除していいですか？")||(editor.setValue(""),code=null,reset(),flowchart&&(flowchart.makeEmpty(),flowchart.paint()),editor.focus(),makeDirty(!1))},resetButton.onclick=function(){reset()},dumpButton.onclick=function(){dump()},loadButton.addEventListener("change",(function(ev){var file=ev.target.files,reader=new FileReader;reader.readAsText(file[0],"UTF-8"),reader.onload=function(ev){editor.setValue(reader.result),reset(),flowchart&&codeChange()}}),!1),downloadLink.onclick=function(){var now=new Date,filename=file_prefix.value.trim();filename.length<1&&(filename=now.getFullYear()+("0"+(now.getMonth()+1)).slice(-2)+("0"+now.getDate()).slice(-2)+"_"+("0"+now.getHours()).slice(-2)+("0"+now.getMinutes()).slice(-2)+("0"+now.getSeconds()).slice(-2)),filename+=".PyPEN";var blob=new Blob([editor.getValue()],{type:"text/plain"});window.navigator.msSaveBlob?window.navigator.msSaveBlob(blob,filename):(window.URL=window.URL||window.webkitURL,downloadLink.setAttribute("href",window.URL.createObjectURL(blob)),downloadLink.setAttribute("download",filename)),makeDirty(!1)},flowchartButton.onchange=function(){flowchart_display=this.checked;var flowchart_area=document.getElementById("Flowchart_area"),drawButton=document.getElementById("drawButton");flowchart_display?(flowchart_area.style.display="block",drawButton.style.display="inline",flowchart=new Flowchart,codeChange()):(flowchart_area.style.display="none",drawButton.style.display="none",flowchart=null)},flowchartButton.click(),editor.getWrapperElement().ondrop=function(e){var filelist=e.dataTransfer.files;if(filelist){for(var i=0;i<filelist.length;i++)if(/\.PyPEN$/i.exec(filelist[i].name)&&window.FileReader)try{var reader=new FileReader;reader.readAsText(filelist[i]),reader.onload=function(event){editor.setValue(event.target.result),codeChange()};break}catch(e){}return!1}},registerEvent(flowchart_canvas,"mousedown",mouseDown),registerEvent(flowchart_canvas,"mouseup",mouseUp),registerEvent(flowchart_canvas,"mousemove",mouseMove),registerEvent(flowchart_canvas,"dblclick",doubleclick_Flowchart),$.contextMenu({selector:"#CMSourceTextArea",zIndex:2,items:{zenkaku:{name:"入力補助",items:{"かつ":{name:"かつ",callback:function callback(k,e){insertCode("《値》 かつ 《値》")}},"または":{name:"または",callback:function callback(k,e){insertCode("《値》 または 《値》")}},"でない":{name:"でない",callback:function callback(k,e){insertCode("《値》 でない")}},"と":{name:"と",callback:function callback(k,e){insertCode("《値》と《値》")}}}},convert:{name:"変換",items:{int:{name:"整数",callback:function callback(k,e){insertCode("整数(《値》)")}},float:{name:"実数",callback:function callback(k,e){insertCode("実数(《値》)")}},string:{name:"文字列",callback:function callback(k,e){insertCode("文字列(《値》)")}},bool:{name:"真偽",callback:function callback(k,e){insertCode("真偽(《値》)")}}}},math:{name:"数学関数",items:{abs:{name:"abs 絶対値",callback:function callback(k,e){insertCode("abs(《値》)")}},random:{name:"random 乱数",callback:function callback(k,e){insertCode("random(《整数》)")}},ceil:{name:"ceil 切り上げ",callback:function callback(k,e){insertCode("ceil(《実数》)")}},floor:{name:"floor 切り捨て",callback:function callback(k,e){insertCode("floor(《実数》)")}},round:{name:"round 四捨五入",callback:function callback(k,e){insertCode("round(《実数》)")}},sin:{name:"sin サイン",callback:function callback(k,e){insertCode("sin(《実数》)")}},cos:{name:"cos コサイン",callback:function callback(k,e){insertCode("cos(《実数》)")}},tan:{name:"tan タンジェント",callback:function callback(k,e){insertCode("tan(《実数》)")}},sqrt:{name:"sqrt ルート",callback:function callback(k,e){insertCode("sqrt(《実数》)")}},log:{name:"log 自然対数",callback:function callback(k,e){insertCode("log(《実数》)")}},exp:{name:"exp 指数関数",callback:function callback(k,e){insertCode("exp(《実数》)")}},pow:{name:"pow 累乗",callback:function callback(k,e){insertCode("pow(《実数》,《実数》)")}}}},str:{name:"文字列関数",items:{length:{name:"length 長さ",callback:function callback(k,e){insertCode("length(《文字列》)")}},append:{name:"append 文字列結合",callback:function callback(k,e){insertCode("append(《文字列》,《文字列》)")}},substring1:{name:"substring 部分文字列（最後まで）",callback:function callback(k,e){insertCode("substring(《文字列》,《開始位置》)")}},substring2:{name:"substring 部分文字列（長さ指定）",callback:function callback(k,e){insertCode("substring(《文字列》,《開始位置》,《長さ》)")}},split:{name:"split 文字列分割",callback:function callback(k,e){insertCode("split(《文字列》,《区切文字列》)")}},extract:{name:"extract 文字列分割（番号指定）",callback:function callback(k,e){insertCode("extract(《文字列》,《区切文字列》,《番号》)")}},insert:{name:"insert 挿入",callback:function callback(k,e){insertCode("insert(《文字列》,《位置》,《文字列》)")}},replace:{name:"replace 置換",callback:function callback(k,e){insertCode("replace(《文字列》,《位置》,《長さ》,《文字列》)")}}}},graphic1:{name:"グラフィック命令（日本語）",items:{gOpenWindow:{name:"描画領域開く",callback:function callback(k,e){insertCode("描画領域開く(《幅》,《高さ》)")}},gCloseWindow:{name:"描画領域閉じる",callback:function callback(k,e){insertCode("描画領域閉じる()")}},gClearWindow:{name:"描画領域全消去",callback:function callback(k,e){insertCode("描画領域全消去()")}},gSetLineColor:{name:"線色設定",callback:function callback(k,e){insertCode("線色設定(《赤》,《緑》,《青》)")}},gSetFillColor:{name:"塗色設定",callback:function callback(k,e){insertCode("塗色設定(《赤》,《緑》,《青》)")}},gSetTextColor:{name:"文字色設定",callback:function callback(k,e){insertCode("文字色設定(《赤》,《緑》,《青》)")}},gSetLineWidth:{name:"線太さ設定",callback:function callback(k,e){insertCode("線太さ設定(《太さ》)")}},gSetFontSize:{name:"文字サイズ設定",callback:function callback(k,e){insertCode("文字サイズ設定(《サイズ》)")}},gDrawText:{name:"文字描画",callback:function callback(k,e){insertCode("文字描画(《文字列》,《x》,《y》)")}},gDrawPoint:{name:"点描画",callback:function callback(k,e){insertCode("点描画(《x》,《y》)")}},gDrawLine:{name:"線描画",callback:function callback(k,e){insertCode("線描画(《x1》,《y1》,《x2》,《y2》)")}},gDrawBox:{name:"矩形描画",callback:function callback(k,e){insertCode("矩形描画(《x》,《y》,《幅》,《高さ》)")}},gFillBox:{name:"矩形塗描画",callback:function callback(k,e){insertCode("矩形塗描画(《x》,《y》,《幅》,《高さ》)")}},gDrawCircle:{name:"円描画",callback:function callback(k,e){insertCode("円描画(《x》,《y》,《半径》)")}},gFillCircle:{name:"円塗描画",callback:function callback(k,e){insertCode("円塗描画(《x》,《y》,《半径》)")}},gDrawOval:{name:"楕円描画",callback:function callback(k,e){insertCode("楕円描画(《x》,《y》,《幅》,《高さ》)")}},gFillOval:{name:"楕円塗描画",callback:function callback(k,e){insertCode("楕円塗描画(《x》,《y》,《幅》,《高さ》)")}},gDrawArc:{name:"弧描画",callback:function callback(k,e){insertCode("弧描画(《x》,《y》,《幅》,《高さ》,《開始角》,《終了角》,《閉じ方》)")}},gFillArc:{name:"弧塗描画",callback:function callback(k,e){insertCode("弧塗描画(《x》,《y》,《幅》,《高さ》,《開始角》,《終了角》,《閉じ方》)")}},gBarplot:{name:"棒グラフ描画",callback:function callback(k,e){insertCode("棒グラフ描画(《幅》,《高さ》,《値》)")}},gLineplot:{name:"線グラフ描画",callback:function callback(k,e){insertCode("線グラフ描画(《幅》,《高さ》,《値》)")}},gDrawGraph:{name:"グラフ描画",callback:function callback(k,e){insertCode("グラフ描画(《レイアウト情報》,《値の配列》)")}},gClearGraph:{name:"グラフ消去",callback:function callback(k,e){insertCode("グラフ消去()")}}}},graphic2:{name:"グラフィック命令（英語）",items:{gOpenWindow:{name:"gOpenWindow",callback:function callback(k,e){insertCode("gOpenWindow(《幅》,《高さ》)")}},gCloseWindow:{name:"gCloseWindow",callback:function callback(k,e){insertCode("gCloseWindow()")}},gClearWindow:{name:"gClearWindow",callback:function callback(k,e){insertCode("gClearWindow()")}},gSetLineColor:{name:"gSetLineColor",callback:function callback(k,e){insertCode("gSetLineColor(《赤》,《緑》,《青》)")}},gSetFillColor:{name:"gSetFillColor",callback:function callback(k,e){insertCode("gSetFillColor(《赤》,《緑》,《青》)")}},gSetTextColor:{name:"gSetTextColor",callback:function callback(k,e){insertCode("gSetTextColor(《赤》,《緑》,《青》)")}},gSetLineWidth:{name:"gSetLineWidth",callback:function callback(k,e){insertCode("gSetLineWidth(《太さ》)")}},gSetFontSize:{name:"gSetFontSize",callback:function callback(k,e){insertCode("gSetFontSize(《サイズ》)")}},gDrawText:{name:"gDrawText",callback:function callback(k,e){insertCode("gDraeText(《文字列》,《x》,《y》)")}},gDrawPoint:{name:"gDrawPoint",callback:function callback(k,e){insertCode("gDrawPoint(《x》,《y》)")}},gDrawLine:{name:"gDrawLine",callback:function callback(k,e){insertCode("gDrawLine(《x1》,《y1》,《x2》,《y2》)")}},gDrawBox:{name:"gDrawBox",callback:function callback(k,e){insertCode("gDrawBox(《x》,《y》,《幅》,《高さ》)")}},gFillBox:{name:"gFillBox",callback:function callback(k,e){insertCode("gFillBox(《x》,《y》,《幅》,《高さ》)")}},gDrawCircle:{name:"gDrawCircle",callback:function callback(k,e){insertCode("gDrawCircle(《x》,《y》,《半径》)")}},gFillCircle:{name:"gFillCircle",callback:function callback(k,e){insertCode("gFillCircle(《x》,《y》,《半径》)")}},gDrawOval:{name:"gDrawOval",callback:function callback(k,e){insertCode("gDrawOval(《x》,《y》,《幅》,《高さ》)")}},gFillOval:{name:"gFillOval",callback:function callback(k,e){insertCode("gFillOval(《x》,《y》,《幅》,《高さ》)")}},gDrawArc:{name:"gDrawArc",callback:function callback(k,e){insertCode("gDrawArc(《x》,《y》,《幅》,《高さ》,《開始角》,《終了角》,《閉じ方》)")}},gFillArc:{name:"gFillArc",callback:function callback(k,e){insertCode("gFillArc(《x》,《y》,《幅》,《高さ》,《開始角》,《終了角》,《閉じ方》)")}},gBarplot:{name:"gBarplot",callback:function callback(k,e){insertCode("gBarplot(《幅》,《高さ》,《値》)")}},gLineplot:{name:"gLineplot",callback:function callback(k,e){insertCode("gLineplot(《幅》,《高さ》,《値》)")}},gDrawGraph:{name:"gDrawGraph",callback:function callback(k,e){insertCode("gDrawGraph(《レイアウト情報》,《値の配列》)")}},gClearGraph:{name:"gClearGraph",callback:function callback(k,e){insertCode("gClearGraph()")}}}},misc:{name:"各種命令",items:{nop:{name:"何もしない",callback:function callback(k,e){insertCode("何もしない")}},sleep:{name:"待つ",callback:function callback(k,e){insertCode("《ミリ秒数》ミリ秒待つ")}},dump:{name:"変数を確認する",callback:function callback(k,e){insertCode("変数を確認する")}}}}}}),$.contextMenu({selector:"#flowchart",build:contextMenu_Flowchart});var messageName="zero-timeout-message";function setZeroTimeout(fn){timeouts.push(fn),window.postMessage(messageName,"*")}function handleMessage(event){var fn;event.source==window&&event.data==messageName&&(event.stopPropagation(),timeouts.length>0&&timeouts.shift()())}window.addEventListener?window.addEventListener("message",handleMessage,!0):window.attachEvent&&window.attachEvent("onmessage",handleMessage),window.setZeroTimeout=setZeroTimeout,$(window).bind("beforeunload",(function(){if(dirty)return"プログラムが消去されます"})),reset();var sample_area=document.getElementById("SampleButtons"),sample_table=document.createElement("table");sample_area.appendChild(sample_table);for(var sample_table_row=null,_loop=function _loop(_i26){sample_table_row||(sample_table_row=document.createElement("tr"),sample_table.appendChild(sample_table_row));var cell=document.createElement("td"),button=document.createElement("button");button.innerText="サンプル"+(_i26+1),button.setAttribute("type","button"),button.setAttribute("class","sampleButton"),button.onclick=function(){sampleButton(_i26)},cell.appendChild(button),sample_table_row.appendChild(cell),_i26%8==7&&(sample_table_row=null)},_i26=0;_i26<sample.length;_i26++)_loop(_i26);if(1==setting.quiz_mode&&Quizzes.length>0){var quiz_select=document.getElementById("quiz_select");quiz_select.onchange=function(){var i=quiz_select.selectedIndex;document.getElementById("quiz_question").innerHTML=i>0?Quizzes[i-1].question():""};var option=document.createElement("option");option.val=0,option.appendChild(document.createTextNode("問題選択")),quiz_select.appendChild(option);for(var _i27=0;_i27<Quizzes.length;_i27++)(option=document.createElement("option")).val=_i27+1,option.appendChild(document.createTextNode("Q"+(_i27+1)+":"+Quizzes[_i27].title())),quiz_select.appendChild(option);document.getElementById("quiz_marking").onclick=function(){var i=quiz_select.selectedIndex;i>0?auto_marking(i-1):textarea.value="問題が選択されていないので採点できません。"}}else document.getElementById("Quiz_area").style.display="none";document.getElementById("urlButton").onclick=function(){var code=sourceTextArea.value.trim();if(""!=code&&(code=B64encode(code))){var url=window.location;textareaClear(),highlightLine(-1),textareaAppend(url.protocol+"//"+url.hostname+url.pathname+"?code="+code)}};var code=getParam("code");code&&(editor.setValue(code),codeChange(),highlightLine(-1))};var base64str="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function B64encode(string){var textencoder=new TextEncoder,deflate,origin=new Zlib.Deflate(textencoder.encode(string)).compress();if(origin.length>1500)return textareaAppend("*** プログラムが大きすぎて変換できません ***"),null;for(var convert=new Array(4*Math.floor((origin.length+2)/3)),i=0;i<origin.length;i+=3){var v1,v2,v3=64,v4=64;v1=origin[i]>>>2,v2=48&origin[i]<<4,i+1<origin.length&&(v2|=15&origin[i+1]>>>4,v3=60&origin[i+1]<<2,i+2<origin.length&&(v3|=3&origin[i+2]>>>6,v4=63&origin[i+2]));var j=i/3*4;convert[j++]=base64str[v1],convert[j++]=base64str[v2],convert[j++]=base64str[v3],convert[j]=base64str[v4]}return convert.join("").replace(/=+$/,"")}function B64decode(string){var convert=new Array;try{for(var i=0;i<string.length;i+=4){var c1=base64str.indexOf(string[i]),c2=base64str.indexOf(string[i+1]),c3,c4;convert.push(c1<<2|c2>>4),i+2<string.length&&(c3=base64str.indexOf(string[i+2]),convert.push((15&c2)<<4|c3>>>2),i+3<string.length&&(c4=base64str.indexOf(string[i+3]),convert.push((3&c3)<<6|c4)))}var inflate=new Zlib.Inflate(convert),textdecoder;return(new TextDecoder).decode(inflate.decompress())}catch(e){return""}}function getParam(name){var getparam=window.location.search;if(getparam){var params=getparam.slice(1).split("&"),_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _iterator3=params[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var param,p=_step3.value.split("=");if(p[0]==name)return B64decode(p[1])}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}return null}function auto_marking(i){reset(),setRunflag(!0),document.getElementById("runButton").disabled=!0,document.getElementById("stepButton").disabled=!0,document.getElementById("resetButton").disabled=!0,document.getElementById("urlButton").disabled=!0,highlightLine(-1),textareaClear(),textareaAppend("*** 採点開始 ***\n"),selected_quiz=i;for(var all_clear=!0,j=0;j<Quizzes[i].cases();j++){var clear=!0;textareaAppend("ケース"+(j+1)+"...");try{if(selected_quiz_case=j,test_limit_time=Date.now()+Quizzes[selected_quiz].timeout(),run(),selected_quiz_input!=Quizzes[selected_quiz].inputs(selected_quiz_case).length)throw new RuntimeError(-1,"入力の回数がおかしいです。");if(output_str.trim()!=Quizzes[selected_quiz].output(selected_quiz_case).toString().trim())throw new RuntimeError(-1,"結果が違います。");textareaAppend("成功\n")}catch(e){textareaAppend("失敗\n"),textareaAppend(e.message+"\n"),clear=!1}all_clear&=clear,code=null}textareaAppend(all_clear?"*** 合格 ***\n":"--- 不合格 ---\n"),selected_quiz=-1,document.getElementById("runButton").disabled=!1,document.getElementById("stepButton").disabled=!1,document.getElementById("resetButton").disabled=!1,document.getElementById("urlButton").disabled=!1,setRunflag(!1)}function font_size(updown){if(0!=updown){if(fontsize+updown<14||fontsize+updown>30)return;fontsize+=updown}else fontsize=16;var elem=document.getElementById("CMSourceTextArea");elem.style.fontSize=fontsize+"px",(elem=document.getElementsByClassName("CodeMirror-cursor")[0]).style.fontSize=fontsize+"px",editor.refresh(),(elem=textarea).style.fontSize=fontsize+"px",editor.focus()}function makePython(){if(!run_flag){code=null,myFuncs={},python_lib={};try{var code=editor.getValue(),dncl_code=python_to_dncl(code),main_routine,python_code=new parsedMainRoutine(dncl.parse(dncl_code)).makePython();textareaClear(),textareaAppend(python_code)}catch(e){highlightLine(-1),textareaClear(),e.line&&textareaAppend(e.line+"行目"),textareaAppend("構文エラーです\n"+e.message)}}}